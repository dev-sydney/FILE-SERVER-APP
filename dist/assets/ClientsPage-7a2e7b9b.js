import{R as f,P as x,r as l,j as e,U as A,a as N,u as w}from"./index-40c0bbd3.js";import{U as _,S as k}from"./SkeletonClientItem-19990b8f.js";import{U as S,M as E}from"./ModalBackground-6a0676be.js";import{U as T}from"./uil-info-circle-f23d03e7.js";const g=r=>{const{color:a,size:s,...o}=r;return f.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:s,height:s,viewBox:"0 0 24 24",fill:a,...o},f.createElement("path",{d:"M10,18a1,1,0,0,0,1-1V11a1,1,0,0,0-2,0v6A1,1,0,0,0,10,18ZM20,6H16V5a3,3,0,0,0-3-3H11A3,3,0,0,0,8,5V6H4A1,1,0,0,0,4,8H5V19a3,3,0,0,0,3,3h8a3,3,0,0,0,3-3V8h1a1,1,0,0,0,0-2ZM10,5a1,1,0,0,1,1-1h2a1,1,0,0,1,1,1V6H10Zm7,14a1,1,0,0,1-1,1H8a1,1,0,0,1-1-1V8H17Zm-3-1a1,1,0,0,0,1-1V11a1,1,0,0,0-2,0v6A1,1,0,0,0,14,18Z"}))};g.propTypes={color:x.string,size:x.oneOfType([x.string,x.number])};g.defaultProps={color:"currentColor",size:"24"};const U=g,C=({setIsFormModalActive:r})=>{const[a,s]=l.useState({client_first_name:"",client_last_name:"",client_email:""}),[o,m]=l.useState(null),[u,n]=l.useState(!1),c=d=>{s({...a,[d.target.name]:d.target.value})},p=d=>{d.preventDefault(),n(!0),fetch("/api/v1/clients/",{method:"POST",headers:{"Content-type":"application/json"},body:JSON.stringify(a)}).then(i=>i.json()).then(i=>{if(i.status==="success")n(!1),m(i.message),s({client_first_name:"",client_last_name:"",client_email:""}),setTimeout(()=>{m(null)},1e3);else throw n(!1),new Error(i.message)}).catch(i=>m(i.message))};return e.jsxs("div",{style:{background:"white"},className:"add-client-form",children:[e.jsx("div",{style:{textAlign:"right"},children:e.jsx(S,{size:"2em",className:"close-modal-btn",onClick:()=>{r(!1)}})}),e.jsx("div",{style:{display:"flex",justifyContent:"center"},children:o&&e.jsxs("div",{className:"component-alert",children:[e.jsx(T,{size:"1.5em",style:{margin:"auto 0.5em"}}),e.jsx("b",{style:{margin:"auto 0"},children:o})]})}),e.jsx("h2",{children:"Add a client!"}),e.jsx("p",{children:"Please enter the client's names and email to be added."}),e.jsxs("form",{onSubmit:p,children:[e.jsxs("div",{className:"input-block",children:[e.jsx("input",{required:!0,type:"text",name:"client_first_name",value:a.client_first_name,onChange:c}),e.jsx("span",{className:"placeholder",children:"First name:"})]}),e.jsxs("div",{className:"input-block",children:[e.jsx("input",{required:!0,type:"text",name:"client_last_name",value:a.client_last_name,onChange:c}),e.jsx("span",{className:"placeholder",children:"Last name:"})]}),e.jsxs("div",{className:"input-block",children:[e.jsx("input",{required:!0,type:"email",name:"client_email",value:a.client_email,onChange:c}),e.jsx("span",{className:"placeholder",children:"Email address:"})]}),e.jsx("button",{className:"submit_btn",style:{margin:"1em 0"},children:u?e.jsx("span",{children:e.jsx(A,{size:"1.4em",className:"spinner-icon"})}):"Add contact"})]})]})};C.propTypes={setIsFormModalActive:x.func};const V=()=>{const r=l.useContext(N),a=l.useContext(w),[s,o]=l.useState(null),[m,u]=l.useState(!1),[n,c]=l.useState([]),[p,d]=l.useState(!0),i=[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15];l.useEffect(()=>{fetch("/api/v1/clients/?fields=client_first_name,client_last_name,client_email,client_id&client_status=1&sort=client_first_name,client_last_name:asc").then(t=>t.json()).then(t=>{if(t.status==="success")o(t.clientsContacts),d(!1);else throw d(!1),new Error(t.message)}).catch(t=>r.setAlert(t.message,"Something went wrong!")),a.setNavBarVisibilty(!0)},[m]);const b=t=>{const{value:h}=t.target;t.target.checked?c([...n,h]):c(n.filter(j=>j!==h))},v=t=>{if(t.target.checked){const h=s.map(j=>`${j.client_id}`);c(h)}else c([])},y=()=>{fetch(`/api/v1/clients/?clientIds=${n.join(",")}`,{method:"DELETE"}).then(t=>{if(t.status===204)o(s.filter(h=>!n.includes(h.client_id.toString()))),r.setAlert("Contact deleted successfully","Awesome");else throw new Error("Trouble deleting the contact, please try again")}).catch(t=>r.setAlert(t.message,"Uh oh!"))};return e.jsxs("div",{className:"clients-page",children:[m&&e.jsx(E,{modalChild:e.jsx(C,{setIsFormModalActive:u})}),e.jsx("h1",{style:{textAlign:"left"},children:"Your clients"}),e.jsxs("span",{className:"add-delete-buttons",children:[e.jsxs("button",{onClick:()=>{u(!0)},className:"add-client-btn",children:[e.jsx("span",{children:"Add Client"}),e.jsx(_,{size:"1.3em",color:"#121927"})]}),e.jsxs("button",{onClick:y,className:"delete-client-btn",disabled:(n==null?void 0:n.length)<1,children:[e.jsx("span",{children:"Delete Contact"}),e.jsx(U,{size:"1.3em",color:"white"})]})]}),(s==null?void 0:s.length)>0&&e.jsxs("span",{style:{display:"flex",justifyContent:"flex-end",padding:"0 1em"},children:[e.jsx("input",{type:"checkbox",onChange:v}),e.jsx("label",{style:{margin:"auto 0"},children:"Select All"})]}),e.jsx("span",{style:{minHeight:"100%",overflowY:"auto",padding:"1em 0",background:"white",borderRadius:"5px"},children:p?i.map(t=>e.jsx(k,{},t)):s.length>0?s.map(t=>e.jsxs("div",{className:"client_item",children:[e.jsx("div",{className:"checkbox",children:e.jsx("input",{type:"checkbox",value:t.client_id,onChange:b,checked:n.includes(`${t.client_id}`)})}),e.jsxs("div",{className:"client_details",children:[e.jsx("b",{children:`${t.client_first_name} ${t.client_last_name}`}),e.jsx("p",{children:t.client_email})]})]},t.client_id)):e.jsxs("div",{style:{margin:"0 auto",width:"fit-content"},children:[e.jsx("p",{children:"No clients added yet"}),e.jsxs("button",{onClick:()=>{u(!0)},className:"add-client-btn",children:[e.jsx("span",{children:"Add Client"}),e.jsx(_,{size:"1.3em",color:"#121927"})]})]})})]})};export{V as default};
