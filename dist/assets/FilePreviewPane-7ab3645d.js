var an=Object.defineProperty;var on=(R,i,U)=>i in R?an(R,i,{enumerable:!0,configurable:!0,writable:!0,value:U}):R[i]=U;var Lt=(R,i,U)=>(on(R,typeof i!="symbol"?i+"":i,U),U),ue=(R,i,U)=>{if(!i.has(R))throw TypeError("Cannot "+U)};var y=(R,i,U)=>(ue(R,i,"read from private field"),U?U.call(R):i.get(R)),tt=(R,i,U)=>{if(i.has(R))throw TypeError("Cannot add the same private member more than once");i instanceof WeakSet?i.add(R):i.set(R,U)},gt=(R,i,U,l)=>(ue(R,i,"write to private field"),l?l.call(R,U):i.set(R,U),U),re=(R,i,U,l)=>({set _(A){gt(R,i,A,U)},get _(){return y(R,i,l)}}),it=(R,i,U)=>(ue(R,i,"access private method"),U);import{R as React,P as PropTypes,r as reactExports,a as alertContext,j as jsxRuntimeExports,h as getAugmentedNamespace,g as getDefaultExportFromCjs}from"./index-2e30dd7d.js";import{U as UilShare,a as UilImport,g as getFileIcon}from"./getFileIcon-9b90b96e.js";import{S as SkeletonClientItem,U as UilPlusCircle}from"./SkeletonClientItem-97710a4a.js";import{U as UilTimes}from"./ModalBackground-b1c12517.js";import{U as UilInfoCircle}from"./uil-info-circle-049d2bed.js";function _mergeNamespaces(R,i){for(var U=0;U<i.length;U++){const l=i[U];if(typeof l!="string"&&!Array.isArray(l)){for(const A in l)if(A!=="default"&&!(A in R)){const G=Object.getOwnPropertyDescriptor(l,A);G&&Object.defineProperty(R,A,G.get?G:{enumerable:!0,get:()=>l[A]})}}}return Object.freeze(Object.defineProperty(R,Symbol.toStringTag,{value:"Module"}))}const UilUpload=R=>{const{color:i,size:U,...l}=R;return React.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:U,height:U,viewBox:"0 0 24 24",fill:i,...l},React.createElement("path",{d:"M8.71,7.71,11,5.41V15a1,1,0,0,0,2,0V5.41l2.29,2.3a1,1,0,0,0,1.42,0,1,1,0,0,0,0-1.42l-4-4a1,1,0,0,0-.33-.21,1,1,0,0,0-.76,0,1,1,0,0,0-.33.21l-4,4A1,1,0,1,0,8.71,7.71ZM21,12a1,1,0,0,0-1,1v6a1,1,0,0,1-1,1H5a1,1,0,0,1-1-1V13a1,1,0,0,0-2,0v6a3,3,0,0,0,3,3H19a3,3,0,0,0,3-3V13A1,1,0,0,0,21,12Z"}))};UilUpload.propTypes={color:PropTypes.string,size:PropTypes.oneOfType([PropTypes.string,PropTypes.number])};UilUpload.defaultProps={color:"currentColor",size:"24"};const UilUpload$1=UilUpload,feedStyle="",FeedItem=({file:R,setFileNames:i,isCheckBoxActive:U,setIsCheckBoxActive:l,fileNames:A,setIsPreviewPaneActive:G,setSelectedPreviewFile:q})=>{const Z=reactExports.useContext(alertContext),L=v=>{const{value:N}=v.target;v.target.checked?i([...A,N]):i(A.filter(w=>w!==N))},M=()=>{fetch(`/api/v1/files/fileDownloads/${R.file_id}/?file_name=${R.file_name}`,{method:"POST"}).then(v=>v.blob()).then(v=>{let N=document.createElement("a");N.href=window.URL.createObjectURL(v),N.download=R.file_name,N.click()}).catch(v=>Z.setAlert(v.message,"Error"))};return jsxRuntimeExports.jsxs("div",{style:{display:"flex"},children:[U&&jsxRuntimeExports.jsx("div",{style:{textAlign:"left"},children:jsxRuntimeExports.jsx("input",{type:"checkbox",value:R.file_name,onChange:L,checked:A.includes(R.file_name)})}),jsxRuntimeExports.jsxs("div",{className:"feed_item",style:{background:`${A!=null&&A.includes(R.file_name)?"#5b85db17":""}`},children:[jsxRuntimeExports.jsxs("div",{style:{textAlign:"right"},className:"flex_1",children:[jsxRuntimeExports.jsxs("span",{className:"tooltip-icon",children:[jsxRuntimeExports.jsx("span",{className:"tooltipText",children:"Share"}),jsxRuntimeExports.jsx(UilShare,{size:"1.2em",color:"#F98746",onClick:()=>{A.includes(R.file_name)||(i([...A,R.file_name]),l(!0))},style:{background:"#ffebaa"},className:"file_icon"})]}),jsxRuntimeExports.jsxs("span",{className:"tooltip-icon",children:[jsxRuntimeExports.jsx("span",{className:"tooltipText",children:"Download"}),jsxRuntimeExports.jsx(UilImport,{size:"1.2em",color:"#5AAF52",className:"file_icon",style:{background:"#beffb6"},onClick:M})]})]}),jsxRuntimeExports.jsx("div",{className:"flex_2",children:jsxRuntimeExports.jsxs("span",{className:"tooltip-icon",onClick:()=>{q(R),G(!0)},children:[jsxRuntimeExports.jsx("span",{className:"tooltipText",children:"Preview"}),getFileIcon(R)]})}),jsxRuntimeExports.jsxs("div",{className:"file_details flex_3",children:[jsxRuntimeExports.jsx("h2",{children:R.title}),jsxRuntimeExports.jsx("p",{className:"file_description",children:R.file_description})]})]},R.file_id)]})};FeedItem.propTypes={file:PropTypes.object,fileNames:PropTypes.any,setFileNames:PropTypes.func,setIsCheckBoxActive:PropTypes.func,setSelectedPreviewFile:PropTypes.func,setIsPreviewPaneActive:PropTypes.func,isCheckBoxActive:PropTypes.bool};const ClientListModalWindow=({setIsModalActive:R,fileNames:i,setFileNames:U,setIsCheckBoxActive:l})=>{const[A,G]=reactExports.useState(null),[q,Z]=reactExports.useState([]),[L,M]=reactExports.useState(null),[v,N]=reactExports.useState(null),[w,P]=reactExports.useState(!1),[p,f]=reactExports.useState(null),c=[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15],_=reactExports.useRef({caption:"",subject:""});reactExports.useEffect(()=>{f(!0),fetch("/api/v1/clients/?fields=client_first_name,client_last_name,client_email,client_id&client_status=1&sort=client_last_name,client_first_name:asc").then(n=>n.json()).then(n=>{if(n.status==="success")G(n.clientsContacts),f(!1);else throw f(!1),new Error(n.message)}).catch(n=>M(n.message))},[]);const E=n=>{const{value:h}=n.target;n.target.checked?Z([...q,h]):Z(q.filter(o=>o!==h))},C=n=>{if(n.target.checked){const h=A.map(o=>`${o.client_id}`);Z(h)}else Z([])},m=n=>{_.current={..._.current,[n.target.name]:n.target.value}},e=n=>{n.preventDefault(),P(!0),fetch(`/api/v1/files/share?client_ids=${q.join(",")}&fileName=${i}`,{method:"POST",headers:{"Content-type":"application/json"},body:JSON.stringify(_.current)}).then(h=>h.json()).then(h=>{if(h.status==="success")P(!1),N(h.message),setTimeout(()=>{U([]),R(!1),l(!1)},800);else throw P(!1),new Error(h.message)}).catch(h=>N(h.message))};return jsxRuntimeExports.jsxs("div",{className:"client_modal_window",children:[jsxRuntimeExports.jsx("div",{style:{textAlign:"right",marginTop:".7em"},children:jsxRuntimeExports.jsx(UilTimes,{size:"2em",onClick:()=>{R(!1)},className:"close-modal-btn"})}),jsxRuntimeExports.jsx("div",{style:{display:"flex",justifyContent:"center"},children:L&&jsxRuntimeExports.jsxs("div",{className:"component-alert",children:[jsxRuntimeExports.jsx(UilInfoCircle,{size:"1.5em",style:{margin:"auto 0.5em"}}),jsxRuntimeExports.jsx("b",{style:{margin:"auto 0"},children:L})]})}),jsxRuntimeExports.jsx("div",{style:{display:"flex",justifyContent:"center"},children:v&&jsxRuntimeExports.jsxs("div",{className:"component-alert",children:[jsxRuntimeExports.jsx(UilInfoCircle,{size:"1.5em",style:{margin:"auto 0.5em"}}),jsxRuntimeExports.jsx("b",{style:{margin:"auto 0"},children:v})]})}),jsxRuntimeExports.jsx("h2",{style:{textAlign:"left",padding:"0 0.4em"},children:"Share to your clients"}),jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsxs("form",{onSubmit:e,className:"email-subject-form",children:[jsxRuntimeExports.jsxs("div",{className:"input-block",children:[jsxRuntimeExports.jsx("input",{type:"text",name:"subject",onChange:m,required:!0}),jsxRuntimeExports.jsx("span",{className:"placeholder",children:"Subject:"})]}),jsxRuntimeExports.jsx("div",{className:"input-block",children:jsxRuntimeExports.jsx("textarea",{name:"caption",placeholder:"A short description of the files being shared",required:!0,style:{resize:"none"},rows:"5",cols:"42",onChange:m})}),jsxRuntimeExports.jsx("button",{className:"submit_btn email-submit",children:w?"Sending...":"Send"})]})}),jsxRuntimeExports.jsxs("span",{style:{display:"flex",justifyContent:"flex-end",padding:"0 1em"},children:[jsxRuntimeExports.jsx("input",{type:"checkbox",onChange:C,checked:q.length===(A==null?void 0:A.length)}),jsxRuntimeExports.jsx("label",{htmlFor:"",style:{margin:"auto 0"},children:"Select all"})]}),p?c.map(n=>jsxRuntimeExports.jsx(SkeletonClientItem,{},n)):(A==null?void 0:A.length)>0?A.map(n=>jsxRuntimeExports.jsxs("div",{className:"client_item",children:[jsxRuntimeExports.jsx("div",{className:"checkbox",children:jsxRuntimeExports.jsx("input",{type:"checkbox",value:n.client_id,onChange:E,checked:q.includes(`${n.client_id}`)})}),jsxRuntimeExports.jsxs("div",{className:"client_details",children:[jsxRuntimeExports.jsx("b",{children:`${n.client_first_name} ${n.client_last_name}`}),jsxRuntimeExports.jsx("p",{children:n.client_email})]})]},n.client_id)):jsxRuntimeExports.jsxs("div",{style:{margin:"0 auto",width:"fit-content"},children:[jsxRuntimeExports.jsx("p",{children:"No clients added yet"}),jsxRuntimeExports.jsxs("button",{className:"add-client-btn",children:[jsxRuntimeExports.jsx("span",{children:"Add Client"}),jsxRuntimeExports.jsx(UilPlusCircle,{size:"1.3em",color:"#121927"})]})]})]})};ClientListModalWindow.propTypes={setIsModalActive:PropTypes.func,setIsCheckBoxActive:PropTypes.func,setFileNames:PropTypes.func,fileNames:PropTypes.string};function commonjsRequire(R){throw new Error('Could not dynamically require "'+R+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var pdf$1={exports:{}};const __viteBrowserExternal={},__viteBrowserExternal$1=Object.freeze(Object.defineProperty({__proto__:null,default:__viteBrowserExternal},Symbol.toStringTag,{value:"Module"})),require$$5=getAugmentedNamespace(__viteBrowserExternal$1);(function(module,exports){(function(i,U){module.exports=U()})(globalThis,()=>(()=>{var __webpack_modules__=[,(R,i)=>{var Mt;Object.defineProperty(i,"__esModule",{value:!0}),i.VerbosityLevel=i.Util=i.UnknownErrorException=i.UnexpectedResponseException=i.TextRenderingMode=i.RenderingIntentFlag=i.PromiseCapability=i.PermissionFlag=i.PasswordResponses=i.PasswordException=i.PageActionEventType=i.OPS=i.MissingPDFException=i.MAX_IMAGE_SIZE_TO_CACHE=i.LINE_FACTOR=i.LINE_DESCENT_FACTOR=i.InvalidPDFException=i.ImageKind=i.IDENTITY_MATRIX=i.FormatError=i.FeatureTest=i.FONT_IDENTITY_MATRIX=i.DocumentActionEventType=i.CMapCompressionType=i.BaseException=i.BASELINE_FACTOR=i.AnnotationType=i.AnnotationStateModelType=i.AnnotationReviewState=i.AnnotationReplyType=i.AnnotationMode=i.AnnotationMarkedState=i.AnnotationFlag=i.AnnotationFieldFlag=i.AnnotationEditorType=i.AnnotationEditorPrefix=i.AnnotationEditorParamsType=i.AnnotationBorderStyleType=i.AnnotationActionEventType=i.AbortException=void 0,i.assert=At,i.bytesToString=I,i.createValidAbsoluteUrl=_t,i.getModificationDate=vt,i.getVerbosityLevel=ut,i.info=lt,i.isArrayBuffer=pt,i.isArrayEqual=xt,i.normalizeUnicode=St,i.objectFromMap=S,i.objectSize=b,i.setVerbosityLevel=et,i.shadow=z,i.string32=a,i.stringToBytes=t,i.stringToPDFString=nt,i.stringToUTF8String=at,i.unreachable=mt,i.utf8StringToString=ft,i.warn=ht;const U=[1,0,0,1,0,0];i.IDENTITY_MATRIX=U;const l=[.001,0,0,.001,0,0];i.FONT_IDENTITY_MATRIX=l;const A=1e7;i.MAX_IMAGE_SIZE_TO_CACHE=A;const G=1.35;i.LINE_FACTOR=G;const q=.35;i.LINE_DESCENT_FACTOR=q;const Z=q/G;i.BASELINE_FACTOR=Z;const L={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256};i.RenderingIntentFlag=L;const M={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3};i.AnnotationMode=M;const v="pdfjs_internal_editor_";i.AnnotationEditorPrefix=v;const N={DISABLE:-1,NONE:0,FREETEXT:3,INK:15};i.AnnotationEditorType=N;const w={FREETEXT_SIZE:1,FREETEXT_COLOR:2,FREETEXT_OPACITY:3,INK_COLOR:11,INK_THICKNESS:12,INK_OPACITY:13};i.AnnotationEditorParamsType=w;const P={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048};i.PermissionFlag=P;const p={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4};i.TextRenderingMode=p;const f={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3};i.ImageKind=f;const c={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26};i.AnnotationType=c;const _={MARKED:"Marked",REVIEW:"Review"};i.AnnotationStateModelType=_;const E={MARKED:"Marked",UNMARKED:"Unmarked"};i.AnnotationMarkedState=E;const C={ACCEPTED:"Accepted",REJECTED:"Rejected",CANCELLED:"Cancelled",COMPLETED:"Completed",NONE:"None"};i.AnnotationReviewState=C;const m={GROUP:"Group",REPLY:"R"};i.AnnotationReplyType=m;const e={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512};i.AnnotationFlag=e;const n={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864};i.AnnotationFieldFlag=n;const h={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5};i.AnnotationBorderStyleType=h;const o={E:"Mouse Enter",X:"Mouse Exit",D:"Mouse Down",U:"Mouse Up",Fo:"Focus",Bl:"Blur",PO:"PageOpen",PC:"PageClose",PV:"PageVisible",PI:"PageInvisible",K:"Keystroke",F:"Format",V:"Validate",C:"Calculate"};i.AnnotationActionEventType=o;const d={WC:"WillClose",WS:"WillSave",DS:"DidSave",WP:"WillPrint",DP:"DidPrint"};i.DocumentActionEventType=d;const F={O:"PageOpen",C:"PageClose"};i.PageActionEventType=F;const s={ERRORS:0,WARNINGS:1,INFOS:5};i.VerbosityLevel=s;const B={NONE:0,BINARY:1};i.CMapCompressionType=B;const V={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91};i.OPS=V;const Y={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};i.PasswordResponses=Y;let Q=s.WARNINGS;function et(dt){Number.isInteger(dt)&&(Q=dt)}function ut(){return Q}function lt(dt){Q>=s.INFOS&&console.log(`Info: ${dt}`)}function ht(dt){Q>=s.WARNINGS&&console.log(`Warning: ${dt}`)}function mt(dt){throw new Error(dt)}function At(dt,k){dt||mt(k)}function Et(dt){switch(dt==null?void 0:dt.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function _t(dt,k=null,j=null){if(!dt)return null;try{if(j&&typeof dt=="string"){if(j.addDefaultProtocol&&dt.startsWith("www.")){const bt=dt.match(/\./g);(bt==null?void 0:bt.length)>=2&&(dt=`http://${dt}`)}if(j.tryConvertEncoding)try{dt=at(dt)}catch{}}const ct=k?new URL(dt,k):new URL(dt);if(Et(ct))return ct}catch{}return null}function z(dt,k,j,ct=!1){return Object.defineProperty(dt,k,{value:j,enumerable:!ct,configurable:!0,writable:!1}),j}const u=function(){function k(j,ct){this.constructor===k&&mt("Cannot initialize BaseException."),this.message=j,this.name=ct}return k.prototype=new Error,k.constructor=k,k}();i.BaseException=u;class g extends u{constructor(k,j){super(k,"PasswordException"),this.code=j}}i.PasswordException=g;class x extends u{constructor(k,j){super(k,"UnknownErrorException"),this.details=j}}i.UnknownErrorException=x;class H extends u{constructor(k){super(k,"InvalidPDFException")}}i.InvalidPDFException=H;class D extends u{constructor(k){super(k,"MissingPDFException")}}i.MissingPDFException=D;class X extends u{constructor(k,j){super(k,"UnexpectedResponseException"),this.status=j}}i.UnexpectedResponseException=X;class W extends u{constructor(k){super(k,"FormatError")}}i.FormatError=W;class O extends u{constructor(k){super(k,"AbortException")}}i.AbortException=O;function I(dt){(typeof dt!="object"||(dt==null?void 0:dt.length)===void 0)&&mt("Invalid argument for bytesToString");const k=dt.length,j=8192;if(k<j)return String.fromCharCode.apply(null,dt);const ct=[];for(let bt=0;bt<k;bt+=j){const Pt=Math.min(bt+j,k),wt=dt.subarray(bt,Pt);ct.push(String.fromCharCode.apply(null,wt))}return ct.join("")}function t(dt){typeof dt!="string"&&mt("Invalid argument for stringToBytes");const k=dt.length,j=new Uint8Array(k);for(let ct=0;ct<k;++ct)j[ct]=dt.charCodeAt(ct)&255;return j}function a(dt){return String.fromCharCode(dt>>24&255,dt>>16&255,dt>>8&255,dt&255)}function b(dt){return Object.keys(dt).length}function S(dt){const k=Object.create(null);for(const[j,ct]of dt)k[j]=ct;return k}function T(){const dt=new Uint8Array(4);return dt[0]=1,new Uint32Array(dt.buffer,0,1)[0]===1}function $(){try{return new Function(""),!0}catch{return!1}}class st{static get isLittleEndian(){return z(this,"isLittleEndian",T())}static get isEvalSupported(){return z(this,"isEvalSupported",$())}static get isOffscreenCanvasSupported(){return z(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get platform(){return typeof navigator>"u"?z(this,"platform",{isWin:!1,isMac:!1}):z(this,"platform",{isWin:navigator.platform.includes("Win"),isMac:navigator.platform.includes("Mac")})}}i.FeatureTest=st;const J=[...Array(256).keys()].map(dt=>dt.toString(16).padStart(2,"0"));class rt{static makeHexColor(k,j,ct){return`#${J[k]}${J[j]}${J[ct]}`}static scaleMinMax(k,j){let ct;k[0]?(k[0]<0&&(ct=j[0],j[0]=j[1],j[1]=ct),j[0]*=k[0],j[1]*=k[0],k[3]<0&&(ct=j[2],j[2]=j[3],j[3]=ct),j[2]*=k[3],j[3]*=k[3]):(ct=j[0],j[0]=j[2],j[2]=ct,ct=j[1],j[1]=j[3],j[3]=ct,k[1]<0&&(ct=j[2],j[2]=j[3],j[3]=ct),j[2]*=k[1],j[3]*=k[1],k[2]<0&&(ct=j[0],j[0]=j[1],j[1]=ct),j[0]*=k[2],j[1]*=k[2]),j[0]+=k[4],j[1]+=k[4],j[2]+=k[5],j[3]+=k[5]}static transform(k,j){return[k[0]*j[0]+k[2]*j[1],k[1]*j[0]+k[3]*j[1],k[0]*j[2]+k[2]*j[3],k[1]*j[2]+k[3]*j[3],k[0]*j[4]+k[2]*j[5]+k[4],k[1]*j[4]+k[3]*j[5]+k[5]]}static applyTransform(k,j){const ct=k[0]*j[0]+k[1]*j[2]+j[4],bt=k[0]*j[1]+k[1]*j[3]+j[5];return[ct,bt]}static applyInverseTransform(k,j){const ct=j[0]*j[3]-j[1]*j[2],bt=(k[0]*j[3]-k[1]*j[2]+j[2]*j[5]-j[4]*j[3])/ct,Pt=(-k[0]*j[1]+k[1]*j[0]+j[4]*j[1]-j[5]*j[0])/ct;return[bt,Pt]}static getAxialAlignedBoundingBox(k,j){const ct=rt.applyTransform(k,j),bt=rt.applyTransform(k.slice(2,4),j),Pt=rt.applyTransform([k[0],k[3]],j),wt=rt.applyTransform([k[2],k[1]],j);return[Math.min(ct[0],bt[0],Pt[0],wt[0]),Math.min(ct[1],bt[1],Pt[1],wt[1]),Math.max(ct[0],bt[0],Pt[0],wt[0]),Math.max(ct[1],bt[1],Pt[1],wt[1])]}static inverseTransform(k){const j=k[0]*k[3]-k[1]*k[2];return[k[3]/j,-k[1]/j,-k[2]/j,k[0]/j,(k[2]*k[5]-k[4]*k[3])/j,(k[4]*k[1]-k[5]*k[0])/j]}static singularValueDecompose2dScale(k){const j=[k[0],k[2],k[1],k[3]],ct=k[0]*j[0]+k[1]*j[2],bt=k[0]*j[1]+k[1]*j[3],Pt=k[2]*j[0]+k[3]*j[2],wt=k[2]*j[1]+k[3]*j[3],kt=(ct+wt)/2,Rt=Math.sqrt((ct+wt)**2-4*(ct*wt-Pt*bt))/2,Ot=kt+Rt||1,Ct=kt-Rt||1;return[Math.sqrt(Ot),Math.sqrt(Ct)]}static normalizeRect(k){const j=k.slice(0);return k[0]>k[2]&&(j[0]=k[2],j[2]=k[0]),k[1]>k[3]&&(j[1]=k[3],j[3]=k[1]),j}static intersect(k,j){const ct=Math.max(Math.min(k[0],k[2]),Math.min(j[0],j[2])),bt=Math.min(Math.max(k[0],k[2]),Math.max(j[0],j[2]));if(ct>bt)return null;const Pt=Math.max(Math.min(k[1],k[3]),Math.min(j[1],j[3])),wt=Math.min(Math.max(k[1],k[3]),Math.max(j[1],j[3]));return Pt>wt?null:[ct,Pt,bt,wt]}static bezierBoundingBox(k,j,ct,bt,Pt,wt,kt,Rt){const Ot=[],Ct=[[],[]];let Nt,Dt,It,Ft,Bt,Wt,Gt,qt;for(let Xt=0;Xt<2;++Xt){if(Xt===0?(Dt=6*k-12*ct+6*Pt,Nt=-3*k+9*ct-9*Pt+3*kt,It=3*ct-3*k):(Dt=6*j-12*bt+6*wt,Nt=-3*j+9*bt-9*wt+3*Rt,It=3*bt-3*j),Math.abs(Nt)<1e-12){if(Math.abs(Dt)<1e-12)continue;Ft=-It/Dt,0<Ft&&Ft<1&&Ot.push(Ft);continue}Gt=Dt*Dt-4*It*Nt,qt=Math.sqrt(Gt),!(Gt<0)&&(Bt=(-Dt+qt)/(2*Nt),0<Bt&&Bt<1&&Ot.push(Bt),Wt=(-Dt-qt)/(2*Nt),0<Wt&&Wt<1&&Ot.push(Wt))}let jt=Ot.length,Ut;const $t=jt;for(;jt--;)Ft=Ot[jt],Ut=1-Ft,Ct[0][jt]=Ut*Ut*Ut*k+3*Ut*Ut*Ft*ct+3*Ut*Ft*Ft*Pt+Ft*Ft*Ft*kt,Ct[1][jt]=Ut*Ut*Ut*j+3*Ut*Ut*Ft*bt+3*Ut*Ft*Ft*wt+Ft*Ft*Ft*Rt;return Ct[0][$t]=k,Ct[1][$t]=j,Ct[0][$t+1]=kt,Ct[1][$t+1]=Rt,Ct[0].length=Ct[1].length=$t+2,[Math.min(...Ct[0]),Math.min(...Ct[1]),Math.max(...Ct[0]),Math.max(...Ct[1])]}}i.Util=rt;const ot=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364];function nt(dt){if(dt[0]>="ï"){let j;if(dt[0]==="þ"&&dt[1]==="ÿ"?j="utf-16be":dt[0]==="ÿ"&&dt[1]==="þ"?j="utf-16le":dt[0]==="ï"&&dt[1]==="»"&&dt[2]==="¿"&&(j="utf-8"),j)try{const ct=new TextDecoder(j,{fatal:!0}),bt=t(dt);return ct.decode(bt)}catch(ct){ht(`stringToPDFString: "${ct}".`)}}const k=[];for(let j=0,ct=dt.length;j<ct;j++){const bt=ot[dt.charCodeAt(j)];k.push(bt?String.fromCharCode(bt):dt.charAt(j))}return k.join("")}function at(dt){return decodeURIComponent(escape(dt))}function ft(dt){return unescape(encodeURIComponent(dt))}function pt(dt){return typeof dt=="object"&&(dt==null?void 0:dt.byteLength)!==void 0}function xt(dt,k){if(dt.length!==k.length)return!1;for(let j=0,ct=dt.length;j<ct;j++)if(dt[j]!==k[j])return!1;return!0}function vt(dt=new Date){return[dt.getUTCFullYear().toString(),(dt.getUTCMonth()+1).toString().padStart(2,"0"),dt.getUTCDate().toString().padStart(2,"0"),dt.getUTCHours().toString().padStart(2,"0"),dt.getUTCMinutes().toString().padStart(2,"0"),dt.getUTCSeconds().toString().padStart(2,"0")].join("")}class Tt{constructor(){tt(this,Mt,!1);this.promise=new Promise((k,j)=>{this.resolve=ct=>{gt(this,Mt,!0),k(ct)},this.reject=ct=>{gt(this,Mt,!0),j(ct)}})}get settled(){return y(this,Mt)}}Mt=new WeakMap,i.PromiseCapability=Tt;let K=null,yt=null;function St(dt){return K||(K=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,yt=new Map([["ﬅ","ſt"]])),dt.replaceAll(K,(k,j,ct)=>j?j.normalize("NFKC"):yt.get(ct))}},(__unused_webpack_module,exports,__w_pdfjs_require__)=>{var R,U,l,A,Jt,q,ae,L,M,v,N,w,P,p,f,fe,_,E,pe,m,e;Object.defineProperty(exports,"__esModule",{value:!0}),exports.build=exports.RenderTask=exports.PDFWorkerUtil=exports.PDFWorker=exports.PDFPageProxy=exports.PDFDocumentProxy=exports.PDFDocumentLoadingTask=exports.PDFDataRangeTransport=exports.LoopbackPort=exports.DefaultStandardFontDataFactory=exports.DefaultFilterFactory=exports.DefaultCanvasFactory=exports.DefaultCMapReaderFactory=void 0,exports.getDocument=getDocument,exports.version=void 0;var _util=__w_pdfjs_require__(1),_annotation_storage=__w_pdfjs_require__(3),_display_utils=__w_pdfjs_require__(6),_font_loader=__w_pdfjs_require__(9),_canvas=__w_pdfjs_require__(11),_worker_options=__w_pdfjs_require__(14),_is_node=__w_pdfjs_require__(10),_message_handler=__w_pdfjs_require__(15),_metadata=__w_pdfjs_require__(16),_optional_content_config=__w_pdfjs_require__(17),_transport_stream=__w_pdfjs_require__(18),_xfa_text=__w_pdfjs_require__(19);const DEFAULT_RANGE_CHUNK_SIZE=65536,RENDERING_CANCELLED_TIMEOUT=100,DELAYED_CLEANUP_TIMEOUT=5e3;let DefaultCanvasFactory=_display_utils.DOMCanvasFactory;exports.DefaultCanvasFactory=DefaultCanvasFactory;let DefaultCMapReaderFactory=_display_utils.DOMCMapReaderFactory;exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory;let DefaultFilterFactory=_display_utils.DOMFilterFactory;exports.DefaultFilterFactory=DefaultFilterFactory;let DefaultStandardFontDataFactory=_display_utils.DOMStandardFontDataFactory;if(exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory,_is_node.isNodeJS){const{NodeCanvasFactory:h,NodeCMapReaderFactory:o,NodeFilterFactory:d,NodeStandardFontDataFactory:F}=__w_pdfjs_require__(20);exports.DefaultCanvasFactory=DefaultCanvasFactory=h,exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory=o,exports.DefaultFilterFactory=DefaultFilterFactory=d,exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory=F}let createPDFNetworkStream;if(_is_node.isNodeJS){const{PDFNodeStream:h}=__w_pdfjs_require__(21);createPDFNetworkStream=o=>new h(o)}else{const{PDFNetworkStream:h}=__w_pdfjs_require__(24),{PDFFetchStream:o}=__w_pdfjs_require__(25);createPDFNetworkStream=d=>(0,_display_utils.isValidFetchUrl)(d.url)?new o(d):new h(d)}function getDocument(h){if(typeof h=="string"||h instanceof URL?h={url:h}:(0,_util.isArrayBuffer)(h)&&(h={data:h}),typeof h!="object")throw new Error("Invalid parameter in getDocument, need parameter object.");if(!h.url&&!h.data&&!h.range)throw new Error("Invalid parameter object: need either .data, .range or .url");const o=new PDFDocumentLoadingTask,{docId:d}=o,F=h.url?getUrlProp(h.url):null,s=h.data?getDataProp(h.data):null,B=h.httpHeaders||null,V=h.withCredentials===!0,Y=h.password??null,Q=h.range instanceof PDFDataRangeTransport?h.range:null,et=Number.isInteger(h.rangeChunkSize)&&h.rangeChunkSize>0?h.rangeChunkSize:DEFAULT_RANGE_CHUNK_SIZE;let ut=h.worker instanceof PDFWorker?h.worker:null;const lt=h.verbosity,ht=typeof h.docBaseUrl=="string"&&!(0,_display_utils.isDataScheme)(h.docBaseUrl)?h.docBaseUrl:null,mt=typeof h.cMapUrl=="string"?h.cMapUrl:null,At=h.cMapPacked!==!1,Et=h.CMapReaderFactory||DefaultCMapReaderFactory,_t=typeof h.standardFontDataUrl=="string"?h.standardFontDataUrl:null,z=h.StandardFontDataFactory||DefaultStandardFontDataFactory,u=h.stopAtErrors!==!0,g=Number.isInteger(h.maxImageSize)&&h.maxImageSize>-1?h.maxImageSize:-1,x=h.isEvalSupported!==!1,H=typeof h.isOffscreenCanvasSupported=="boolean"?h.isOffscreenCanvasSupported:!_is_node.isNodeJS,D=Number.isInteger(h.canvasMaxAreaInBytes)?h.canvasMaxAreaInBytes:-1,X=typeof h.disableFontFace=="boolean"?h.disableFontFace:_is_node.isNodeJS,W=h.fontExtraProperties===!0,O=h.enableXfa===!0,I=h.ownerDocument||globalThis.document,t=h.disableRange===!0,a=h.disableStream===!0,b=h.disableAutoFetch===!0,S=h.pdfBug===!0,T=Q?Q.length:h.length??NaN,$=typeof h.useSystemFonts=="boolean"?h.useSystemFonts:!_is_node.isNodeJS&&!X,st=typeof h.useWorkerFetch=="boolean"?h.useWorkerFetch:Et===_display_utils.DOMCMapReaderFactory&&z===_display_utils.DOMStandardFontDataFactory&&(0,_display_utils.isValidFetchUrl)(mt,document.baseURI)&&(0,_display_utils.isValidFetchUrl)(_t,document.baseURI),J=h.canvasFactory||new DefaultCanvasFactory({ownerDocument:I}),rt=h.filterFactory||new DefaultFilterFactory({docId:d,ownerDocument:I}),ot=null;(0,_util.setVerbosityLevel)(lt);const nt={canvasFactory:J,filterFactory:rt};if(st||(nt.cMapReaderFactory=new Et({baseUrl:mt,isCompressed:At}),nt.standardFontDataFactory=new z({baseUrl:_t})),!ut){const pt={verbosity:lt,port:_worker_options.GlobalWorkerOptions.workerPort};ut=pt.port?PDFWorker.fromPort(pt):new PDFWorker(pt),o._worker=ut}const at={docId:d,apiVersion:"3.6.172",data:s,password:Y,disableAutoFetch:b,rangeChunkSize:et,length:T,docBaseUrl:ht,enableXfa:O,evaluatorOptions:{maxImageSize:g,disableFontFace:X,ignoreErrors:u,isEvalSupported:x,isOffscreenCanvasSupported:H,canvasMaxAreaInBytes:D,fontExtraProperties:W,useSystemFonts:$,cMapUrl:st?mt:null,standardFontDataUrl:st?_t:null}},ft={ignoreErrors:u,isEvalSupported:x,disableFontFace:X,fontExtraProperties:W,enableXfa:O,ownerDocument:I,disableAutoFetch:b,pdfBug:S,styleElement:ot};return ut.promise.then(function(){if(o.destroyed)throw new Error("Loading aborted");const pt=_fetchDocument(ut,at),xt=new Promise(function(vt){let Tt;Q?Tt=new _transport_stream.PDFDataTransportStream({length:T,initialData:Q.initialData,progressiveDone:Q.progressiveDone,contentDispositionFilename:Q.contentDispositionFilename,disableRange:t,disableStream:a},Q):s||(Tt=createPDFNetworkStream({url:F,length:T,httpHeaders:B,withCredentials:V,rangeChunkSize:et,disableRange:t,disableStream:a})),vt(Tt)});return Promise.all([pt,xt]).then(function([vt,Tt]){if(o.destroyed)throw new Error("Loading aborted");const K=new _message_handler.MessageHandler(d,vt,ut.port),yt=new WorkerTransport(K,o,Tt,ft,nt);o._transport=yt,K.send("Ready",null)})}).catch(o._capability.reject),o}async function _fetchDocument(h,o){if(h.destroyed)throw new Error("Worker was destroyed");const d=await h.messageHandler.sendWithPromise("GetDocRequest",o,o.data?[o.data.buffer]:null);if(h.destroyed)throw new Error("Worker was destroyed");return d}function getUrlProp(h){if(h instanceof URL)return h.href;try{return new URL(h,window.location).href}catch{if(_is_node.isNodeJS&&typeof h=="string")return h}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function getDataProp(h){if(_is_node.isNodeJS&&typeof Buffer<"u"&&h instanceof Buffer)return(0,_display_utils.deprecated)("Please provide binary data as `Uint8Array`, rather than `Buffer`."),new Uint8Array(h);if(h instanceof Uint8Array&&h.byteLength===h.buffer.byteLength)return h;if(typeof h=="string")return(0,_util.stringToBytes)(h);if(typeof h=="object"&&!isNaN(h==null?void 0:h.length)||(0,_util.isArrayBuffer)(h))return new Uint8Array(h);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}const i=class{constructor(){this._capability=new _util.PromiseCapability,this._transport=null,this._worker=null,this.docId=`d${re(i,R)._++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){var o;this.destroyed=!0,await((o=this._transport)==null?void 0:o.destroy()),this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}};let PDFDocumentLoadingTask=i;R=new WeakMap,tt(PDFDocumentLoadingTask,R,0),exports.PDFDocumentLoadingTask=PDFDocumentLoadingTask;class PDFDataRangeTransport{constructor(o,d,F=!1,s=null){this.length=o,this.initialData=d,this.progressiveDone=F,this.contentDispositionFilename=s,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=new _util.PromiseCapability}addRangeListener(o){this._rangeListeners.push(o)}addProgressListener(o){this._progressListeners.push(o)}addProgressiveReadListener(o){this._progressiveReadListeners.push(o)}addProgressiveDoneListener(o){this._progressiveDoneListeners.push(o)}onDataRange(o,d){for(const F of this._rangeListeners)F(o,d)}onDataProgress(o,d){this._readyCapability.promise.then(()=>{for(const F of this._progressListeners)F(o,d)})}onDataProgressiveRead(o){this._readyCapability.promise.then(()=>{for(const d of this._progressiveReadListeners)d(o)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const o of this._progressiveDoneListeners)o()})}transportReady(){this._readyCapability.resolve()}requestDataRange(o,d){(0,_util.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}exports.PDFDataRangeTransport=PDFDataRangeTransport;class PDFDocumentProxy{constructor(o,d){this._pdfInfo=o,this._transport=d}get annotationStorage(){return this._transport.annotationStorage}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(o){return this._transport.getPage(o)}getPageIndex(o){return this._transport.getPageIndex(o)}getDestinations(){return this._transport.getDestinations()}getDestination(o){return this._transport.getDestination(o)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJavaScript(){return this._transport.getJavaScript()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){return this._transport.getOptionalContentConfig()}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(o=!1){return this._transport.startCleanup(o||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}exports.PDFDocumentProxy=PDFDocumentProxy;class PDFPageProxy{constructor(o,d,F,s=!1){tt(this,A);tt(this,q);tt(this,U,null);tt(this,l,!1);this._pageIndex=o,this._pageInfo=d,this._transport=F,this._stats=s?new _display_utils.StatTimer:null,this._pdfBug=s,this.commonObjs=F.commonObjs,this.objs=new PDFObjects,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:o,rotation:d=this.rotate,offsetX:F=0,offsetY:s=0,dontFlip:B=!1}={}){return new _display_utils.PageViewport({viewBox:this.view,scale:o,rotation:d,offsetX:F,offsetY:s,dontFlip:B})}getAnnotations({intent:o="display"}={}){const d=this._transport.getRenderingIntent(o);return this._transport.getAnnotations(this._pageIndex,d.renderingIntent)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var o;return((o=this._transport._htmlForXfa)==null?void 0:o.children[this._pageIndex])||null}render({canvasContext:o,viewport:d,intent:F="display",annotationMode:s=_util.AnnotationMode.ENABLE,transform:B=null,background:V=null,optionalContentConfigPromise:Y=null,annotationCanvasMap:Q=null,pageColors:et=null,printAnnotationStorage:ut=null}){var z,u,g;if((z=arguments[0])!=null&&z.canvasFactory)throw new Error("render no longer accepts the `canvasFactory`-option, please pass it to the `getDocument`-function instead.");(u=this._stats)==null||u.time("Overall");const lt=this._transport.getRenderingIntent(F,s,ut);gt(this,l,!1),it(this,q,ae).call(this),Y||(Y=this._transport.getOptionalContentConfig());let ht=this._intentStates.get(lt.cacheKey);ht||(ht=Object.create(null),this._intentStates.set(lt.cacheKey,ht)),ht.streamReaderCancelTimeout&&(clearTimeout(ht.streamReaderCancelTimeout),ht.streamReaderCancelTimeout=null);const mt=!!(lt.renderingIntent&_util.RenderingIntentFlag.PRINT);ht.displayReadyCapability||(ht.displayReadyCapability=new _util.PromiseCapability,ht.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(g=this._stats)==null||g.time("Page Request"),this._pumpOperatorList(lt));const At=x=>{var H,D;ht.renderTasks.delete(Et),(this._maybeCleanupAfterRender||mt)&&gt(this,l,!0),it(this,A,Jt).call(this,!mt),x?(Et.capability.reject(x),this._abortOperatorList({intentState:ht,reason:x instanceof Error?x:new Error(x)})):Et.capability.resolve(),(H=this._stats)==null||H.timeEnd("Rendering"),(D=this._stats)==null||D.timeEnd("Overall")},Et=new InternalRenderTask({callback:At,params:{canvasContext:o,viewport:d,transform:B,background:V},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:Q,operatorList:ht.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!mt,pdfBug:this._pdfBug,pageColors:et});(ht.renderTasks||(ht.renderTasks=new Set)).add(Et);const _t=Et.task;return Promise.all([ht.displayReadyCapability.promise,Y]).then(([x,H])=>{var D;if(y(this,l)){At();return}(D=this._stats)==null||D.time("Rendering"),Et.initializeGraphics({transparency:x,optionalContentConfig:H}),Et.operatorListChanged()}).catch(At),_t}getOperatorList({intent:o="display",annotationMode:d=_util.AnnotationMode.ENABLE,printAnnotationStorage:F=null}={}){var Q;function s(){V.operatorList.lastChunk&&(V.opListReadCapability.resolve(V.operatorList),V.renderTasks.delete(Y))}const B=this._transport.getRenderingIntent(o,d,F,!0);let V=this._intentStates.get(B.cacheKey);V||(V=Object.create(null),this._intentStates.set(B.cacheKey,V));let Y;return V.opListReadCapability||(Y=Object.create(null),Y.operatorListChanged=s,V.opListReadCapability=new _util.PromiseCapability,(V.renderTasks||(V.renderTasks=new Set)).add(Y),V.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(Q=this._stats)==null||Q.time("Page Request"),this._pumpOperatorList(B)),V.opListReadCapability.promise}streamTextContent({includeMarkedContent:o=!1,disableNormalization:d=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:o===!0,disableNormalization:d===!0},{highWaterMark:100,size(s){return s.items.length}})}getTextContent(o={}){if(this._transport._htmlForXfa)return this.getXfa().then(F=>_xfa_text.XfaText.textContent(F));const d=this.streamTextContent(o);return new Promise(function(F,s){function B(){V.read().then(function({value:Q,done:et}){if(et){F(Y);return}Object.assign(Y.styles,Q.styles),Y.items.push(...Q.items),B()},s)}const V=d.getReader(),Y={items:[],styles:Object.create(null)};B()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const o=[];for(const d of this._intentStates.values())if(this._abortOperatorList({intentState:d,reason:new Error("Page was destroyed."),force:!0}),!d.opListReadCapability)for(const F of d.renderTasks)o.push(F.completed),F.cancel();return this.objs.clear(),gt(this,l,!1),it(this,q,ae).call(this),Promise.all(o)}cleanup(o=!1){gt(this,l,!0);const d=it(this,A,Jt).call(this,!1);return o&&d&&this._stats&&(this._stats=new _display_utils.StatTimer),d}_startRenderPage(o,d){var s,B;const F=this._intentStates.get(d);F&&((s=this._stats)==null||s.timeEnd("Page Request"),(B=F.displayReadyCapability)==null||B.resolve(o))}_renderPageChunk(o,d){for(let F=0,s=o.length;F<s;F++)d.operatorList.fnArray.push(o.fnArray[F]),d.operatorList.argsArray.push(o.argsArray[F]);d.operatorList.lastChunk=o.lastChunk,d.operatorList.separateAnnots=o.separateAnnots;for(const F of d.renderTasks)F.operatorListChanged();o.lastChunk&&it(this,A,Jt).call(this,!0)}_pumpOperatorList({renderingIntent:o,cacheKey:d,annotationStorageMap:F}){const B=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:o,cacheKey:d,annotationStorage:F}).getReader(),V=this._intentStates.get(d);V.streamReader=B;const Y=()=>{B.read().then(({value:Q,done:et})=>{if(et){V.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(Q,V),Y())},Q=>{if(V.streamReader=null,!this._transport.destroyed){if(V.operatorList){V.operatorList.lastChunk=!0;for(const et of V.renderTasks)et.operatorListChanged();it(this,A,Jt).call(this,!0)}if(V.displayReadyCapability)V.displayReadyCapability.reject(Q);else if(V.opListReadCapability)V.opListReadCapability.reject(Q);else throw Q}})};Y()}_abortOperatorList({intentState:o,reason:d,force:F=!1}){if(o.streamReader){if(o.streamReaderCancelTimeout&&(clearTimeout(o.streamReaderCancelTimeout),o.streamReaderCancelTimeout=null),!F){if(o.renderTasks.size>0)return;if(d instanceof _display_utils.RenderingCancelledException){let s=RENDERING_CANCELLED_TIMEOUT;d.extraDelay>0&&d.extraDelay<1e3&&(s+=d.extraDelay),o.streamReaderCancelTimeout=setTimeout(()=>{o.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:o,reason:d,force:!0})},s);return}}if(o.streamReader.cancel(new _util.AbortException(d.message)).catch(()=>{}),o.streamReader=null,!this._transport.destroyed){for(const[s,B]of this._intentStates)if(B===o){this._intentStates.delete(s);break}this.cleanup()}}}get stats(){return this._stats}}U=new WeakMap,l=new WeakMap,A=new WeakSet,Jt=function(o=!1){if(it(this,q,ae).call(this),!y(this,l))return!1;if(o)return gt(this,U,setTimeout(()=>{gt(this,U,null),it(this,A,Jt).call(this,!1)},DELAYED_CLEANUP_TIMEOUT)),!1;for(const{renderTasks:d,operatorList:F}of this._intentStates.values())if(d.size>0||!F.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),gt(this,l,!1),!0},q=new WeakSet,ae=function(){y(this,U)&&(clearTimeout(y(this,U)),gt(this,U,null))},exports.PDFPageProxy=PDFPageProxy;class LoopbackPort{constructor(){tt(this,L,new Set);tt(this,M,Promise.resolve())}postMessage(o,d){const F={data:structuredClone(o,d?{transfer:d}:null)};y(this,M).then(()=>{for(const s of y(this,L))s.call(this,F)})}addEventListener(o,d){y(this,L).add(d)}removeEventListener(o,d){y(this,L).delete(d)}terminate(){y(this,L).clear()}}L=new WeakMap,M=new WeakMap,exports.LoopbackPort=LoopbackPort;const PDFWorkerUtil={isWorkerDisabled:!1,fallbackWorkerSrc:null,fakeWorkerId:0};exports.PDFWorkerUtil=PDFWorkerUtil;{if(_is_node.isNodeJS&&typeof commonjsRequire=="function")PDFWorkerUtil.isWorkerDisabled=!0,PDFWorkerUtil.fallbackWorkerSrc="./pdf.worker.js";else if(typeof document=="object"){const h=(v=document==null?void 0:document.currentScript)==null?void 0:v.src;h&&(PDFWorkerUtil.fallbackWorkerSrc=h.replace(/(\.(?:min\.)?js)(\?.*)?$/i,".worker$1$2"))}PDFWorkerUtil.isSameOrigin=function(h,o){let d;try{if(d=new URL(h),!d.origin||d.origin==="null")return!1}catch{return!1}const F=new URL(o,d);return d.origin===F.origin},PDFWorkerUtil.createCDNWrapper=function(h){const o=`importScripts("${h}");`;return URL.createObjectURL(new Blob([o]))}}const _PDFWorker=class{constructor({name:h=null,port:o=null,verbosity:d=(0,_util.getVerbosityLevel)()}={}){if(o&&y(_PDFWorker,N).has(o))throw new Error("Cannot use more than one PDFWorker per port.");if(this.name=h,this.destroyed=!1,this.verbosity=d,this._readyCapability=new _util.PromiseCapability,this._port=null,this._webWorker=null,this._messageHandler=null,o){y(_PDFWorker,N).set(o,this),this._initializeFromPort(o);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(h){this._port=h,this._messageHandler=new _message_handler.MessageHandler("main","worker",h),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})}_initialize(){if(!PDFWorkerUtil.isWorkerDisabled&&!_PDFWorker._mainThreadWorkerMessageHandler){let{workerSrc:h}=_PDFWorker;try{PDFWorkerUtil.isSameOrigin(window.location.href,h)||(h=PDFWorkerUtil.createCDNWrapper(new URL(h,window.location).href));const o=new Worker(h),d=new _message_handler.MessageHandler("main","worker",o),F=()=>{o.removeEventListener("error",s),d.destroy(),o.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},s=()=>{this._webWorker||F()};o.addEventListener("error",s),d.on("test",V=>{if(o.removeEventListener("error",s),this.destroyed){F();return}V?(this._messageHandler=d,this._port=o,this._webWorker=o,this._readyCapability.resolve(),d.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),d.destroy(),o.terminate())}),d.on("ready",V=>{if(o.removeEventListener("error",s),this.destroyed){F();return}try{B()}catch{this._setupFakeWorker()}});const B=()=>{const V=new Uint8Array;d.send("test",V,[V.buffer])};B();return}catch{(0,_util.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){PDFWorkerUtil.isWorkerDisabled||((0,_util.warn)("Setting up fake worker."),PDFWorkerUtil.isWorkerDisabled=!0),_PDFWorker._setupFakeWorkerGlobal.then(h=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const o=new LoopbackPort;this._port=o;const d=`fake${PDFWorkerUtil.fakeWorkerId++}`,F=new _message_handler.MessageHandler(d+"_worker",d,o);h.setup(F,o);const s=new _message_handler.MessageHandler(d,d+"_worker",o);this._messageHandler=s,this._readyCapability.resolve(),s.send("configure",{verbosity:this.verbosity})}).catch(h=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${h.message}".`))})}destroy(){this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),y(_PDFWorker,N).delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(h){if(!(h!=null&&h.port))throw new Error("PDFWorker.fromPort - invalid method signature.");return y(this,N).has(h.port)?y(this,N).get(h.port):new _PDFWorker(h)}static get workerSrc(){if(_worker_options.GlobalWorkerOptions.workerSrc)return _worker_options.GlobalWorkerOptions.workerSrc;if(PDFWorkerUtil.fallbackWorkerSrc!==null)return _is_node.isNodeJS||(0,_display_utils.deprecated)('No "GlobalWorkerOptions.workerSrc" specified.'),PDFWorkerUtil.fallbackWorkerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _mainThreadWorkerMessageHandler(){var h;try{return((h=globalThis.pdfjsWorker)==null?void 0:h.WorkerMessageHandler)||null}catch{return null}}static get _setupFakeWorkerGlobal(){const loader=async()=>{const mainWorkerMessageHandler=this._mainThreadWorkerMessageHandler;if(mainWorkerMessageHandler)return mainWorkerMessageHandler;if(_is_node.isNodeJS&&typeof commonjsRequire=="function"){const worker=eval("require")(this.workerSrc);return worker.WorkerMessageHandler}return await(0,_display_utils.loadScript)(this.workerSrc),window.pdfjsWorker.WorkerMessageHandler};return(0,_util.shadow)(this,"_setupFakeWorkerGlobal",loader())}};let PDFWorker=_PDFWorker;N=new WeakMap,tt(PDFWorker,N,new WeakMap),exports.PDFWorker=PDFWorker;class WorkerTransport{constructor(o,d,F,s,B){tt(this,f);tt(this,w,new Map);tt(this,P,new Map);tt(this,p,new Map);this.messageHandler=o,this.loadingTask=d,this.commonObjs=new PDFObjects,this.fontLoader=new _font_loader.FontLoader({ownerDocument:s.ownerDocument,styleElement:s.styleElement}),this._params=s,this.canvasFactory=B.canvasFactory,this.filterFactory=B.filterFactory,this.cMapReaderFactory=B.cMapReaderFactory,this.standardFontDataFactory=B.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._passwordCapability=null,this._networkStream=F,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=new _util.PromiseCapability,this.setupMessageHandler()}get annotationStorage(){return(0,_util.shadow)(this,"annotationStorage",new _annotation_storage.AnnotationStorage)}getRenderingIntent(o,d=_util.AnnotationMode.ENABLE,F=null,s=!1){let B=_util.RenderingIntentFlag.DISPLAY,V=null;switch(o){case"any":B=_util.RenderingIntentFlag.ANY;break;case"display":break;case"print":B=_util.RenderingIntentFlag.PRINT;break;default:(0,_util.warn)(`getRenderingIntent - invalid intent: ${o}`)}switch(d){case _util.AnnotationMode.DISABLE:B+=_util.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case _util.AnnotationMode.ENABLE:break;case _util.AnnotationMode.ENABLE_FORMS:B+=_util.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case _util.AnnotationMode.ENABLE_STORAGE:B+=_util.RenderingIntentFlag.ANNOTATIONS_STORAGE,V=(B&_util.RenderingIntentFlag.PRINT&&F instanceof _annotation_storage.PrintAnnotationStorage?F:this.annotationStorage).serializable;break;default:(0,_util.warn)(`getRenderingIntent - invalid annotationMode: ${d}`)}return s&&(B+=_util.RenderingIntentFlag.OPLIST),{renderingIntent:B,cacheKey:`${B}_${_annotation_storage.AnnotationStorage.getHash(V)}`,annotationStorageMap:V}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=new _util.PromiseCapability,this._passwordCapability&&this._passwordCapability.reject(new Error("Worker was destroyed during onPassword callback"));const o=[];for(const F of y(this,P).values())o.push(F._destroy());y(this,P).clear(),y(this,p).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const d=this.messageHandler.sendWithPromise("Terminate",null);return o.push(d),Promise.all(o).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),y(this,w).clear(),this.filterFactory.destroy(),this._networkStream&&this._networkStream.cancelAllRequests(new _util.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:o,loadingTask:d}=this;o.on("GetReader",(F,s)=>{(0,_util.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=B=>{this._lastProgress={loaded:B.loaded,total:B.total}},s.onPull=()=>{this._fullReader.read().then(function({value:B,done:V}){if(V){s.close();return}(0,_util.assert)(B instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),s.enqueue(new Uint8Array(B),1,[B])}).catch(B=>{s.error(B)})},s.onCancel=B=>{this._fullReader.cancel(B),s.ready.catch(V=>{if(!this.destroyed)throw V})}}),o.on("ReaderHeadersReady",F=>{const s=new _util.PromiseCapability,B=this._fullReader;return B.headersReady.then(()=>{var V;(!B.isStreamingSupported||!B.isRangeSupported)&&(this._lastProgress&&((V=d.onProgress)==null||V.call(d,this._lastProgress)),B.onProgress=Y=>{var Q;(Q=d.onProgress)==null||Q.call(d,{loaded:Y.loaded,total:Y.total})}),s.resolve({isStreamingSupported:B.isStreamingSupported,isRangeSupported:B.isRangeSupported,contentLength:B.contentLength})},s.reject),s.promise}),o.on("GetRangeReader",(F,s)=>{(0,_util.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const B=this._networkStream.getRangeReader(F.begin,F.end);if(!B){s.close();return}s.onPull=()=>{B.read().then(function({value:V,done:Y}){if(Y){s.close();return}(0,_util.assert)(V instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),s.enqueue(new Uint8Array(V),1,[V])}).catch(V=>{s.error(V)})},s.onCancel=V=>{B.cancel(V),s.ready.catch(Y=>{if(!this.destroyed)throw Y})}}),o.on("GetDoc",({pdfInfo:F})=>{this._numPages=F.numPages,this._htmlForXfa=F.htmlForXfa,delete F.htmlForXfa,d._capability.resolve(new PDFDocumentProxy(F,this))}),o.on("DocException",function(F){let s;switch(F.name){case"PasswordException":s=new _util.PasswordException(F.message,F.code);break;case"InvalidPDFException":s=new _util.InvalidPDFException(F.message);break;case"MissingPDFException":s=new _util.MissingPDFException(F.message);break;case"UnexpectedResponseException":s=new _util.UnexpectedResponseException(F.message,F.status);break;case"UnknownErrorException":s=new _util.UnknownErrorException(F.message,F.details);break;default:(0,_util.unreachable)("DocException - expected a valid Error.")}d._capability.reject(s)}),o.on("PasswordRequest",F=>{if(this._passwordCapability=new _util.PromiseCapability,d.onPassword){const s=B=>{B instanceof Error?this._passwordCapability.reject(B):this._passwordCapability.resolve({password:B})};try{d.onPassword(s,F.code)}catch(B){this._passwordCapability.reject(B)}}else this._passwordCapability.reject(new _util.PasswordException(F.message,F.code));return this._passwordCapability.promise}),o.on("DataLoaded",F=>{var s;(s=d.onProgress)==null||s.call(d,{loaded:F.length,total:F.length}),this.downloadInfoCapability.resolve(F)}),o.on("StartRenderPage",F=>{if(this.destroyed)return;y(this,P).get(F.pageIndex)._startRenderPage(F.transparency,F.cacheKey)}),o.on("commonobj",([F,s,B])=>{var V;if(!this.destroyed&&!this.commonObjs.has(F))switch(s){case"Font":const Y=this._params;if("error"in B){const ut=B.error;(0,_util.warn)(`Error during font loading: ${ut}`),this.commonObjs.resolve(F,ut);break}const Q=Y.pdfBug&&((V=globalThis.FontInspector)!=null&&V.enabled)?(ut,lt)=>globalThis.FontInspector.fontAdded(ut,lt):null,et=new _font_loader.FontFaceObject(B,{isEvalSupported:Y.isEvalSupported,disableFontFace:Y.disableFontFace,ignoreErrors:Y.ignoreErrors,inspectFont:Q});this.fontLoader.bind(et).catch(ut=>o.sendWithPromise("FontFallback",{id:F})).finally(()=>{!Y.fontExtraProperties&&et.data&&(et.data=null),this.commonObjs.resolve(F,et)});break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(F,B);break;default:throw new Error(`Got unknown common object type ${s}`)}}),o.on("obj",([F,s,B,V])=>{var Q;if(this.destroyed)return;const Y=y(this,P).get(s);if(!Y.objs.has(F))switch(B){case"Image":if(Y.objs.resolve(F,V),V){let et;if(V.bitmap){const{width:ut,height:lt}=V;et=ut*lt*4}else et=((Q=V.data)==null?void 0:Q.length)||0;et>_util.MAX_IMAGE_SIZE_TO_CACHE&&(Y._maybeCleanupAfterRender=!0)}break;case"Pattern":Y.objs.resolve(F,V);break;default:throw new Error(`Got unknown object type ${B}`)}}),o.on("DocProgress",F=>{var s;this.destroyed||(s=d.onProgress)==null||s.call(d,{loaded:F.loaded,total:F.total})}),o.on("FetchBuiltInCMap",F=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.cMapReaderFactory?this.cMapReaderFactory.fetch(F):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),o.on("FetchStandardFontData",F=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.standardFontDataFactory?this.standardFontDataFactory.fetch(F):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var o;return this.annotationStorage.size<=0&&(0,_util.warn)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead."),this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:this.annotationStorage.serializable,filename:((o=this._fullReader)==null?void 0:o.filename)??null}).finally(()=>{this.annotationStorage.resetModified()})}getPage(o){if(!Number.isInteger(o)||o<=0||o>this._numPages)return Promise.reject(new Error("Invalid page request."));const d=o-1,F=y(this,p).get(d);if(F)return F;const s=this.messageHandler.sendWithPromise("GetPage",{pageIndex:d}).then(B=>{if(this.destroyed)throw new Error("Transport destroyed");const V=new PDFPageProxy(d,B,this,this._params.pdfBug);return y(this,P).set(d,V),V});return y(this,p).set(d,s),s}getPageIndex(o){return typeof o!="object"||o===null||!Number.isInteger(o.num)||o.num<0||!Number.isInteger(o.gen)||o.gen<0?Promise.reject(new Error("Invalid pageIndex request.")):this.messageHandler.sendWithPromise("GetPageIndex",{num:o.num,gen:o.gen})}getAnnotations(o,d){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:o,intent:d})}getFieldObjects(){return it(this,f,fe).call(this,"GetFieldObjects")}hasJSActions(){return it(this,f,fe).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(o){return typeof o!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:o})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getJavaScript(){return this.messageHandler.sendWithPromise("GetJavaScript",null)}getDocJSActions(){return this.messageHandler.sendWithPromise("GetDocJSActions",null)}getPageJSActions(o){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:o})}getStructTree(o){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:o})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(){return this.messageHandler.sendWithPromise("GetOptionalContentConfig",null).then(o=>new _optional_content_config.OptionalContentConfig(o))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const o="GetMetadata",d=y(this,w).get(o);if(d)return d;const F=this.messageHandler.sendWithPromise(o,null).then(s=>{var B,V;return{info:s[0],metadata:s[1]?new _metadata.Metadata(s[1]):null,contentDispositionFilename:((B=this._fullReader)==null?void 0:B.filename)??null,contentLength:((V=this._fullReader)==null?void 0:V.contentLength)??null}});return y(this,w).set(o,F),F}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(o=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const d of y(this,P).values())if(!d.cleanup())throw new Error(`startCleanup: Page ${d.pageNumber} is currently rendering.`);this.commonObjs.clear(),o||this.fontLoader.clear(),y(this,w).clear(),this.filterFactory.destroy(!0)}}get loadingParams(){const{disableAutoFetch:o,enableXfa:d}=this._params;return(0,_util.shadow)(this,"loadingParams",{disableAutoFetch:o,enableXfa:d})}}w=new WeakMap,P=new WeakMap,p=new WeakMap,f=new WeakSet,fe=function(o,d=null){const F=y(this,w).get(o);if(F)return F;const s=this.messageHandler.sendWithPromise(o,d);return y(this,w).set(o,s),s};class PDFObjects{constructor(){tt(this,E);tt(this,_,Object.create(null))}get(o,d=null){if(d){const s=it(this,E,pe).call(this,o);return s.capability.promise.then(()=>d(s.data)),null}const F=y(this,_)[o];if(!(F!=null&&F.capability.settled))throw new Error(`Requesting object that isn't resolved yet ${o}.`);return F.data}has(o){const d=y(this,_)[o];return(d==null?void 0:d.capability.settled)||!1}resolve(o,d=null){const F=it(this,E,pe).call(this,o);F.data=d,F.capability.resolve()}clear(){var o;for(const d in y(this,_)){const{data:F}=y(this,_)[d];(o=F==null?void 0:F.bitmap)==null||o.close()}gt(this,_,Object.create(null))}}_=new WeakMap,E=new WeakSet,pe=function(o){const d=y(this,_)[o];return d||(y(this,_)[o]={capability:new _util.PromiseCapability,data:null})};class RenderTask{constructor(o){tt(this,m,null);gt(this,m,o),this.onContinue=null}get promise(){return y(this,m).capability.promise}cancel(o=0){y(this,m).cancel(null,o)}get separateAnnots(){const{separateAnnots:o}=y(this,m).operatorList;if(!o)return!1;const{annotationCanvasMap:d}=y(this,m);return o.form||o.canvas&&(d==null?void 0:d.size)>0}}m=new WeakMap,exports.RenderTask=RenderTask;const n=class{constructor({callback:o,params:d,objs:F,commonObjs:s,annotationCanvasMap:B,operatorList:V,pageIndex:Y,canvasFactory:Q,filterFactory:et,useRequestAnimationFrame:ut=!1,pdfBug:lt=!1,pageColors:ht=null}){this.callback=o,this.params=d,this.objs=F,this.commonObjs=s,this.annotationCanvasMap=B,this.operatorListIdx=null,this.operatorList=V,this._pageIndex=Y,this.canvasFactory=Q,this.filterFactory=et,this._pdfBug=lt,this.pageColors=ht,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=ut===!0&&typeof window<"u",this.cancelled=!1,this.capability=new _util.PromiseCapability,this.task=new RenderTask(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=d.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:o=!1,optionalContentConfig:d}){var Y,Q;if(this.cancelled)return;if(this._canvas){if(y(n,e).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");y(n,e).add(this._canvas)}this._pdfBug&&((Y=globalThis.StepperManager)!=null&&Y.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:F,viewport:s,transform:B,background:V}=this.params;this.gfx=new _canvas.CanvasGraphics(F,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:d},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:B,viewport:s,transparency:o,background:V}),this.operatorListIdx=0,this.graphicsReady=!0,(Q=this.graphicsReadyCallback)==null||Q.call(this)}cancel(o=null,d=0){var F;this.running=!1,this.cancelled=!0,(F=this.gfx)==null||F.endDrawing(),this._canvas&&y(n,e).delete(this._canvas),this.callback(o||new _display_utils.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,"canvas",d))}operatorListChanged(){var o;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(o=this.stepper)==null||o.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(this.pageColors),this._canvas&&y(n,e).delete(this._canvas),this.callback())))}};let InternalRenderTask=n;e=new WeakMap,tt(InternalRenderTask,e,new WeakSet);const version="3.6.172";exports.version=version;const build="4d3dfe254";exports.build=build},(R,i,U)=>{var L,M,v,Le,w;Object.defineProperty(i,"__esModule",{value:!0}),i.PrintAnnotationStorage=i.AnnotationStorage=void 0;var l=U(1),A=U(4),G=U(8);class q{constructor(){tt(this,v);tt(this,L,!1);tt(this,M,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(p,f){const c=y(this,M).get(p);return c===void 0?f:Object.assign(f,c)}getRawValue(p){return y(this,M).get(p)}remove(p){if(y(this,M).delete(p),y(this,M).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const f of y(this,M).values())if(f instanceof A.AnnotationEditor)return;this.onAnnotationEditor(null)}}setValue(p,f){const c=y(this,M).get(p);let _=!1;if(c!==void 0)for(const[E,C]of Object.entries(f))c[E]!==C&&(_=!0,c[E]=C);else _=!0,y(this,M).set(p,f);_&&it(this,v,Le).call(this),f instanceof A.AnnotationEditor&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(f.constructor._type)}has(p){return y(this,M).has(p)}getAll(){return y(this,M).size>0?(0,l.objectFromMap)(y(this,M)):null}setAll(p){for(const[f,c]of Object.entries(p))this.setValue(f,c)}get size(){return y(this,M).size}resetModified(){y(this,L)&&(gt(this,L,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new Z(this)}get serializable(){if(y(this,M).size===0)return null;const p=new Map;for(const[f,c]of y(this,M)){const _=c instanceof A.AnnotationEditor?c.serialize():c;_&&p.set(f,_)}return p}static getHash(p){if(!p)return"";const f=new G.MurmurHash3_64;for(const[c,_]of p)f.update(`${c}:${JSON.stringify(_)}`);return f.hexdigest()}}L=new WeakMap,M=new WeakMap,v=new WeakSet,Le=function(){y(this,L)||(gt(this,L,!0),typeof this.onSetModified=="function"&&this.onSetModified())},i.AnnotationStorage=q;class Z extends q{constructor(f){super();tt(this,w,null);gt(this,w,structuredClone(f.serializable))}get print(){(0,l.unreachable)("Should not call PrintAnnotationStorage.print")}get serializable(){return y(this,w)}}w=new WeakMap,i.PrintAnnotationStorage=Z},(R,i,U)=>{var q,Z,L,M,v,N;Object.defineProperty(i,"__esModule",{value:!0}),i.AnnotationEditor=void 0;var l=U(5),A=U(1);const w=class{constructor(p){tt(this,q,this.focusin.bind(this));tt(this,Z,this.focusout.bind(this));tt(this,L,!1);tt(this,M,!1);tt(this,v,!1);Lt(this,"_uiManager",null);tt(this,N,w._zIndex++);this.constructor===w&&(0,A.unreachable)("Cannot initialize AnnotationEditor."),this.parent=p.parent,this.id=p.id,this.width=this.height=null,this.pageIndex=p.parent.pageIndex,this.name=p.name,this.div=null,this._uiManager=p.uiManager;const{rotation:f,rawDims:{pageWidth:c,pageHeight:_,pageX:E,pageY:C}}=this.parent.viewport;this.rotation=f,this.pageRotation=(360+f-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[c,_],this.pageTranslation=[E,C];const[m,e]=this.parentDimensions;this.x=p.x/m,this.y=p.y/e,this.isAttachedToDOM=!1}static get _defaultLineColor(){return(0,A.shadow)(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}addCommands(p){this._uiManager.addCommands(p)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=y(this,N)}setParent(p){p!==null&&(this.pageIndex=p.pageIndex,this.pageDimensions=p.pageDimensions),this.parent=p}focusin(p){y(this,L)?gt(this,L,!1):this.parent.setSelected(this)}focusout(p){var c;if(!this.isAttachedToDOM)return;const f=p.relatedTarget;f!=null&&f.closest(`#${this.id}`)||(p.preventDefault(),(c=this.parent)!=null&&c.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}dragstart(p){const f=this.parent.div.getBoundingClientRect();this.startX=p.clientX-f.x,this.startY=p.clientY-f.y,p.dataTransfer.setData("text/plain",this.id),p.dataTransfer.effectAllowed="move"}setAt(p,f,c,_){const[E,C]=this.parentDimensions;[c,_]=this.screenToPageTranslation(c,_),this.x=(p+c)/E,this.y=(f+_)/C,this.div.style.left=`${100*this.x}%`,this.div.style.top=`${100*this.y}%`}translate(p,f){const[c,_]=this.parentDimensions;[p,f]=this.screenToPageTranslation(p,f),this.x+=p/c,this.y+=f/_,this.div.style.left=`${100*this.x}%`,this.div.style.top=`${100*this.y}%`}screenToPageTranslation(p,f){switch(this.parentRotation){case 90:return[f,-p];case 180:return[-p,-f];case 270:return[-f,p];default:return[p,f]}}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{realScale:p}=this._uiManager.viewParameters,[f,c]=this.pageDimensions;return[f*p,c*p]}setDims(p,f){const[c,_]=this.parentDimensions;this.div.style.width=`${100*p/c}%`,this.div.style.height=`${100*f/_}%`}fixDims(){const{style:p}=this.div,{height:f,width:c}=p,_=c.endsWith("%"),E=f.endsWith("%");if(_&&E)return;const[C,m]=this.parentDimensions;_||(p.width=`${100*parseFloat(c)/C}%`),E||(p.height=`${100*parseFloat(f)/m}%`)}getInitialTranslation(){return[0,0]}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.setAttribute("tabIndex",0),this.setInForeground(),this.div.addEventListener("focusin",y(this,q)),this.div.addEventListener("focusout",y(this,Z));const[p,f]=this.getInitialTranslation();return this.translate(p,f),(0,l.bindEvents)(this,this.div,["dragstart","pointerdown"]),this.div}pointerdown(p){const{isMac:f}=A.FeatureTest.platform;if(p.button!==0||p.ctrlKey&&f){p.preventDefault();return}p.ctrlKey&&!f||p.shiftKey||p.metaKey&&f?this.parent.toggleSelected(this):this.parent.setSelected(this),gt(this,L,!0)}getRect(p,f){const c=this.parentScale,[_,E]=this.pageDimensions,[C,m]=this.pageTranslation,e=p/c,n=f/c,h=this.x*_,o=this.y*E,d=this.width*_,F=this.height*E;switch(this.rotation){case 0:return[h+e+C,E-o-n-F+m,h+e+d+C,E-o-n+m];case 90:return[h+n+C,E-o+e+m,h+n+F+C,E-o+e+d+m];case 180:return[h-e-d+C,E-o+n+m,h-e+C,E-o+n+F+m];case 270:return[h-n-F+C,E-o-e-d+m,h-n+C,E-o-e+m];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(p,f){const[c,_,E,C]=p,m=E-c,e=C-_;switch(this.rotation){case 0:return[c,f-C,m,e];case 90:return[c,f-_,e,m];case 180:return[E,f-_,m,e];case 270:return[E,f-C,e,m];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){gt(this,v,!0)}disableEditMode(){gt(this,v,!1)}isInEditMode(){return y(this,v)}shouldGetKeyboardEvents(){return!1}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){var p;(p=this.div)==null||p.addEventListener("focusin",y(this,q))}serialize(){(0,A.unreachable)("An editor must be serializable")}static deserialize(p,f,c){const _=new this.prototype.constructor({parent:f,id:f.getNextId(),uiManager:c});_.rotation=p.rotation;const[E,C]=_.pageDimensions,[m,e,n,h]=_.getRectInCurrentCoords(p.rect,C);return _.x=m/E,_.y=e/C,_.width=n/E,_.height=h/C,_}remove(){this.div.removeEventListener("focusin",y(this,q)),this.div.removeEventListener("focusout",y(this,Z)),this.isEmpty()||this.commit(),this.parent.remove(this)}select(){var p;(p=this.div)==null||p.classList.add("selectedEditor")}unselect(){var p;(p=this.div)==null||p.classList.remove("selectedEditor")}updateParams(p,f){}disableEditing(){}enableEditing(){}get propertiesToUpdate(){return{}}get contentDiv(){return this.div}get isEditing(){return y(this,M)}set isEditing(p){gt(this,M,p),p?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null)}};let G=w;q=new WeakMap,Z=new WeakMap,L=new WeakMap,M=new WeakMap,v=new WeakMap,N=new WeakMap,Lt(G,"_colorManager",new l.ColorManager),Lt(G,"_zIndex",1),i.AnnotationEditor=G},(R,i,U)=>{var w,P,p,f,c,_,Ie,m,e,n,h,o,d,F,s,B,V,Y,Q,et,ut,lt,ht,mt,At,Et,_t,z,u,g,x,Ne,D,ge,W,je,I,Ue,a,Ht,S,ee,$,Be,J,We,ot,me,at,ne,pt,be;Object.defineProperty(i,"__esModule",{value:!0}),i.KeyboardManager=i.CommandManager=i.ColorManager=i.AnnotationEditorUIManager=void 0,i.bindEvents=G,i.opacityToHex=q;var l=U(1),A=U(6);function G(Tt,K,yt){for(const St of yt)K.addEventListener(St,Tt[St].bind(Tt))}function q(Tt){return Math.round(Math.min(255,Math.max(1,255*Tt))).toString(16).padStart(2,"0")}class Z{constructor(){tt(this,w,0)}getId(){return`${l.AnnotationEditorPrefix}${re(this,w)._++}`}}w=new WeakMap;class L{constructor(K=128){tt(this,P,[]);tt(this,p,!1);tt(this,f,void 0);tt(this,c,-1);gt(this,f,K)}add({cmd:K,undo:yt,mustExec:St,type:Mt=NaN,overwriteIfSameType:dt=!1,keepUndo:k=!1}){if(St&&K(),y(this,p))return;const j={cmd:K,undo:yt,type:Mt};if(y(this,c)===-1){y(this,P).length>0&&(y(this,P).length=0),gt(this,c,0),y(this,P).push(j);return}if(dt&&y(this,P)[y(this,c)].type===Mt){k&&(j.undo=y(this,P)[y(this,c)].undo),y(this,P)[y(this,c)]=j;return}const ct=y(this,c)+1;ct===y(this,f)?y(this,P).splice(0,1):(gt(this,c,ct),ct<y(this,P).length&&y(this,P).splice(ct)),y(this,P).push(j)}undo(){y(this,c)!==-1&&(gt(this,p,!0),y(this,P)[y(this,c)].undo(),gt(this,p,!1),gt(this,c,y(this,c)-1))}redo(){y(this,c)<y(this,P).length-1&&(gt(this,c,y(this,c)+1),gt(this,p,!0),y(this,P)[y(this,c)].cmd(),gt(this,p,!1))}hasSomethingToUndo(){return y(this,c)!==-1}hasSomethingToRedo(){return y(this,c)<y(this,P).length-1}destroy(){gt(this,P,null)}}P=new WeakMap,p=new WeakMap,f=new WeakMap,c=new WeakMap,i.CommandManager=L;class M{constructor(K){tt(this,_);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:yt}=l.FeatureTest.platform;for(const[St,Mt]of K)for(const dt of St){const k=dt.startsWith("mac+");yt&&k?(this.callbacks.set(dt.slice(4),Mt),this.allKeys.add(dt.split("+").at(-1))):!yt&&!k&&(this.callbacks.set(dt,Mt),this.allKeys.add(dt.split("+").at(-1)))}}exec(K,yt){if(!this.allKeys.has(yt.key))return;const St=this.callbacks.get(it(this,_,Ie).call(this,yt));St&&(St.bind(K)(),yt.stopPropagation(),yt.preventDefault())}}_=new WeakSet,Ie=function(K){K.altKey&&this.buffer.push("alt"),K.ctrlKey&&this.buffer.push("ctrl"),K.metaKey&&this.buffer.push("meta"),K.shiftKey&&this.buffer.push("shift"),this.buffer.push(K.key);const yt=this.buffer.join("+");return this.buffer.length=0,yt},i.KeyboardManager=M;const C=class{get _colors(){const K=new Map([["CanvasText",null],["Canvas",null]]);return(0,A.getColorValues)(K),(0,l.shadow)(this,"_colors",K)}convert(K){const yt=(0,A.getRGB)(K);if(!window.matchMedia("(forced-colors: active)").matches)return yt;for(const[St,Mt]of this._colors)if(Mt.every((dt,k)=>dt===yt[k]))return C._colorsMapping.get(St);return yt}getHexCode(K){const yt=this._colors.get(K);return yt?l.Util.makeHexColor(...yt):K}};let v=C;Lt(v,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]])),i.ColorManager=v;const vt=class{constructor(K,yt,St){tt(this,x);tt(this,D);tt(this,W);tt(this,I);tt(this,a);tt(this,S);tt(this,$);tt(this,J);tt(this,ot);tt(this,at);tt(this,pt);tt(this,m,null);tt(this,e,new Map);tt(this,n,new Map);tt(this,h,null);tt(this,o,new L);tt(this,d,0);tt(this,F,null);tt(this,s,new Set);tt(this,B,null);tt(this,V,new Z);tt(this,Y,!1);tt(this,Q,l.AnnotationEditorType.NONE);tt(this,et,new Set);tt(this,ut,this.copy.bind(this));tt(this,lt,this.cut.bind(this));tt(this,ht,this.paste.bind(this));tt(this,mt,this.keydown.bind(this));tt(this,At,this.onEditingAction.bind(this));tt(this,Et,this.onPageChanging.bind(this));tt(this,_t,this.onScaleChanging.bind(this));tt(this,z,this.onRotationChanging.bind(this));tt(this,u,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1});tt(this,g,null);gt(this,g,K),gt(this,B,yt),y(this,B)._on("editingaction",y(this,At)),y(this,B)._on("pagechanging",y(this,Et)),y(this,B)._on("scalechanging",y(this,_t)),y(this,B)._on("rotationchanging",y(this,z)),gt(this,h,St),this.viewParameters={realScale:A.PixelsPerInch.PDF_TO_CSS_UNITS,rotation:0}}destroy(){it(this,D,ge).call(this),y(this,B)._off("editingaction",y(this,At)),y(this,B)._off("pagechanging",y(this,Et)),y(this,B)._off("scalechanging",y(this,_t)),y(this,B)._off("rotationchanging",y(this,z));for(const K of y(this,n).values())K.destroy();y(this,n).clear(),y(this,e).clear(),y(this,s).clear(),gt(this,m,null),y(this,et).clear(),y(this,o).destroy()}onPageChanging({pageNumber:K}){gt(this,d,K-1)}focusMainContainer(){y(this,g).focus()}addShouldRescale(K){y(this,s).add(K)}removeShouldRescale(K){y(this,s).delete(K)}onScaleChanging({scale:K}){this.commitOrRemove(),this.viewParameters.realScale=K*A.PixelsPerInch.PDF_TO_CSS_UNITS;for(const yt of y(this,s))yt.onScaleChanging()}onRotationChanging({pagesRotation:K}){this.commitOrRemove(),this.viewParameters.rotation=K}addToAnnotationStorage(K){!K.isEmpty()&&y(this,h)&&!y(this,h).has(K.id)&&y(this,h).setValue(K.id,K)}copy(K){if(K.preventDefault(),y(this,m)&&y(this,m).commitOrRemove(),!this.hasSelection)return;const yt=[];for(const St of y(this,et))St.isEmpty()||yt.push(St.serialize());yt.length!==0&&K.clipboardData.setData("application/pdfjs",JSON.stringify(yt))}cut(K){this.copy(K),this.delete()}paste(K){K.preventDefault();let yt=K.clipboardData.getData("application/pdfjs");if(!yt)return;try{yt=JSON.parse(yt)}catch(Mt){(0,l.warn)(`paste: "${Mt.message}".`);return}if(!Array.isArray(yt))return;this.unselectAll();const St=y(this,n).get(y(this,d));try{const Mt=[];for(const j of yt){const ct=St.deserialize(j);if(!ct)return;Mt.push(ct)}const dt=()=>{for(const j of Mt)it(this,ot,me).call(this,j);it(this,pt,be).call(this,Mt)},k=()=>{for(const j of Mt)j.remove()};this.addCommands({cmd:dt,undo:k,mustExec:!0})}catch(Mt){(0,l.warn)(`paste: "${Mt.message}".`)}}keydown(K){var yt;(yt=this.getActive())!=null&&yt.shouldGetKeyboardEvents()||vt._keyboardManager.exec(this,K)}onEditingAction(K){["undo","redo","delete","selectAll"].includes(K.name)&&this[K.name]()}setEditingState(K){K?(it(this,x,Ne).call(this),it(this,W,je).call(this),it(this,a,Ht).call(this,{isEditing:y(this,Q)!==l.AnnotationEditorType.NONE,isEmpty:it(this,at,ne).call(this),hasSomethingToUndo:y(this,o).hasSomethingToUndo(),hasSomethingToRedo:y(this,o).hasSomethingToRedo(),hasSelectedEditor:!1})):(it(this,D,ge).call(this),it(this,I,Ue).call(this),it(this,a,Ht).call(this,{isEditing:!1}))}registerEditorTypes(K){if(!y(this,F)){gt(this,F,K);for(const yt of y(this,F))it(this,S,ee).call(this,yt.defaultPropertiesToUpdate)}}getId(){return y(this,V).getId()}get currentLayer(){return y(this,n).get(y(this,d))}get currentPageIndex(){return y(this,d)}addLayer(K){y(this,n).set(K.pageIndex,K),y(this,Y)?K.enable():K.disable()}removeLayer(K){y(this,n).delete(K.pageIndex)}updateMode(K){if(gt(this,Q,K),K===l.AnnotationEditorType.NONE)this.setEditingState(!1),it(this,J,We).call(this);else{this.setEditingState(!0),it(this,$,Be).call(this);for(const yt of y(this,n).values())yt.updateMode(K)}}updateToolbar(K){K!==y(this,Q)&&y(this,B).dispatch("switchannotationeditormode",{source:this,mode:K})}updateParams(K,yt){if(y(this,F)){for(const St of y(this,et))St.updateParams(K,yt);for(const St of y(this,F))St.updateDefaultParams(K,yt)}}getEditors(K){const yt=[];for(const St of y(this,e).values())St.pageIndex===K&&yt.push(St);return yt}getEditor(K){return y(this,e).get(K)}addEditor(K){y(this,e).set(K.id,K)}removeEditor(K){var yt;y(this,e).delete(K.id),this.unselect(K),(yt=y(this,h))==null||yt.remove(K.id)}setActiveEditor(K){y(this,m)!==K&&(gt(this,m,K),K&&it(this,S,ee).call(this,K.propertiesToUpdate))}toggleSelected(K){if(y(this,et).has(K)){y(this,et).delete(K),K.unselect(),it(this,a,Ht).call(this,{hasSelectedEditor:this.hasSelection});return}y(this,et).add(K),K.select(),it(this,S,ee).call(this,K.propertiesToUpdate),it(this,a,Ht).call(this,{hasSelectedEditor:!0})}setSelected(K){for(const yt of y(this,et))yt!==K&&yt.unselect();y(this,et).clear(),y(this,et).add(K),K.select(),it(this,S,ee).call(this,K.propertiesToUpdate),it(this,a,Ht).call(this,{hasSelectedEditor:!0})}isSelected(K){return y(this,et).has(K)}unselect(K){K.unselect(),y(this,et).delete(K),it(this,a,Ht).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return y(this,et).size!==0}undo(){y(this,o).undo(),it(this,a,Ht).call(this,{hasSomethingToUndo:y(this,o).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:it(this,at,ne).call(this)})}redo(){y(this,o).redo(),it(this,a,Ht).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:y(this,o).hasSomethingToRedo(),isEmpty:it(this,at,ne).call(this)})}addCommands(K){y(this,o).add(K),it(this,a,Ht).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:it(this,at,ne).call(this)})}delete(){if(this.commitOrRemove(),!this.hasSelection)return;const K=[...y(this,et)],yt=()=>{for(const Mt of K)Mt.remove()},St=()=>{for(const Mt of K)it(this,ot,me).call(this,Mt)};this.addCommands({cmd:yt,undo:St,mustExec:!0})}commitOrRemove(){var K;(K=y(this,m))==null||K.commitOrRemove()}selectAll(){for(const K of y(this,et))K.commit();it(this,pt,be).call(this,y(this,e).values())}unselectAll(){if(y(this,m)){y(this,m).commitOrRemove();return}if(y(this,et).size!==0){for(const K of y(this,et))K.unselect();y(this,et).clear(),it(this,a,Ht).call(this,{hasSelectedEditor:!1})}}isActive(K){return y(this,m)===K}getActive(){return y(this,m)}getMode(){return y(this,Q)}};let N=vt;m=new WeakMap,e=new WeakMap,n=new WeakMap,h=new WeakMap,o=new WeakMap,d=new WeakMap,F=new WeakMap,s=new WeakMap,B=new WeakMap,V=new WeakMap,Y=new WeakMap,Q=new WeakMap,et=new WeakMap,ut=new WeakMap,lt=new WeakMap,ht=new WeakMap,mt=new WeakMap,At=new WeakMap,Et=new WeakMap,_t=new WeakMap,z=new WeakMap,u=new WeakMap,g=new WeakMap,x=new WeakSet,Ne=function(){y(this,g).addEventListener("keydown",y(this,mt))},D=new WeakSet,ge=function(){y(this,g).removeEventListener("keydown",y(this,mt))},W=new WeakSet,je=function(){document.addEventListener("copy",y(this,ut)),document.addEventListener("cut",y(this,lt)),document.addEventListener("paste",y(this,ht))},I=new WeakSet,Ue=function(){document.removeEventListener("copy",y(this,ut)),document.removeEventListener("cut",y(this,lt)),document.removeEventListener("paste",y(this,ht))},a=new WeakSet,Ht=function(K){Object.entries(K).some(([St,Mt])=>y(this,u)[St]!==Mt)&&y(this,B).dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(y(this,u),K)})},S=new WeakSet,ee=function(K){y(this,B).dispatch("annotationeditorparamschanged",{source:this,details:K})},$=new WeakSet,Be=function(){if(!y(this,Y)){gt(this,Y,!0);for(const K of y(this,n).values())K.enable()}},J=new WeakSet,We=function(){if(this.unselectAll(),y(this,Y)){gt(this,Y,!1);for(const K of y(this,n).values())K.disable()}},ot=new WeakSet,me=function(K){const yt=y(this,n).get(K.pageIndex);yt?yt.addOrRebuild(K):this.addEditor(K)},at=new WeakSet,ne=function(){if(y(this,e).size===0)return!0;if(y(this,e).size===1)for(const K of y(this,e).values())return K.isEmpty();return!1},pt=new WeakSet,be=function(K){y(this,et).clear();for(const yt of K)yt.isEmpty()||(y(this,et).add(yt),yt.select());it(this,a,Ht).call(this,{hasSelectedEditor:!0})},Lt(N,"_keyboardManager",new M([[["ctrl+a","mac+meta+a"],vt.prototype.selectAll],[["ctrl+z","mac+meta+z"],vt.prototype.undo],[["ctrl+y","ctrl+shift+Z","mac+meta+shift+Z"],vt.prototype.redo],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete"],vt.prototype.delete],[["Escape","mac+Escape"],vt.prototype.unselectAll]])),i.AnnotationEditorUIManager=N},(R,i,U)=>{var ut,lt,ht,mt,At,Et,_t,z,u,Qt,x,Yt,D,Vt;Object.defineProperty(i,"__esModule",{value:!0}),i.StatTimer=i.RenderingCancelledException=i.PixelsPerInch=i.PageViewport=i.PDFDateString=i.DOMStandardFontDataFactory=i.DOMSVGFactory=i.DOMFilterFactory=i.DOMCanvasFactory=i.DOMCMapReaderFactory=i.AnnotationPrefix=void 0,i.deprecated=h,i.getColorValues=B,i.getCurrentTransform=V,i.getCurrentTransformInverse=Y,i.getFilenameFromUrl=E,i.getPdfFilenameFromUrl=C,i.getRGB=s,i.getXfaPageViewport=F,i.isDataScheme=c,i.isPdfFile=_,i.isValidFetchUrl=e,i.loadScript=n,i.setLayerDimensions=Q;var l=U(7),A=U(1);const G="http://www.w3.org/2000/svg",q="pdfjs_internal_id_";i.AnnotationPrefix=q;const et=class{};let Z=et;Lt(Z,"CSS",96),Lt(Z,"PDF",72),Lt(Z,"PDF_TO_CSS_UNITS",et.CSS/et.PDF),i.PixelsPerInch=Z;class L extends l.BaseFilterFactory{constructor({docId:I,ownerDocument:t=globalThis.document}={}){super();tt(this,u);tt(this,x);tt(this,D);tt(this,ut,void 0);tt(this,lt,void 0);tt(this,ht,void 0);tt(this,mt,void 0);tt(this,At,void 0);tt(this,Et,void 0);tt(this,_t,void 0);tt(this,z,0);gt(this,ht,I),gt(this,mt,t)}addFilter(I){if(!I)return"none";let t=y(this,u,Qt).get(I);if(t)return t;let a,b,S,T;if(I.length===1){const ot=I[0],nt=new Array(256);for(let at=0;at<256;at++)nt[at]=ot[at]/255;T=a=b=S=nt.join(",")}else{const[ot,nt,at]=I,ft=new Array(256),pt=new Array(256),xt=new Array(256);for(let vt=0;vt<256;vt++)ft[vt]=ot[vt]/255,pt[vt]=nt[vt]/255,xt[vt]=at[vt]/255;a=ft.join(","),b=pt.join(","),S=xt.join(","),T=`${a}${b}${S}`}if(t=y(this,u,Qt).get(T),t)return y(this,u,Qt).set(I,t),t;const $=`g_${y(this,ht)}_transfer_map_${re(this,z)._++}`,st=`url(#${$})`;y(this,u,Qt).set(I,st),y(this,u,Qt).set(T,st);const J=y(this,mt).createElementNS(G,"filter",G);J.setAttribute("id",$),J.setAttribute("color-interpolation-filters","sRGB");const rt=y(this,mt).createElementNS(G,"feComponentTransfer");return J.append(rt),it(this,D,Vt).call(this,rt,"feFuncR",a),it(this,D,Vt).call(this,rt,"feFuncG",b),it(this,D,Vt).call(this,rt,"feFuncB",S),y(this,x,Yt).append(J),st}addHCMFilter(I,t){var at;const a=`${I}-${t}`;if(y(this,Et)===a)return y(this,_t);if(gt(this,Et,a),gt(this,_t,"none"),(at=y(this,At))==null||at.remove(),!I||!t)return y(this,_t);y(this,x,Yt).style.color=I,I=getComputedStyle(y(this,x,Yt)).getPropertyValue("color");const b=s(I);I=A.Util.makeHexColor(...b),y(this,x,Yt).style.color=t,t=getComputedStyle(y(this,x,Yt)).getPropertyValue("color");const S=s(t);if(t=A.Util.makeHexColor(...S),y(this,x,Yt).style.color="",I==="#000000"&&t==="#ffffff"||I===t)return y(this,_t);const T=new Array(256);for(let ft=0;ft<=255;ft++){const pt=ft/255;T[ft]=pt<=.03928?pt/12.92:((pt+.055)/1.055)**2.4}const $=T.join(","),st=`g_${y(this,ht)}_hcm_filter`,J=gt(this,At,y(this,mt).createElementNS(G,"filter",G));J.setAttribute("id",st),J.setAttribute("color-interpolation-filters","sRGB");let rt=y(this,mt).createElementNS(G,"feComponentTransfer");J.append(rt),it(this,D,Vt).call(this,rt,"feFuncR",$),it(this,D,Vt).call(this,rt,"feFuncG",$),it(this,D,Vt).call(this,rt,"feFuncB",$);const ot=y(this,mt).createElementNS(G,"feColorMatrix");ot.setAttribute("type","matrix"),ot.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),J.append(ot),rt=y(this,mt).createElementNS(G,"feComponentTransfer"),J.append(rt);const nt=(ft,pt)=>{const xt=b[ft]/255,vt=S[ft]/255,Tt=new Array(pt+1);for(let K=0;K<=pt;K++)Tt[K]=xt+K/pt*(vt-xt);return Tt.join(",")};return it(this,D,Vt).call(this,rt,"feFuncR",nt(0,5)),it(this,D,Vt).call(this,rt,"feFuncG",nt(1,5)),it(this,D,Vt).call(this,rt,"feFuncB",nt(2,5)),y(this,x,Yt).append(J),gt(this,_t,`url(#${st})`),y(this,_t)}destroy(I=!1){I&&y(this,_t)||(y(this,lt)&&(y(this,lt).parentNode.parentNode.remove(),gt(this,lt,null)),y(this,ut)&&(y(this,ut).clear(),gt(this,ut,null)),gt(this,z,0))}}ut=new WeakMap,lt=new WeakMap,ht=new WeakMap,mt=new WeakMap,At=new WeakMap,Et=new WeakMap,_t=new WeakMap,z=new WeakMap,u=new WeakSet,Qt=function(){return y(this,ut)||gt(this,ut,new Map)},x=new WeakSet,Yt=function(){if(!y(this,lt)){const I=y(this,mt).createElement("div"),{style:t}=I;t.visibility="hidden",t.contain="strict",t.width=t.height=0,t.position="absolute",t.top=t.left=0,t.zIndex=-1;const a=y(this,mt).createElementNS(G,"svg");a.setAttribute("width",0),a.setAttribute("height",0),gt(this,lt,y(this,mt).createElementNS(G,"defs")),I.append(a),a.append(y(this,lt)),y(this,mt).body.append(I)}return y(this,lt)},D=new WeakSet,Vt=function(I,t,a){const b=y(this,mt).createElementNS(G,t);b.setAttribute("type","discrete"),b.setAttribute("tableValues",a),I.append(b)},i.DOMFilterFactory=L;class M extends l.BaseCanvasFactory{constructor({ownerDocument:O=globalThis.document}={}){super(),this._document=O}_createCanvas(O,I){const t=this._document.createElement("canvas");return t.width=O,t.height=I,t}}i.DOMCanvasFactory=M;async function v(W,O=!1){if(e(W,document.baseURI)){const I=await fetch(W);if(!I.ok)throw new Error(I.statusText);return O?new Uint8Array(await I.arrayBuffer()):(0,A.stringToBytes)(await I.text())}return new Promise((I,t)=>{const a=new XMLHttpRequest;a.open("GET",W,!0),O&&(a.responseType="arraybuffer"),a.onreadystatechange=()=>{if(a.readyState===XMLHttpRequest.DONE){if(a.status===200||a.status===0){let b;if(O&&a.response?b=new Uint8Array(a.response):!O&&a.responseText&&(b=(0,A.stringToBytes)(a.responseText)),b){I(b);return}}t(new Error(a.statusText))}},a.send(null)})}class N extends l.BaseCMapReaderFactory{_fetchData(O,I){return v(O,this.isCompressed).then(t=>({cMapData:t,compressionType:I}))}}i.DOMCMapReaderFactory=N;class w extends l.BaseStandardFontDataFactory{_fetchData(O){return v(O,!0)}}i.DOMStandardFontDataFactory=w;class P extends l.BaseSVGFactory{_createSVG(O){return document.createElementNS(G,O)}}i.DOMSVGFactory=P;class p{constructor({viewBox:O,scale:I,rotation:t,offsetX:a=0,offsetY:b=0,dontFlip:S=!1}){this.viewBox=O,this.scale=I,this.rotation=t,this.offsetX=a,this.offsetY=b;const T=(O[2]+O[0])/2,$=(O[3]+O[1])/2;let st,J,rt,ot;switch(t%=360,t<0&&(t+=360),t){case 180:st=-1,J=0,rt=0,ot=1;break;case 90:st=0,J=1,rt=1,ot=0;break;case 270:st=0,J=-1,rt=-1,ot=0;break;case 0:st=1,J=0,rt=0,ot=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}S&&(rt=-rt,ot=-ot);let nt,at,ft,pt;st===0?(nt=Math.abs($-O[1])*I+a,at=Math.abs(T-O[0])*I+b,ft=(O[3]-O[1])*I,pt=(O[2]-O[0])*I):(nt=Math.abs(T-O[0])*I+a,at=Math.abs($-O[1])*I+b,ft=(O[2]-O[0])*I,pt=(O[3]-O[1])*I),this.transform=[st*I,J*I,rt*I,ot*I,nt-st*I*T-rt*I*$,at-J*I*T-ot*I*$],this.width=ft,this.height=pt}get rawDims(){const{viewBox:O}=this;return(0,A.shadow)(this,"rawDims",{pageWidth:O[2]-O[0],pageHeight:O[3]-O[1],pageX:O[0],pageY:O[1]})}clone({scale:O=this.scale,rotation:I=this.rotation,offsetX:t=this.offsetX,offsetY:a=this.offsetY,dontFlip:b=!1}={}){return new p({viewBox:this.viewBox.slice(),scale:O,rotation:I,offsetX:t,offsetY:a,dontFlip:b})}convertToViewportPoint(O,I){return A.Util.applyTransform([O,I],this.transform)}convertToViewportRectangle(O){const I=A.Util.applyTransform([O[0],O[1]],this.transform),t=A.Util.applyTransform([O[2],O[3]],this.transform);return[I[0],I[1],t[0],t[1]]}convertToPdfPoint(O,I){return A.Util.applyInverseTransform([O,I],this.transform)}}i.PageViewport=p;class f extends A.BaseException{constructor(O,I,t=0){super(O,"RenderingCancelledException"),this.type=I,this.extraDelay=t}}i.RenderingCancelledException=f;function c(W){const O=W.length;let I=0;for(;I<O&&W[I].trim()==="";)I++;return W.substring(I,I+5).toLowerCase()==="data:"}function _(W){return typeof W=="string"&&/\.pdf$/i.test(W)}function E(W,O=!1){return O||([W]=W.split(/[#?]/,1)),W.substring(W.lastIndexOf("/")+1)}function C(W,O="document.pdf"){if(typeof W!="string")return O;if(c(W))return(0,A.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),O;const I=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,t=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,a=I.exec(W);let b=t.exec(a[1])||t.exec(a[2])||t.exec(a[3]);if(b&&(b=b[0],b.includes("%")))try{b=t.exec(decodeURIComponent(b))[0]}catch{}return b||O}class m{constructor(){Lt(this,"started",Object.create(null));Lt(this,"times",[])}time(O){O in this.started&&(0,A.warn)(`Timer is already running for ${O}`),this.started[O]=Date.now()}timeEnd(O){O in this.started||(0,A.warn)(`Timer has not been started for ${O}`),this.times.push({name:O,start:this.started[O],end:Date.now()}),delete this.started[O]}toString(){const O=[];let I=0;for(const{name:t}of this.times)I=Math.max(t.length,I);for(const{name:t,start:a,end:b}of this.times)O.push(`${t.padEnd(I)} ${b-a}ms
`);return O.join("")}}i.StatTimer=m;function e(W,O){try{const{protocol:I}=O?new URL(W,O):new URL(W);return I==="http:"||I==="https:"}catch{return!1}}function n(W,O=!1){return new Promise((I,t)=>{const a=document.createElement("script");a.src=W,a.onload=function(b){O&&a.remove(),I(b)},a.onerror=function(){t(new Error(`Cannot load script at: ${a.src}`))},(document.head||document.documentElement).append(a)})}function h(W){console.log("Deprecated API usage: "+W)}let o;class d{static toDateObject(O){if(!O||typeof O!="string")return null;o||(o=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const I=o.exec(O);if(!I)return null;const t=parseInt(I[1],10);let a=parseInt(I[2],10);a=a>=1&&a<=12?a-1:0;let b=parseInt(I[3],10);b=b>=1&&b<=31?b:1;let S=parseInt(I[4],10);S=S>=0&&S<=23?S:0;let T=parseInt(I[5],10);T=T>=0&&T<=59?T:0;let $=parseInt(I[6],10);$=$>=0&&$<=59?$:0;const st=I[7]||"Z";let J=parseInt(I[8],10);J=J>=0&&J<=23?J:0;let rt=parseInt(I[9],10)||0;return rt=rt>=0&&rt<=59?rt:0,st==="-"?(S+=J,T+=rt):st==="+"&&(S-=J,T-=rt),new Date(Date.UTC(t,a,b,S,T,$))}}i.PDFDateString=d;function F(W,{scale:O=1,rotation:I=0}){const{width:t,height:a}=W.attributes.style,b=[0,0,parseInt(t),parseInt(a)];return new p({viewBox:b,scale:O,rotation:I})}function s(W){if(W.startsWith("#")){const O=parseInt(W.slice(1),16);return[(O&16711680)>>16,(O&65280)>>8,O&255]}return W.startsWith("rgb(")?W.slice(4,-1).split(",").map(O=>parseInt(O)):W.startsWith("rgba(")?W.slice(5,-1).split(",").map(O=>parseInt(O)).slice(0,3):((0,A.warn)(`Not a valid color format: "${W}"`),[0,0,0])}function B(W){const O=document.createElement("span");O.style.visibility="hidden",document.body.append(O);for(const I of W.keys()){O.style.color=I;const t=window.getComputedStyle(O).color;W.set(I,s(t))}O.remove()}function V(W){const{a:O,b:I,c:t,d:a,e:b,f:S}=W.getTransform();return[O,I,t,a,b,S]}function Y(W){const{a:O,b:I,c:t,d:a,e:b,f:S}=W.getTransform().invertSelf();return[O,I,t,a,b,S]}function Q(W,O,I=!1,t=!0){if(O instanceof p){const{pageWidth:a,pageHeight:b}=O.rawDims,{style:S}=W,T=`calc(var(--scale-factor) * ${a}px)`,$=`calc(var(--scale-factor) * ${b}px)`;!I||O.rotation%180===0?(S.width=T,S.height=$):(S.width=$,S.height=T)}t&&W.setAttribute("data-main-rotation",O.rotation)}},(R,i,U)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.BaseStandardFontDataFactory=i.BaseSVGFactory=i.BaseFilterFactory=i.BaseCanvasFactory=i.BaseCMapReaderFactory=void 0;var l=U(1);class A{constructor(){this.constructor===A&&(0,l.unreachable)("Cannot initialize BaseFilterFactory.")}addFilter(v){return"none"}addHCMFilter(v,N){return"none"}destroy(v=!1){}}i.BaseFilterFactory=A;class G{constructor(){this.constructor===G&&(0,l.unreachable)("Cannot initialize BaseCanvasFactory.")}create(v,N){if(v<=0||N<=0)throw new Error("Invalid canvas size");const w=this._createCanvas(v,N);return{canvas:w,context:w.getContext("2d")}}reset(v,N,w){if(!v.canvas)throw new Error("Canvas is not specified");if(N<=0||w<=0)throw new Error("Invalid canvas size");v.canvas.width=N,v.canvas.height=w}destroy(v){if(!v.canvas)throw new Error("Canvas is not specified");v.canvas.width=0,v.canvas.height=0,v.canvas=null,v.context=null}_createCanvas(v,N){(0,l.unreachable)("Abstract method `_createCanvas` called.")}}i.BaseCanvasFactory=G;class q{constructor({baseUrl:v=null,isCompressed:N=!0}){this.constructor===q&&(0,l.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=v,this.isCompressed=N}async fetch({name:v}){if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!v)throw new Error("CMap name must be specified.");const N=this.baseUrl+v+(this.isCompressed?".bcmap":""),w=this.isCompressed?l.CMapCompressionType.BINARY:l.CMapCompressionType.NONE;return this._fetchData(N,w).catch(P=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${N}`)})}_fetchData(v,N){(0,l.unreachable)("Abstract method `_fetchData` called.")}}i.BaseCMapReaderFactory=q;class Z{constructor({baseUrl:v=null}){this.constructor===Z&&(0,l.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=v}async fetch({filename:v}){if(!this.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!v)throw new Error("Font filename must be specified.");const N=`${this.baseUrl}${v}`;return this._fetchData(N).catch(w=>{throw new Error(`Unable to load font data at: ${N}`)})}_fetchData(v){(0,l.unreachable)("Abstract method `_fetchData` called.")}}i.BaseStandardFontDataFactory=Z;class L{constructor(){this.constructor===L&&(0,l.unreachable)("Cannot initialize BaseSVGFactory.")}create(v,N,w=!1){if(v<=0||N<=0)throw new Error("Invalid SVG dimensions");const P=this._createSVG("svg:svg");return P.setAttribute("version","1.1"),w||(P.setAttribute("width",`${v}px`),P.setAttribute("height",`${N}px`)),P.setAttribute("preserveAspectRatio","none"),P.setAttribute("viewBox",`0 0 ${v} ${N}`),P}createElement(v){if(typeof v!="string")throw new Error("Invalid SVG element type");return this._createSVG(v)}_createSVG(v){(0,l.unreachable)("Abstract method `_createSVG` called.")}}i.BaseSVGFactory=L},(R,i,U)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.MurmurHash3_64=void 0;var l=U(1);const A=3285377520,G=4294901760,q=65535;class Z{constructor(M){this.h1=M?M&4294967295:A,this.h2=M?M&4294967295:A}update(M){let v,N;if(typeof M=="string"){v=new Uint8Array(M.length*2),N=0;for(let h=0,o=M.length;h<o;h++){const d=M.charCodeAt(h);d<=255?v[N++]=d:(v[N++]=d>>>8,v[N++]=d&255)}}else if((0,l.isArrayBuffer)(M))v=M.slice(),N=v.byteLength;else throw new Error("Wrong data format in MurmurHash3_64_update. Input must be a string or array.");const w=N>>2,P=N-w*4,p=new Uint32Array(v.buffer,0,w);let f=0,c=0,_=this.h1,E=this.h2;const C=3432918353,m=461845907,e=C&q,n=m&q;for(let h=0;h<w;h++)h&1?(f=p[h],f=f*C&G|f*e&q,f=f<<15|f>>>17,f=f*m&G|f*n&q,_^=f,_=_<<13|_>>>19,_=_*5+3864292196):(c=p[h],c=c*C&G|c*e&q,c=c<<15|c>>>17,c=c*m&G|c*n&q,E^=c,E=E<<13|E>>>19,E=E*5+3864292196);switch(f=0,P){case 3:f^=v[w*4+2]<<16;case 2:f^=v[w*4+1]<<8;case 1:f^=v[w*4],f=f*C&G|f*e&q,f=f<<15|f>>>17,f=f*m&G|f*n&q,w&1?_^=f:E^=f}this.h1=_,this.h2=E}hexdigest(){let M=this.h1,v=this.h2;return M^=v>>>1,M=M*3981806797&G|M*36045&q,v=v*4283543511&G|((v<<16|M>>>16)*2950163797&G)>>>16,M^=v>>>1,M=M*444984403&G|M*60499&q,v=v*3301882366&G|((v<<16|M>>>16)*3120437893&G)>>>16,M^=v>>>1,(M>>>0).toString(16).padStart(8,"0")+(v>>>0).toString(16).padStart(8,"0")}}i.MurmurHash3_64=Z},(R,i,U)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.FontLoader=i.FontFaceObject=void 0;var l=U(1),A=U(10);class G{constructor({ownerDocument:L=globalThis.document,styleElement:M=null}){this._document=L,this.nativeFontFaces=[],this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(L){this.nativeFontFaces.push(L),this._document.fonts.add(L)}insertRule(L){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const M=this.styleElement.sheet;M.insertRule(L,M.cssRules.length)}clear(){for(const L of this.nativeFontFaces)this._document.fonts.delete(L);this.nativeFontFaces.length=0,this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async bind(L){if(L.attached||L.missingFile)return;if(L.attached=!0,this.isFontLoadingAPISupported){const v=L.createNativeFontFace();if(v){this.addNativeFontFace(v);try{await v.loaded}catch(N){throw(0,l.warn)(`Failed to load font '${v.family}': '${N}'.`),L.disableFontFace=!0,N}}return}const M=L.createFontFaceRule();if(M){if(this.insertRule(M),this.isSyncFontLoadingSupported)return;await new Promise(v=>{const N=this._queueLoadingCallback(v);this._prepareFontLoadEvent(L,N)})}}get isFontLoadingAPISupported(){var M;const L=!!((M=this._document)!=null&&M.fonts);return(0,l.shadow)(this,"isFontLoadingAPISupported",L)}get isSyncFontLoadingSupported(){let L=!1;return(A.isNodeJS||typeof navigator<"u"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(L=!0),(0,l.shadow)(this,"isSyncFontLoadingSupported",L)}_queueLoadingCallback(L){function M(){for((0,l.assert)(!N.done,"completeRequest() cannot be called twice."),N.done=!0;v.length>0&&v[0].done;){const w=v.shift();setTimeout(w.callback,0)}}const{loadingRequests:v}=this,N={done:!1,complete:M,callback:L};return v.push(N),N}get _loadTestFont(){const L=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return(0,l.shadow)(this,"_loadTestFont",L)}_prepareFontLoadEvent(L,M){function v(s,B){return s.charCodeAt(B)<<24|s.charCodeAt(B+1)<<16|s.charCodeAt(B+2)<<8|s.charCodeAt(B+3)&255}function N(s,B,V,Y){const Q=s.substring(0,B),et=s.substring(B+V);return Q+Y+et}let w,P;const p=this._document.createElement("canvas");p.width=1,p.height=1;const f=p.getContext("2d");let c=0;function _(s,B){if(++c>30){(0,l.warn)("Load test font never loaded."),B();return}if(f.font="30px "+s,f.fillText(".",0,20),f.getImageData(0,0,1,1).data[3]>0){B();return}setTimeout(_.bind(null,s,B))}const E=`lt${Date.now()}${this.loadTestFontId++}`;let C=this._loadTestFont;C=N(C,976,E.length,E);const e=16,n=1482184792;let h=v(C,e);for(w=0,P=E.length-3;w<P;w+=4)h=h-n+v(E,w)|0;w<E.length&&(h=h-n+v(E+"XXX",w)|0),C=N(C,e,4,(0,l.string32)(h));const o=`url(data:font/opentype;base64,${btoa(C)});`,d=`@font-face {font-family:"${E}";src:${o}}`;this.insertRule(d);const F=this._document.createElement("div");F.style.visibility="hidden",F.style.width=F.style.height="10px",F.style.position="absolute",F.style.top=F.style.left="0px";for(const s of[L.loadedName,E]){const B=this._document.createElement("span");B.textContent="Hi",B.style.fontFamily=s,F.append(B)}this._document.body.append(F),_(E,()=>{F.remove(),M.complete()})}}i.FontLoader=G;class q{constructor(L,{isEvalSupported:M=!0,disableFontFace:v=!1,ignoreErrors:N=!1,inspectFont:w=null}){this.compiledGlyphs=Object.create(null);for(const P in L)this[P]=L[P];this.isEvalSupported=M!==!1,this.disableFontFace=v===!0,this.ignoreErrors=N===!0,this._inspectFont=w}createNativeFontFace(){var M;if(!this.data||this.disableFontFace)return null;let L;if(!this.cssFontInfo)L=new FontFace(this.loadedName,this.data,{});else{const v={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(v.style=`oblique ${this.cssFontInfo.italicAngle}deg`),L=new FontFace(this.cssFontInfo.fontFamily,this.data,v)}return(M=this._inspectFont)==null||M.call(this,this),L}createFontFaceRule(){var N;if(!this.data||this.disableFontFace)return null;const L=(0,l.bytesToString)(this.data),M=`url(data:${this.mimetype};base64,${btoa(L)});`;let v;if(!this.cssFontInfo)v=`@font-face {font-family:"${this.loadedName}";src:${M}}`;else{let w=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(w+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),v=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${w}src:${M}}`}return(N=this._inspectFont)==null||N.call(this,this,M),v}getPathGenerator(L,M){if(this.compiledGlyphs[M]!==void 0)return this.compiledGlyphs[M];let v;try{v=L.get(this.loadedName+"_path_"+M)}catch(N){if(!this.ignoreErrors)throw N;return(0,l.warn)(`getPathGenerator - ignoring character: "${N}".`),this.compiledGlyphs[M]=function(w,P){}}if(this.isEvalSupported&&l.FeatureTest.isEvalSupported){const N=[];for(const w of v){const P=w.args!==void 0?w.args.join(","):"";N.push("c.",w.cmd,"(",P,`);
`)}return this.compiledGlyphs[M]=new Function("c","size",N.join(""))}return this.compiledGlyphs[M]=function(N,w){for(const P of v)P.cmd==="scale"&&(P.args=[w,-w]),N[P.cmd].apply(N,P.args)}}}i.FontFaceObject=q},(R,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.isNodeJS=void 0;const U=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser");i.isNodeJS=U},(R,i,U)=>{var ht,ye,At,_e;Object.defineProperty(i,"__esModule",{value:!0}),i.CanvasGraphics=void 0;var l=U(1),A=U(6),G=U(12),q=U(13),Z=U(10);const L=16,M=100,v=4096,N=15,w=10,P=1e3,p=16;function f(z,u){if(z._removeMirroring)throw new Error("Context is already forwarding operations.");z.__originalSave=z.save,z.__originalRestore=z.restore,z.__originalRotate=z.rotate,z.__originalScale=z.scale,z.__originalTranslate=z.translate,z.__originalTransform=z.transform,z.__originalSetTransform=z.setTransform,z.__originalResetTransform=z.resetTransform,z.__originalClip=z.clip,z.__originalMoveTo=z.moveTo,z.__originalLineTo=z.lineTo,z.__originalBezierCurveTo=z.bezierCurveTo,z.__originalRect=z.rect,z.__originalClosePath=z.closePath,z.__originalBeginPath=z.beginPath,z._removeMirroring=()=>{z.save=z.__originalSave,z.restore=z.__originalRestore,z.rotate=z.__originalRotate,z.scale=z.__originalScale,z.translate=z.__originalTranslate,z.transform=z.__originalTransform,z.setTransform=z.__originalSetTransform,z.resetTransform=z.__originalResetTransform,z.clip=z.__originalClip,z.moveTo=z.__originalMoveTo,z.lineTo=z.__originalLineTo,z.bezierCurveTo=z.__originalBezierCurveTo,z.rect=z.__originalRect,z.closePath=z.__originalClosePath,z.beginPath=z.__originalBeginPath,delete z._removeMirroring},z.save=function(){u.save(),this.__originalSave()},z.restore=function(){u.restore(),this.__originalRestore()},z.translate=function(x,H){u.translate(x,H),this.__originalTranslate(x,H)},z.scale=function(x,H){u.scale(x,H),this.__originalScale(x,H)},z.transform=function(x,H,D,X,W,O){u.transform(x,H,D,X,W,O),this.__originalTransform(x,H,D,X,W,O)},z.setTransform=function(x,H,D,X,W,O){u.setTransform(x,H,D,X,W,O),this.__originalSetTransform(x,H,D,X,W,O)},z.resetTransform=function(){u.resetTransform(),this.__originalResetTransform()},z.rotate=function(x){u.rotate(x),this.__originalRotate(x)},z.clip=function(x){u.clip(x),this.__originalClip(x)},z.moveTo=function(g,x){u.moveTo(g,x),this.__originalMoveTo(g,x)},z.lineTo=function(g,x){u.lineTo(g,x),this.__originalLineTo(g,x)},z.bezierCurveTo=function(g,x,H,D,X,W){u.bezierCurveTo(g,x,H,D,X,W),this.__originalBezierCurveTo(g,x,H,D,X,W)},z.rect=function(g,x,H,D){u.rect(g,x,H,D),this.__originalRect(g,x,H,D)},z.closePath=function(){u.closePath(),this.__originalClosePath()},z.beginPath=function(){u.beginPath(),this.__originalBeginPath()}}class c{constructor(u){this.canvasFactory=u,this.cache=Object.create(null)}getCanvas(u,g,x){let H;return this.cache[u]!==void 0?(H=this.cache[u],this.canvasFactory.reset(H,g,x)):(H=this.canvasFactory.create(g,x),this.cache[u]=H),H}delete(u){delete this.cache[u]}clear(){for(const u in this.cache){const g=this.cache[u];this.canvasFactory.destroy(g),delete this.cache[u]}}}function _(z,u,g,x,H,D,X,W,O,I){const[t,a,b,S,T,$]=(0,A.getCurrentTransform)(z);if(a===0&&b===0){const rt=X*t+T,ot=Math.round(rt),nt=W*S+$,at=Math.round(nt),ft=(X+O)*t+T,pt=Math.abs(Math.round(ft)-ot)||1,xt=(W+I)*S+$,vt=Math.abs(Math.round(xt)-at)||1;return z.setTransform(Math.sign(t),0,0,Math.sign(S),ot,at),z.drawImage(u,g,x,H,D,0,0,pt,vt),z.setTransform(t,a,b,S,T,$),[pt,vt]}if(t===0&&S===0){const rt=W*b+T,ot=Math.round(rt),nt=X*a+$,at=Math.round(nt),ft=(W+I)*b+T,pt=Math.abs(Math.round(ft)-ot)||1,xt=(X+O)*a+$,vt=Math.abs(Math.round(xt)-at)||1;return z.setTransform(0,Math.sign(a),Math.sign(b),0,ot,at),z.drawImage(u,g,x,H,D,0,0,vt,pt),z.setTransform(t,a,b,S,T,$),[vt,pt]}z.drawImage(u,g,x,H,D,X,W,O,I);const st=Math.hypot(t,a),J=Math.hypot(b,S);return[st*O,J*I]}function E(z){const{width:u,height:g}=z;if(u>P||g>P)return null;const x=1e3,H=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),D=u+1;let X=new Uint8Array(D*(g+1)),W,O,I;const t=u+7&-8;let a=new Uint8Array(t*g),b=0;for(const J of z.data){let rt=128;for(;rt>0;)a[b++]=J&rt?0:255,rt>>=1}let S=0;for(b=0,a[b]!==0&&(X[0]=1,++S),O=1;O<u;O++)a[b]!==a[b+1]&&(X[O]=a[b]?2:1,++S),b++;for(a[b]!==0&&(X[O]=2,++S),W=1;W<g;W++){b=W*t,I=W*D,a[b-t]!==a[b]&&(X[I]=a[b]?1:8,++S);let J=(a[b]?4:0)+(a[b-t]?8:0);for(O=1;O<u;O++)J=(J>>2)+(a[b+1]?4:0)+(a[b-t+1]?8:0),H[J]&&(X[I+O]=H[J],++S),b++;if(a[b-t]!==a[b]&&(X[I+O]=a[b]?2:4,++S),S>x)return null}for(b=t*(g-1),I=W*D,a[b]!==0&&(X[I]=8,++S),O=1;O<u;O++)a[b]!==a[b+1]&&(X[I+O]=a[b]?4:8,++S),b++;if(a[b]!==0&&(X[I+O]=4,++S),S>x)return null;const T=new Int32Array([0,D,-1,0,-D,0,0,0,1]),$=new Path2D;for(W=0;S&&W<=g;W++){let J=W*D;const rt=J+u;for(;J<rt&&!X[J];)J++;if(J===rt)continue;$.moveTo(J%D,W);const ot=J;let nt=X[J];do{const at=T[nt];do J+=at;while(!X[J]);const ft=X[J];ft!==5&&ft!==10?(nt=ft,X[J]=0):(nt=ft&51*nt>>4,X[J]&=nt>>2|nt<<2),$.lineTo(J%D,J/D|0),X[J]||--S}while(ot!==J);--W}return a=null,X=null,function(J){J.save(),J.scale(1/u,-1/g),J.translate(0,-g),J.fill($),J.beginPath(),J.restore()}}class C{constructor(u,g){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=l.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=l.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=l.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,u,g])}clone(){const u=Object.create(this);return u.clipBox=this.clipBox.slice(),u}setCurrentPoint(u,g){this.x=u,this.y=g}updatePathMinMax(u,g,x){[g,x]=l.Util.applyTransform([g,x],u),this.minX=Math.min(this.minX,g),this.minY=Math.min(this.minY,x),this.maxX=Math.max(this.maxX,g),this.maxY=Math.max(this.maxY,x)}updateRectMinMax(u,g){const x=l.Util.applyTransform(g,u),H=l.Util.applyTransform(g.slice(2),u);this.minX=Math.min(this.minX,x[0],H[0]),this.minY=Math.min(this.minY,x[1],H[1]),this.maxX=Math.max(this.maxX,x[0],H[0]),this.maxY=Math.max(this.maxY,x[1],H[1])}updateScalingPathMinMax(u,g){l.Util.scaleMinMax(u,g),this.minX=Math.min(this.minX,g[0]),this.maxX=Math.max(this.maxX,g[1]),this.minY=Math.min(this.minY,g[2]),this.maxY=Math.max(this.maxY,g[3])}updateCurvePathMinMax(u,g,x,H,D,X,W,O,I,t){const a=l.Util.bezierBoundingBox(g,x,H,D,X,W,O,I);if(t){t[0]=Math.min(t[0],a[0],a[2]),t[1]=Math.max(t[1],a[0],a[2]),t[2]=Math.min(t[2],a[1],a[3]),t[3]=Math.max(t[3],a[1],a[3]);return}this.updateRectMinMax(u,a)}getPathBoundingBox(u=G.PathType.FILL,g=null){const x=[this.minX,this.minY,this.maxX,this.maxY];if(u===G.PathType.STROKE){g||(0,l.unreachable)("Stroke bounding box must include transform.");const H=l.Util.singularValueDecompose2dScale(g),D=H[0]*this.lineWidth/2,X=H[1]*this.lineWidth/2;x[0]-=D,x[1]-=X,x[2]+=D,x[3]+=X}return x}updateClipFromPath(){const u=l.Util.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(u||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(u){this.clipBox=u,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(u=G.PathType.FILL,g=null){return l.Util.intersect(this.clipBox,this.getPathBoundingBox(u,g))}}function m(z,u){if(typeof ImageData<"u"&&u instanceof ImageData){z.putImageData(u,0,0);return}const g=u.height,x=u.width,H=g%p,D=(g-H)/p,X=H===0?D:D+1,W=z.createImageData(x,p);let O=0,I;const t=u.data,a=W.data;let b,S,T,$;if(u.kind===l.ImageKind.GRAYSCALE_1BPP){const st=t.byteLength,J=new Uint32Array(a.buffer,0,a.byteLength>>2),rt=J.length,ot=x+7>>3,nt=4294967295,at=l.FeatureTest.isLittleEndian?4278190080:255;for(b=0;b<X;b++){for(T=b<D?p:H,I=0,S=0;S<T;S++){const ft=st-O;let pt=0;const xt=ft>ot?x:ft*8-7,vt=xt&-8;let Tt=0,K=0;for(;pt<vt;pt+=8)K=t[O++],J[I++]=K&128?nt:at,J[I++]=K&64?nt:at,J[I++]=K&32?nt:at,J[I++]=K&16?nt:at,J[I++]=K&8?nt:at,J[I++]=K&4?nt:at,J[I++]=K&2?nt:at,J[I++]=K&1?nt:at;for(;pt<xt;pt++)Tt===0&&(K=t[O++],Tt=128),J[I++]=K&Tt?nt:at,Tt>>=1}for(;I<rt;)J[I++]=0;z.putImageData(W,0,b*p)}}else if(u.kind===l.ImageKind.RGBA_32BPP){for(S=0,$=x*p*4,b=0;b<D;b++)a.set(t.subarray(O,O+$)),O+=$,z.putImageData(W,0,S),S+=p;b<X&&($=x*H*4,a.set(t.subarray(O,O+$)),z.putImageData(W,0,S))}else if(u.kind===l.ImageKind.RGB_24BPP)for(T=p,$=x*T,b=0;b<X;b++){for(b>=D&&(T=H,$=x*T),I=0,S=$;S--;)a[I++]=t[O++],a[I++]=t[O++],a[I++]=t[O++],a[I++]=255;z.putImageData(W,0,b*p)}else throw new Error(`bad image kind: ${u.kind}`)}function e(z,u){if(u.bitmap){z.drawImage(u.bitmap,0,0);return}const g=u.height,x=u.width,H=g%p,D=(g-H)/p,X=H===0?D:D+1,W=z.createImageData(x,p);let O=0;const I=u.data,t=W.data;for(let a=0;a<X;a++){const b=a<D?p:H;({srcPos:O}=(0,q.convertBlackAndWhiteToRGBA)({src:I,srcPos:O,dest:t,width:x,height:b,nonBlackColor:0})),z.putImageData(W,0,a*p)}}function n(z,u){const g=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const x of g)z[x]!==void 0&&(u[x]=z[x]);z.setLineDash!==void 0&&(u.setLineDash(z.getLineDash()),u.lineDashOffset=z.lineDashOffset)}function h(z){z.strokeStyle=z.fillStyle="#000000",z.fillRule="nonzero",z.globalAlpha=1,z.lineWidth=1,z.lineCap="butt",z.lineJoin="miter",z.miterLimit=10,z.globalCompositeOperation="source-over",z.font="10px sans-serif",z.setLineDash!==void 0&&(z.setLineDash([]),z.lineDashOffset=0),Z.isNodeJS||(z.filter="none")}function o(z,u,g,x){const H=z.length;for(let D=3;D<H;D+=4){const X=z[D];if(X===0)z[D-3]=u,z[D-2]=g,z[D-1]=x;else if(X<255){const W=255-X;z[D-3]=z[D-3]*X+u*W>>8,z[D-2]=z[D-2]*X+g*W>>8,z[D-1]=z[D-1]*X+x*W>>8}}}function d(z,u,g){const x=z.length,H=1/255;for(let D=3;D<x;D+=4){const X=g?g[z[D]]:z[D];u[D]=u[D]*X*H|0}}function F(z,u,g){const x=z.length;for(let H=3;H<x;H+=4){const D=z[H-3]*77+z[H-2]*152+z[H-1]*28;u[H]=g?u[H]*g[D>>8]>>8:u[H]*D>>16}}function s(z,u,g,x,H,D,X,W,O,I,t){const a=!!D,b=a?D[0]:0,S=a?D[1]:0,T=a?D[2]:0;let $;H==="Luminosity"?$=F:$=d;const J=Math.min(x,Math.ceil(1048576/g));for(let rt=0;rt<x;rt+=J){const ot=Math.min(J,x-rt),nt=z.getImageData(W-I,rt+(O-t),g,ot),at=u.getImageData(W,rt+O,g,ot);a&&o(nt.data,b,S,T),$(nt.data,at.data,X),u.putImageData(at,W,rt+O)}}function B(z,u,g,x){const H=x[0],D=x[1],X=x[2]-H,W=x[3]-D;X===0||W===0||(s(u.context,g,X,W,u.subtype,u.backdrop,u.transferMap,H,D,u.offsetX,u.offsetY),z.save(),z.globalAlpha=1,z.globalCompositeOperation="source-over",z.setTransform(1,0,0,1,0,0),z.drawImage(g.canvas,0,0),z.restore())}function V(z,u){const g=l.Util.singularValueDecompose2dScale(z);g[0]=Math.fround(g[0]),g[1]=Math.fround(g[1]);const x=Math.fround((globalThis.devicePixelRatio||1)*A.PixelsPerInch.PDF_TO_CSS_UNITS);return u!==void 0?u:g[0]<=x||g[1]<=x}const Y=["butt","round","square"],Q=["miter","round","bevel"],et={},ut={},_t=class{constructor(u,g,x,H,D,{optionalContentConfig:X,markedContentStack:W=null},O,I){tt(this,ht);tt(this,At);this.ctx=u,this.current=new C(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=g,this.objs=x,this.canvasFactory=H,this.filterFactory=D,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=W||[],this.optionalContentConfig=X,this.cachedCanvases=new c(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=O,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=I,this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(u,g=null){return typeof u=="string"?u.startsWith("g_")?this.commonObjs.get(u):this.objs.get(u):g}beginDrawing({transform:u,viewport:g,transparency:x=!1,background:H=null}){const D=this.ctx.canvas.width,X=this.ctx.canvas.height,W=this.ctx.fillStyle;if(this.ctx.fillStyle=H||"#ffffff",this.ctx.fillRect(0,0,D,X),this.ctx.fillStyle=W,x){const O=this.cachedCanvases.getCanvas("transparent",D,X);this.compositeCtx=this.ctx,this.transparentCanvas=O.canvas,this.ctx=O.context,this.ctx.save(),this.ctx.transform(...(0,A.getCurrentTransform)(this.compositeCtx))}this.ctx.save(),h(this.ctx),u&&(this.ctx.transform(...u),this.outputScaleX=u[0],this.outputScaleY=u[0]),this.ctx.transform(...g.transform),this.viewportScale=g.scale,this.baseTransform=(0,A.getCurrentTransform)(this.ctx)}executeOperatorList(u,g,x,H){const D=u.argsArray,X=u.fnArray;let W=g||0;const O=D.length;if(O===W)return W;const I=O-W>w&&typeof x=="function",t=I?Date.now()+N:0;let a=0;const b=this.commonObjs,S=this.objs;let T;for(;;){if(H!==void 0&&W===H.nextBreakPoint)return H.breakIt(W,x),W;if(T=X[W],T!==l.OPS.dependency)this[T].apply(this,D[W]);else for(const $ of D[W]){const st=$.startsWith("g_")?b:S;if(!st.has($))return st.get($,x),W}if(W++,W===O)return W;if(I&&++a>w){if(Date.now()>t)return x(),W;a=0}}}endDrawing(){it(this,ht,ye).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const u of this._cachedBitmapsMap.values()){for(const g of u.values())typeof HTMLCanvasElement<"u"&&g instanceof HTMLCanvasElement&&(g.width=g.height=0);u.clear()}this._cachedBitmapsMap.clear(),it(this,At,_e).call(this)}_scaleImage(u,g){const x=u.width,H=u.height;let D=Math.max(Math.hypot(g[0],g[1]),1),X=Math.max(Math.hypot(g[2],g[3]),1),W=x,O=H,I="prescale1",t,a;for(;D>2&&W>1||X>2&&O>1;){let b=W,S=O;D>2&&W>1&&(b=W>=16384?Math.floor(W/2)-1||1:Math.ceil(W/2),D/=W/b),X>2&&O>1&&(S=O>=16384?Math.floor(O/2)-1||1:Math.ceil(O)/2,X/=O/S),t=this.cachedCanvases.getCanvas(I,b,S),a=t.context,a.clearRect(0,0,b,S),a.drawImage(u,0,0,W,O,0,0,b,S),u=t.canvas,W=b,O=S,I=I==="prescale1"?"prescale2":"prescale1"}return{img:u,paintWidth:W,paintHeight:O}}_createMaskCanvas(u){const g=this.ctx,{width:x,height:H}=u,D=this.current.fillColor,X=this.current.patternFill,W=(0,A.getCurrentTransform)(g);let O,I,t,a;if((u.bitmap||u.data)&&u.count>1){const pt=u.bitmap||u.data.buffer;I=JSON.stringify(X?W:[W.slice(0,4),D]),O=this._cachedBitmapsMap.get(pt),O||(O=new Map,this._cachedBitmapsMap.set(pt,O));const xt=O.get(I);if(xt&&!X){const vt=Math.round(Math.min(W[0],W[2])+W[4]),Tt=Math.round(Math.min(W[1],W[3])+W[5]);return{canvas:xt,offsetX:vt,offsetY:Tt}}t=xt}t||(a=this.cachedCanvases.getCanvas("maskCanvas",x,H),e(a.context,u));let b=l.Util.transform(W,[1/x,0,0,-1/H,0,0]);b=l.Util.transform(b,[1,0,0,1,0,-H]);const S=l.Util.applyTransform([0,0],b),T=l.Util.applyTransform([x,H],b),$=l.Util.normalizeRect([S[0],S[1],T[0],T[1]]),st=Math.round($[2]-$[0])||1,J=Math.round($[3]-$[1])||1,rt=this.cachedCanvases.getCanvas("fillCanvas",st,J),ot=rt.context,nt=Math.min(S[0],T[0]),at=Math.min(S[1],T[1]);ot.translate(-nt,-at),ot.transform(...b),t||(t=this._scaleImage(a.canvas,(0,A.getCurrentTransformInverse)(ot)),t=t.img,O&&X&&O.set(I,t)),ot.imageSmoothingEnabled=V((0,A.getCurrentTransform)(ot),u.interpolate),_(ot,t,0,0,t.width,t.height,0,0,x,H),ot.globalCompositeOperation="source-in";const ft=l.Util.transform((0,A.getCurrentTransformInverse)(ot),[1,0,0,1,-nt,-at]);return ot.fillStyle=X?D.getPattern(g,this,ft,G.PathType.FILL):D,ot.fillRect(0,0,x,H),O&&!X&&(this.cachedCanvases.delete("fillCanvas"),O.set(I,rt.canvas)),{canvas:rt.canvas,offsetX:Math.round(nt),offsetY:Math.round(at)}}setLineWidth(u){u!==this.current.lineWidth&&(this._cachedScaleForStroking=null),this.current.lineWidth=u,this.ctx.lineWidth=u}setLineCap(u){this.ctx.lineCap=Y[u]}setLineJoin(u){this.ctx.lineJoin=Q[u]}setMiterLimit(u){this.ctx.miterLimit=u}setDash(u,g){const x=this.ctx;x.setLineDash!==void 0&&(x.setLineDash(u),x.lineDashOffset=g)}setRenderingIntent(u){}setFlatness(u){}setGState(u){for(const[g,x]of u)switch(g){case"LW":this.setLineWidth(x);break;case"LC":this.setLineCap(x);break;case"LJ":this.setLineJoin(x);break;case"ML":this.setMiterLimit(x);break;case"D":this.setDash(x[0],x[1]);break;case"RI":this.setRenderingIntent(x);break;case"FL":this.setFlatness(x);break;case"Font":this.setFont(x[0],x[1]);break;case"CA":this.current.strokeAlpha=x;break;case"ca":this.current.fillAlpha=x,this.ctx.globalAlpha=x;break;case"BM":this.ctx.globalCompositeOperation=x;break;case"SMask":this.current.activeSMask=x?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(x);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const u=this.inSMaskMode;this.current.activeSMask&&!u?this.beginSMaskMode():!this.current.activeSMask&&u&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const u=this.ctx.canvas.width,g=this.ctx.canvas.height,x="smaskGroupAt"+this.groupLevel,H=this.cachedCanvases.getCanvas(x,u,g);this.suspendedCtx=this.ctx,this.ctx=H.context;const D=this.ctx;D.setTransform(...(0,A.getCurrentTransform)(this.suspendedCtx)),n(this.suspendedCtx,D),f(D,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),n(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(u){if(!this.current.activeSMask)return;u?(u[0]=Math.floor(u[0]),u[1]=Math.floor(u[1]),u[2]=Math.ceil(u[2]),u[3]=Math.ceil(u[3])):u=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const g=this.current.activeSMask,x=this.suspendedCtx;B(x,g,this.ctx,u),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}save(){this.inSMaskMode?(n(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const u=this.current;this.stateStack.push(u),this.current=u.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),n(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null)}transform(u,g,x,H,D,X){this.ctx.transform(u,g,x,H,D,X),this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null}constructPath(u,g,x){const H=this.ctx,D=this.current;let X=D.x,W=D.y,O,I;const t=(0,A.getCurrentTransform)(H),a=t[0]===0&&t[3]===0||t[1]===0&&t[2]===0,b=a?x.slice(0):null;for(let S=0,T=0,$=u.length;S<$;S++)switch(u[S]|0){case l.OPS.rectangle:X=g[T++],W=g[T++];const st=g[T++],J=g[T++],rt=X+st,ot=W+J;H.moveTo(X,W),st===0||J===0?H.lineTo(rt,ot):(H.lineTo(rt,W),H.lineTo(rt,ot),H.lineTo(X,ot)),a||D.updateRectMinMax(t,[X,W,rt,ot]),H.closePath();break;case l.OPS.moveTo:X=g[T++],W=g[T++],H.moveTo(X,W),a||D.updatePathMinMax(t,X,W);break;case l.OPS.lineTo:X=g[T++],W=g[T++],H.lineTo(X,W),a||D.updatePathMinMax(t,X,W);break;case l.OPS.curveTo:O=X,I=W,X=g[T+4],W=g[T+5],H.bezierCurveTo(g[T],g[T+1],g[T+2],g[T+3],X,W),D.updateCurvePathMinMax(t,O,I,g[T],g[T+1],g[T+2],g[T+3],X,W,b),T+=6;break;case l.OPS.curveTo2:O=X,I=W,H.bezierCurveTo(X,W,g[T],g[T+1],g[T+2],g[T+3]),D.updateCurvePathMinMax(t,O,I,X,W,g[T],g[T+1],g[T+2],g[T+3],b),X=g[T+2],W=g[T+3],T+=4;break;case l.OPS.curveTo3:O=X,I=W,X=g[T+2],W=g[T+3],H.bezierCurveTo(g[T],g[T+1],X,W,X,W),D.updateCurvePathMinMax(t,O,I,g[T],g[T+1],X,W,X,W,b),T+=4;break;case l.OPS.closePath:H.closePath();break}a&&D.updateScalingPathMinMax(t,b),D.setCurrentPoint(X,W)}closePath(){this.ctx.closePath()}stroke(u=!0){const g=this.ctx,x=this.current.strokeColor;g.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof x=="object"&&(x!=null&&x.getPattern)?(g.save(),g.strokeStyle=x.getPattern(g,this,(0,A.getCurrentTransformInverse)(g),G.PathType.STROKE),this.rescaleAndStroke(!1),g.restore()):this.rescaleAndStroke(!0)),u&&this.consumePath(this.current.getClippedPathBoundingBox()),g.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(u=!0){const g=this.ctx,x=this.current.fillColor,H=this.current.patternFill;let D=!1;H&&(g.save(),g.fillStyle=x.getPattern(g,this,(0,A.getCurrentTransformInverse)(g),G.PathType.FILL),D=!0);const X=this.current.getClippedPathBoundingBox();this.contentVisible&&X!==null&&(this.pendingEOFill?(g.fill("evenodd"),this.pendingEOFill=!1):g.fill()),D&&g.restore(),u&&this.consumePath(X)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=et}eoClip(){this.pendingClip=ut}beginText(){this.current.textMatrix=l.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const u=this.pendingTextPaths,g=this.ctx;if(u===void 0){g.beginPath();return}g.save(),g.beginPath();for(const x of u)g.setTransform(...x.transform),g.translate(x.x,x.y),x.addToPath(g,x.fontSize);g.restore(),g.clip(),g.beginPath(),delete this.pendingTextPaths}setCharSpacing(u){this.current.charSpacing=u}setWordSpacing(u){this.current.wordSpacing=u}setHScale(u){this.current.textHScale=u/100}setLeading(u){this.current.leading=-u}setFont(u,g){const x=this.commonObjs.get(u),H=this.current;if(!x)throw new Error(`Can't find font for ${u}`);if(H.fontMatrix=x.fontMatrix||l.FONT_IDENTITY_MATRIX,(H.fontMatrix[0]===0||H.fontMatrix[3]===0)&&(0,l.warn)("Invalid font matrix for font "+u),g<0?(g=-g,H.fontDirection=-1):H.fontDirection=1,this.current.font=x,this.current.fontSize=g,x.isType3Font)return;const D=x.loadedName||"sans-serif";let X="normal";x.black?X="900":x.bold&&(X="bold");const W=x.italic?"italic":"normal",O=`"${D}", ${x.fallbackName}`;let I=g;g<L?I=L:g>M&&(I=M),this.current.fontSizeScale=g/I,this.ctx.font=`${W} ${X} ${I}px ${O}`}setTextRenderingMode(u){this.current.textRenderingMode=u}setTextRise(u){this.current.textRise=u}moveText(u,g){this.current.x=this.current.lineX+=u,this.current.y=this.current.lineY+=g}setLeadingMoveText(u,g){this.setLeading(-g),this.moveText(u,g)}setTextMatrix(u,g,x,H,D,X){this.current.textMatrix=[u,g,x,H,D,X],this.current.textMatrixScale=Math.hypot(u,g),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(u,g,x,H){const D=this.ctx,X=this.current,W=X.font,O=X.textRenderingMode,I=X.fontSize/X.fontSizeScale,t=O&l.TextRenderingMode.FILL_STROKE_MASK,a=!!(O&l.TextRenderingMode.ADD_TO_PATH_FLAG),b=X.patternFill&&!W.missingFile;let S;(W.disableFontFace||a||b)&&(S=W.getPathGenerator(this.commonObjs,u)),W.disableFontFace||b?(D.save(),D.translate(g,x),D.beginPath(),S(D,I),H&&D.setTransform(...H),(t===l.TextRenderingMode.FILL||t===l.TextRenderingMode.FILL_STROKE)&&D.fill(),(t===l.TextRenderingMode.STROKE||t===l.TextRenderingMode.FILL_STROKE)&&D.stroke(),D.restore()):((t===l.TextRenderingMode.FILL||t===l.TextRenderingMode.FILL_STROKE)&&D.fillText(u,g,x),(t===l.TextRenderingMode.STROKE||t===l.TextRenderingMode.FILL_STROKE)&&D.strokeText(u,g,x)),a&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:(0,A.getCurrentTransform)(D),x:g,y:x,fontSize:I,addToPath:S})}get isFontSubpixelAAEnabled(){const{context:u}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);u.scale(1.5,1),u.fillText("I",0,10);const g=u.getImageData(0,0,10,10).data;let x=!1;for(let H=3;H<g.length;H+=4)if(g[H]>0&&g[H]<255){x=!0;break}return(0,l.shadow)(this,"isFontSubpixelAAEnabled",x)}showText(u){const g=this.current,x=g.font;if(x.isType3Font)return this.showType3Text(u);const H=g.fontSize;if(H===0)return;const D=this.ctx,X=g.fontSizeScale,W=g.charSpacing,O=g.wordSpacing,I=g.fontDirection,t=g.textHScale*I,a=u.length,b=x.vertical,S=b?1:-1,T=x.defaultVMetrics,$=H*g.fontMatrix[0],st=g.textRenderingMode===l.TextRenderingMode.FILL&&!x.disableFontFace&&!g.patternFill;D.save(),D.transform(...g.textMatrix),D.translate(g.x,g.y+g.textRise),I>0?D.scale(t,-1):D.scale(t,1);let J;if(g.patternFill){D.save();const ft=g.fillColor.getPattern(D,this,(0,A.getCurrentTransformInverse)(D),G.PathType.FILL);J=(0,A.getCurrentTransform)(D),D.restore(),D.fillStyle=ft}let rt=g.lineWidth;const ot=g.textMatrixScale;if(ot===0||rt===0){const ft=g.textRenderingMode&l.TextRenderingMode.FILL_STROKE_MASK;(ft===l.TextRenderingMode.STROKE||ft===l.TextRenderingMode.FILL_STROKE)&&(rt=this.getSinglePixelWidth())}else rt/=ot;if(X!==1&&(D.scale(X,X),rt/=X),D.lineWidth=rt,x.isInvalidPDFjsFont){const ft=[];let pt=0;for(const xt of u)ft.push(xt.unicode),pt+=xt.width;D.fillText(ft.join(""),0,0),g.x+=pt*$*t,D.restore(),this.compose();return}let nt=0,at;for(at=0;at<a;++at){const ft=u[at];if(typeof ft=="number"){nt+=S*ft*H/1e3;continue}let pt=!1;const xt=(ft.isSpace?O:0)+W,vt=ft.fontChar,Tt=ft.accent;let K,yt,St=ft.width;if(b){const dt=ft.vmetric||T,k=-(ft.vmetric?dt[1]:St*.5)*$,j=dt[2]*$;St=dt?-dt[0]:St,K=k/X,yt=(nt+j)/X}else K=nt/X,yt=0;if(x.remeasure&&St>0){const dt=D.measureText(vt).width*1e3/H*X;if(St<dt&&this.isFontSubpixelAAEnabled){const k=St/dt;pt=!0,D.save(),D.scale(k,1),K/=k}else St!==dt&&(K+=(St-dt)/2e3*H/X)}if(this.contentVisible&&(ft.isInFont||x.missingFile)){if(st&&!Tt)D.fillText(vt,K,yt);else if(this.paintChar(vt,K,yt,J),Tt){const dt=K+H*Tt.offset.x/X,k=yt-H*Tt.offset.y/X;this.paintChar(Tt.fontChar,dt,k,J)}}let Mt;b?Mt=St*$-xt*I:Mt=St*$+xt*I,nt+=Mt,pt&&D.restore()}b?g.y-=nt:g.x+=nt*t,D.restore(),this.compose()}showType3Text(u){const g=this.ctx,x=this.current,H=x.font,D=x.fontSize,X=x.fontDirection,W=H.vertical?1:-1,O=x.charSpacing,I=x.wordSpacing,t=x.textHScale*X,a=x.fontMatrix||l.FONT_IDENTITY_MATRIX,b=u.length,S=x.textRenderingMode===l.TextRenderingMode.INVISIBLE;let T,$,st,J;if(!(S||D===0)){for(this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null,g.save(),g.transform(...x.textMatrix),g.translate(x.x,x.y),g.scale(t,X),T=0;T<b;++T){if($=u[T],typeof $=="number"){J=W*$*D/1e3,this.ctx.translate(J,0),x.x+=J*t;continue}const rt=($.isSpace?I:0)+O,ot=H.charProcOperatorList[$.operatorListId];if(!ot){(0,l.warn)(`Type3 character "${$.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=$,this.save(),g.scale(D,D),g.transform(...a),this.executeOperatorList(ot),this.restore()),st=l.Util.applyTransform([$.width,0],a)[0]*D+rt,g.translate(st,0),x.x+=st*t}g.restore(),this.processingType3=null}}setCharWidth(u,g){}setCharWidthAndBounds(u,g,x,H,D,X){this.ctx.rect(x,H,D-x,X-H),this.ctx.clip(),this.endPath()}getColorN_Pattern(u){let g;if(u[0]==="TilingPattern"){const x=u[1],H=this.baseTransform||(0,A.getCurrentTransform)(this.ctx),D={createCanvasGraphics:X=>new _t(X,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};g=new G.TilingPattern(u,x,this.ctx,D,H)}else g=this._getPattern(u[1],u[2]);return g}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(u,g,x){const H=l.Util.makeHexColor(u,g,x);this.ctx.strokeStyle=H,this.current.strokeColor=H}setFillRGBColor(u,g,x){const H=l.Util.makeHexColor(u,g,x);this.ctx.fillStyle=H,this.current.fillColor=H,this.current.patternFill=!1}_getPattern(u,g=null){let x;return this.cachedPatterns.has(u)?x=this.cachedPatterns.get(u):(x=(0,G.getShadingPattern)(this.getObject(u)),this.cachedPatterns.set(u,x)),g&&(x.matrix=g),x}shadingFill(u){if(!this.contentVisible)return;const g=this.ctx;this.save();const x=this._getPattern(u);g.fillStyle=x.getPattern(g,this,(0,A.getCurrentTransformInverse)(g),G.PathType.SHADING);const H=(0,A.getCurrentTransformInverse)(g);if(H){const D=g.canvas,X=D.width,W=D.height,O=l.Util.applyTransform([0,0],H),I=l.Util.applyTransform([0,W],H),t=l.Util.applyTransform([X,0],H),a=l.Util.applyTransform([X,W],H),b=Math.min(O[0],I[0],t[0],a[0]),S=Math.min(O[1],I[1],t[1],a[1]),T=Math.max(O[0],I[0],t[0],a[0]),$=Math.max(O[1],I[1],t[1],a[1]);this.ctx.fillRect(b,S,T-b,$-S)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){(0,l.unreachable)("Should not call beginInlineImage")}beginImageData(){(0,l.unreachable)("Should not call beginImageData")}paintFormXObjectBegin(u,g){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(u)&&u.length===6&&this.transform(...u),this.baseTransform=(0,A.getCurrentTransform)(this.ctx),g)){const x=g[2]-g[0],H=g[3]-g[1];this.ctx.rect(g[0],g[1],x,H),this.current.updateRectMinMax((0,A.getCurrentTransform)(this.ctx),g),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(u){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const g=this.ctx;u.isolated||(0,l.info)("TODO: Support non-isolated groups."),u.knockout&&(0,l.warn)("Knockout groups not supported.");const x=(0,A.getCurrentTransform)(g);if(u.matrix&&g.transform(...u.matrix),!u.bbox)throw new Error("Bounding box is required.");let H=l.Util.getAxialAlignedBoundingBox(u.bbox,(0,A.getCurrentTransform)(g));const D=[0,0,g.canvas.width,g.canvas.height];H=l.Util.intersect(H,D)||[0,0,0,0];const X=Math.floor(H[0]),W=Math.floor(H[1]);let O=Math.max(Math.ceil(H[2])-X,1),I=Math.max(Math.ceil(H[3])-W,1),t=1,a=1;O>v&&(t=O/v,O=v),I>v&&(a=I/v,I=v),this.current.startNewPathAndClipBox([0,0,O,I]);let b="groupAt"+this.groupLevel;u.smask&&(b+="_smask_"+this.smaskCounter++%2);const S=this.cachedCanvases.getCanvas(b,O,I),T=S.context;T.scale(1/t,1/a),T.translate(-X,-W),T.transform(...x),u.smask?this.smaskStack.push({canvas:S.canvas,context:T,offsetX:X,offsetY:W,scaleX:t,scaleY:a,subtype:u.smask.subtype,backdrop:u.smask.backdrop,transferMap:u.smask.transferMap||null,startTransformInverse:null}):(g.setTransform(1,0,0,1,0,0),g.translate(X,W),g.scale(t,a),g.save()),n(g,T),this.ctx=T,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(g),this.groupLevel++}endGroup(u){if(!this.contentVisible)return;this.groupLevel--;const g=this.ctx,x=this.groupStack.pop();if(this.ctx=x,this.ctx.imageSmoothingEnabled=!1,u.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const H=(0,A.getCurrentTransform)(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...H);const D=l.Util.getAxialAlignedBoundingBox([0,0,g.canvas.width,g.canvas.height],H);this.ctx.drawImage(g.canvas,0,0),this.ctx.restore(),this.compose(D)}}beginAnnotation(u,g,x,H,D){if(it(this,ht,ye).call(this),h(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),Array.isArray(g)&&g.length===4){const X=g[2]-g[0],W=g[3]-g[1];if(D&&this.annotationCanvasMap){x=x.slice(),x[4]-=g[0],x[5]-=g[1],g=g.slice(),g[0]=g[1]=0,g[2]=X,g[3]=W;const[O,I]=l.Util.singularValueDecompose2dScale((0,A.getCurrentTransform)(this.ctx)),{viewportScale:t}=this,a=Math.ceil(X*this.outputScaleX*t),b=Math.ceil(W*this.outputScaleY*t);this.annotationCanvas=this.canvasFactory.create(a,b);const{canvas:S,context:T}=this.annotationCanvas;this.annotationCanvasMap.set(u,S),this.annotationCanvas.savedCtx=this.ctx,this.ctx=T,this.ctx.save(),this.ctx.setTransform(O,0,0,-I,0,W*I),h(this.ctx)}else h(this.ctx),this.ctx.rect(g[0],g[1],X,W),this.ctx.clip(),this.endPath()}this.current=new C(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...x),this.transform(...H)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),it(this,At,_e).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(u){if(!this.contentVisible)return;const g=u.count;u=this.getObject(u.data,u),u.count=g;const x=this.ctx,H=this.processingType3;if(H&&(H.compiled===void 0&&(H.compiled=E(u)),H.compiled)){H.compiled(x);return}const D=this._createMaskCanvas(u),X=D.canvas;x.save(),x.setTransform(1,0,0,1,0,0),x.drawImage(X,D.offsetX,D.offsetY),x.restore(),this.compose()}paintImageMaskXObjectRepeat(u,g,x=0,H=0,D,X){if(!this.contentVisible)return;u=this.getObject(u.data,u);const W=this.ctx;W.save();const O=(0,A.getCurrentTransform)(W);W.transform(g,x,H,D,0,0);const I=this._createMaskCanvas(u);W.setTransform(1,0,0,1,I.offsetX-O[4],I.offsetY-O[5]);for(let t=0,a=X.length;t<a;t+=2){const b=l.Util.transform(O,[g,x,H,D,X[t],X[t+1]]),[S,T]=l.Util.applyTransform([0,0],b);W.drawImage(I.canvas,S,T)}W.restore(),this.compose()}paintImageMaskXObjectGroup(u){if(!this.contentVisible)return;const g=this.ctx,x=this.current.fillColor,H=this.current.patternFill;for(const D of u){const{data:X,width:W,height:O,transform:I}=D,t=this.cachedCanvases.getCanvas("maskCanvas",W,O),a=t.context;a.save();const b=this.getObject(X,D);e(a,b),a.globalCompositeOperation="source-in",a.fillStyle=H?x.getPattern(a,this,(0,A.getCurrentTransformInverse)(g),G.PathType.FILL):x,a.fillRect(0,0,W,O),a.restore(),g.save(),g.transform(...I),g.scale(1,-1),_(g,t.canvas,0,0,W,O,0,-1,1,1),g.restore()}this.compose()}paintImageXObject(u){if(!this.contentVisible)return;const g=this.getObject(u);if(!g){(0,l.warn)("Dependent image isn't ready yet");return}this.paintInlineImageXObject(g)}paintImageXObjectRepeat(u,g,x,H){if(!this.contentVisible)return;const D=this.getObject(u);if(!D){(0,l.warn)("Dependent image isn't ready yet");return}const X=D.width,W=D.height,O=[];for(let I=0,t=H.length;I<t;I+=2)O.push({transform:[g,0,0,x,H[I],H[I+1]],x:0,y:0,w:X,h:W});this.paintInlineImageXObjectGroup(D,O)}applyTransferMapsToCanvas(u){return this.current.transferMaps!=="none"&&(u.filter=this.current.transferMaps,u.drawImage(u.canvas,0,0),u.filter="none"),u.canvas}applyTransferMapsToBitmap(u){if(this.current.transferMaps==="none")return u.bitmap;const{bitmap:g,width:x,height:H}=u,D=this.cachedCanvases.getCanvas("inlineImage",x,H),X=D.context;return X.filter=this.current.transferMaps,X.drawImage(g,0,0),X.filter="none",D.canvas}paintInlineImageXObject(u){if(!this.contentVisible)return;const g=u.width,x=u.height,H=this.ctx;this.save(),Z.isNodeJS||(H.filter="none"),H.scale(1/g,-1/x);let D;if(u.bitmap)D=this.applyTransferMapsToBitmap(u);else if(typeof HTMLElement=="function"&&u instanceof HTMLElement||!u.data)D=u;else{const O=this.cachedCanvases.getCanvas("inlineImage",g,x).context;m(O,u),D=this.applyTransferMapsToCanvas(O)}const X=this._scaleImage(D,(0,A.getCurrentTransformInverse)(H));H.imageSmoothingEnabled=V((0,A.getCurrentTransform)(H),u.interpolate),_(H,X.img,0,0,X.paintWidth,X.paintHeight,0,-x,g,x),this.compose(),this.restore()}paintInlineImageXObjectGroup(u,g){if(!this.contentVisible)return;const x=this.ctx;let H;if(u.bitmap)H=u.bitmap;else{const D=u.width,X=u.height,O=this.cachedCanvases.getCanvas("inlineImage",D,X).context;m(O,u),H=this.applyTransferMapsToCanvas(O)}for(const D of g)x.save(),x.transform(...D.transform),x.scale(1,-1),_(x,H,D.x,D.y,D.w,D.h,0,-1,1,1),x.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(u){}markPointProps(u,g){}beginMarkedContent(u){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(u,g){u==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(g)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(u){const g=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(u);const x=this.ctx;this.pendingClip&&(g||(this.pendingClip===ut?x.clip("evenodd"):x.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),x.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const u=(0,A.getCurrentTransform)(this.ctx);if(u[1]===0&&u[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(u[0]),Math.abs(u[3]));else{const g=Math.abs(u[0]*u[3]-u[2]*u[1]),x=Math.hypot(u[0],u[2]),H=Math.hypot(u[1],u[3]);this._cachedGetSinglePixelWidth=Math.max(x,H)/g}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(!this._cachedScaleForStroking){const{lineWidth:u}=this.current,g=(0,A.getCurrentTransform)(this.ctx);let x,H;if(g[1]===0&&g[2]===0){const D=Math.abs(g[0]),X=Math.abs(g[3]);if(u===0)x=1/D,H=1/X;else{const W=D*u,O=X*u;x=W<1?1/W:1,H=O<1?1/O:1}}else{const D=Math.abs(g[0]*g[3]-g[2]*g[1]),X=Math.hypot(g[0],g[1]),W=Math.hypot(g[2],g[3]);if(u===0)x=W/D,H=X/D;else{const O=u*D;x=W>O?W/O:1,H=X>O?X/O:1}}this._cachedScaleForStroking=[x,H]}return this._cachedScaleForStroking}rescaleAndStroke(u){const{ctx:g}=this,{lineWidth:x}=this.current,[H,D]=this.getScaleForStroking();if(g.lineWidth=x||1,H===1&&D===1){g.stroke();return}let X,W,O;u&&(X=(0,A.getCurrentTransform)(g),W=g.getLineDash().slice(),O=g.lineDashOffset),g.scale(H,D);const I=Math.max(H,D);g.setLineDash(g.getLineDash().map(t=>t/I)),g.lineDashOffset/=I,g.stroke(),u&&(g.setTransform(...X),g.setLineDash(W),g.lineDashOffset=O)}isContentVisible(){for(let u=this.markedContentStack.length-1;u>=0;u--)if(!this.markedContentStack[u].visible)return!1;return!0}};let lt=_t;ht=new WeakSet,ye=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},At=new WeakSet,_e=function(){if(this.pageColors){const u=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(u!=="none"){const g=this.ctx.filter;this.ctx.filter=u,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=g}}},i.CanvasGraphics=lt;for(const z in l.OPS)lt.prototype[z]!==void 0&&(lt.prototype[l.OPS[z]]=lt.prototype[z])},(R,i,U)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.TilingPattern=i.PathType=void 0,i.getShadingPattern=P;var l=U(1),A=U(6);const G={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};i.PathType=G;function q(_,E){if(!E)return;const C=E[2]-E[0],m=E[3]-E[1],e=new Path2D;e.rect(E[0],E[1],C,m),_.clip(e)}class Z{constructor(){this.constructor===Z&&(0,l.unreachable)("Cannot initialize BaseShadingPattern.")}getPattern(){(0,l.unreachable)("Abstract method `getPattern` called.")}}class L extends Z{constructor(E){super(),this._type=E[1],this._bbox=E[2],this._colorStops=E[3],this._p0=E[4],this._p1=E[5],this._r0=E[6],this._r1=E[7],this.matrix=null}_createGradient(E){let C;this._type==="axial"?C=E.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(C=E.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const m of this._colorStops)C.addColorStop(m[0],m[1]);return C}getPattern(E,C,m,e){let n;if(e===G.STROKE||e===G.FILL){const h=C.current.getClippedPathBoundingBox(e,(0,A.getCurrentTransform)(E))||[0,0,0,0],o=Math.ceil(h[2]-h[0])||1,d=Math.ceil(h[3]-h[1])||1,F=C.cachedCanvases.getCanvas("pattern",o,d,!0),s=F.context;s.clearRect(0,0,s.canvas.width,s.canvas.height),s.beginPath(),s.rect(0,0,s.canvas.width,s.canvas.height),s.translate(-h[0],-h[1]),m=l.Util.transform(m,[1,0,0,1,h[0],h[1]]),s.transform(...C.baseTransform),this.matrix&&s.transform(...this.matrix),q(s,this._bbox),s.fillStyle=this._createGradient(s),s.fill(),n=E.createPattern(F.canvas,"no-repeat");const B=new DOMMatrix(m);n.setTransform(B)}else q(E,this._bbox),n=this._createGradient(E);return n}}function M(_,E,C,m,e,n,h,o){const d=E.coords,F=E.colors,s=_.data,B=_.width*4;let V;d[C+1]>d[m+1]&&(V=C,C=m,m=V,V=n,n=h,h=V),d[m+1]>d[e+1]&&(V=m,m=e,e=V,V=h,h=o,o=V),d[C+1]>d[m+1]&&(V=C,C=m,m=V,V=n,n=h,h=V);const Y=(d[C]+E.offsetX)*E.scaleX,Q=(d[C+1]+E.offsetY)*E.scaleY,et=(d[m]+E.offsetX)*E.scaleX,ut=(d[m+1]+E.offsetY)*E.scaleY,lt=(d[e]+E.offsetX)*E.scaleX,ht=(d[e+1]+E.offsetY)*E.scaleY;if(Q>=ht)return;const mt=F[n],At=F[n+1],Et=F[n+2],_t=F[h],z=F[h+1],u=F[h+2],g=F[o],x=F[o+1],H=F[o+2],D=Math.round(Q),X=Math.round(ht);let W,O,I,t,a,b,S,T;for(let $=D;$<=X;$++){if($<ut){let nt;$<Q?nt=0:nt=(Q-$)/(Q-ut),W=Y-(Y-et)*nt,O=mt-(mt-_t)*nt,I=At-(At-z)*nt,t=Et-(Et-u)*nt}else{let nt;$>ht?nt=1:ut===ht?nt=0:nt=(ut-$)/(ut-ht),W=et-(et-lt)*nt,O=_t-(_t-g)*nt,I=z-(z-x)*nt,t=u-(u-H)*nt}let st;$<Q?st=0:$>ht?st=1:st=(Q-$)/(Q-ht),a=Y-(Y-lt)*st,b=mt-(mt-g)*st,S=At-(At-x)*st,T=Et-(Et-H)*st;const J=Math.round(Math.min(W,a)),rt=Math.round(Math.max(W,a));let ot=B*$+J*4;for(let nt=J;nt<=rt;nt++)st=(W-nt)/(W-a),st<0?st=0:st>1&&(st=1),s[ot++]=O-(O-b)*st|0,s[ot++]=I-(I-S)*st|0,s[ot++]=t-(t-T)*st|0,s[ot++]=255}}function v(_,E,C){const m=E.coords,e=E.colors;let n,h;switch(E.type){case"lattice":const o=E.verticesPerRow,d=Math.floor(m.length/o)-1,F=o-1;for(n=0;n<d;n++){let s=n*o;for(let B=0;B<F;B++,s++)M(_,C,m[s],m[s+1],m[s+o],e[s],e[s+1],e[s+o]),M(_,C,m[s+o+1],m[s+1],m[s+o],e[s+o+1],e[s+1],e[s+o])}break;case"triangles":for(n=0,h=m.length;n<h;n+=3)M(_,C,m[n],m[n+1],m[n+2],e[n],e[n+1],e[n+2]);break;default:throw new Error("illegal figure")}}class N extends Z{constructor(E){super(),this._coords=E[2],this._colors=E[3],this._figures=E[4],this._bounds=E[5],this._bbox=E[7],this._background=E[8],this.matrix=null}_createMeshCanvas(E,C,m){const o=Math.floor(this._bounds[0]),d=Math.floor(this._bounds[1]),F=Math.ceil(this._bounds[2])-o,s=Math.ceil(this._bounds[3])-d,B=Math.min(Math.ceil(Math.abs(F*E[0]*1.1)),3e3),V=Math.min(Math.ceil(Math.abs(s*E[1]*1.1)),3e3),Y=F/B,Q=s/V,et={coords:this._coords,colors:this._colors,offsetX:-o,offsetY:-d,scaleX:1/Y,scaleY:1/Q},ut=B+2*2,lt=V+2*2,ht=m.getCanvas("mesh",ut,lt,!1),mt=ht.context,At=mt.createImageData(B,V);if(C){const _t=At.data;for(let z=0,u=_t.length;z<u;z+=4)_t[z]=C[0],_t[z+1]=C[1],_t[z+2]=C[2],_t[z+3]=255}for(const _t of this._figures)v(At,_t,et);return mt.putImageData(At,2,2),{canvas:ht.canvas,offsetX:o-2*Y,offsetY:d-2*Q,scaleX:Y,scaleY:Q}}getPattern(E,C,m,e){q(E,this._bbox);let n;if(e===G.SHADING)n=l.Util.singularValueDecompose2dScale((0,A.getCurrentTransform)(E));else if(n=l.Util.singularValueDecompose2dScale(C.baseTransform),this.matrix){const o=l.Util.singularValueDecompose2dScale(this.matrix);n=[n[0]*o[0],n[1]*o[1]]}const h=this._createMeshCanvas(n,e===G.SHADING?null:this._background,C.cachedCanvases);return e!==G.SHADING&&(E.setTransform(...C.baseTransform),this.matrix&&E.transform(...this.matrix)),E.translate(h.offsetX,h.offsetY),E.scale(h.scaleX,h.scaleY),E.createPattern(h.canvas,"no-repeat")}}class w extends Z{getPattern(){return"hotpink"}}function P(_){switch(_[0]){case"RadialAxial":return new L(_);case"Mesh":return new N(_);case"Dummy":return new w}throw new Error(`Unknown IR type: ${_[0]}`)}const p={COLORED:1,UNCOLORED:2},c=class{constructor(E,C,m,e,n){this.operatorList=E[2],this.matrix=E[3]||[1,0,0,1,0,0],this.bbox=E[4],this.xstep=E[5],this.ystep=E[6],this.paintType=E[7],this.tilingType=E[8],this.color=C,this.ctx=m,this.canvasGraphicsFactory=e,this.baseTransform=n}createPatternCanvas(E){const C=this.operatorList,m=this.bbox,e=this.xstep,n=this.ystep,h=this.paintType,o=this.tilingType,d=this.color,F=this.canvasGraphicsFactory;(0,l.info)("TilingType: "+o);const s=m[0],B=m[1],V=m[2],Y=m[3],Q=l.Util.singularValueDecompose2dScale(this.matrix),et=l.Util.singularValueDecompose2dScale(this.baseTransform),ut=[Q[0]*et[0],Q[1]*et[1]],lt=this.getSizeAndScale(e,this.ctx.canvas.width,ut[0]),ht=this.getSizeAndScale(n,this.ctx.canvas.height,ut[1]),mt=E.cachedCanvases.getCanvas("pattern",lt.size,ht.size,!0),At=mt.context,Et=F.createCanvasGraphics(At);Et.groupLevel=E.groupLevel,this.setFillAndStrokeStyleToContext(Et,h,d);let _t=s,z=B,u=V,g=Y;return s<0&&(_t=0,u+=Math.abs(s)),B<0&&(z=0,g+=Math.abs(B)),At.translate(-(lt.scale*_t),-(ht.scale*z)),Et.transform(lt.scale,0,0,ht.scale,0,0),At.save(),this.clipBbox(Et,_t,z,u,g),Et.baseTransform=(0,A.getCurrentTransform)(Et.ctx),Et.executeOperatorList(C),Et.endDrawing(),{canvas:mt.canvas,scaleX:lt.scale,scaleY:ht.scale,offsetX:_t,offsetY:z}}getSizeAndScale(E,C,m){E=Math.abs(E);const e=Math.max(c.MAX_PATTERN_SIZE,C);let n=Math.ceil(E*m);return n>=e?n=e:m=n/E,{scale:m,size:n}}clipBbox(E,C,m,e,n){const h=e-C,o=n-m;E.ctx.rect(C,m,h,o),E.current.updateRectMinMax((0,A.getCurrentTransform)(E.ctx),[C,m,e,n]),E.clip(),E.endPath()}setFillAndStrokeStyleToContext(E,C,m){const e=E.ctx,n=E.current;switch(C){case p.COLORED:const h=this.ctx;e.fillStyle=h.fillStyle,e.strokeStyle=h.strokeStyle,n.fillColor=h.fillStyle,n.strokeColor=h.strokeStyle;break;case p.UNCOLORED:const o=l.Util.makeHexColor(m[0],m[1],m[2]);e.fillStyle=o,e.strokeStyle=o,n.fillColor=o,n.strokeColor=o;break;default:throw new l.FormatError(`Unsupported paint type: ${C}`)}}getPattern(E,C,m,e){let n=m;e!==G.SHADING&&(n=l.Util.transform(n,C.baseTransform),this.matrix&&(n=l.Util.transform(n,this.matrix)));const h=this.createPatternCanvas(C);let o=new DOMMatrix(n);o=o.translate(h.offsetX,h.offsetY),o=o.scale(1/h.scaleX,1/h.scaleY);const d=E.createPattern(h.canvas,"repeat");return d.setTransform(o),d}};let f=c;Lt(f,"MAX_PATTERN_SIZE",3e3),i.TilingPattern=f},(R,i,U)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.convertBlackAndWhiteToRGBA=G,i.convertToRGBA=A,i.grayToRGBA=Z;var l=U(1);function A(L){switch(L.kind){case l.ImageKind.GRAYSCALE_1BPP:return G(L);case l.ImageKind.RGB_24BPP:return q(L)}return null}function G({src:L,srcPos:M=0,dest:v,width:N,height:w,nonBlackColor:P=4294967295,inverseDecode:p=!1}){const f=l.FeatureTest.isLittleEndian?4278190080:255,[c,_]=p?[P,f]:[f,P],E=N>>3,C=N&7,m=L.length;v=new Uint32Array(v.buffer);let e=0;for(let n=0;n<w;n++){for(const o=M+E;M<o;M++){const d=M<m?L[M]:255;v[e++]=d&128?_:c,v[e++]=d&64?_:c,v[e++]=d&32?_:c,v[e++]=d&16?_:c,v[e++]=d&8?_:c,v[e++]=d&4?_:c,v[e++]=d&2?_:c,v[e++]=d&1?_:c}if(C===0)continue;const h=M<m?L[M++]:255;for(let o=0;o<C;o++)v[e++]=h&1<<7-o?_:c}return{srcPos:M,destPos:e}}function q({src:L,srcPos:M=0,dest:v,destPos:N=0,width:w,height:P}){let p=0;const f=L.length>>2,c=new Uint32Array(L.buffer,M,f);if(l.FeatureTest.isLittleEndian){for(;p<f-2;p+=3,N+=4){const _=c[p],E=c[p+1],C=c[p+2];v[N]=_|4278190080,v[N+1]=_>>>24|E<<8|4278190080,v[N+2]=E>>>16|C<<16|4278190080,v[N+3]=C>>>8|4278190080}for(let _=p*4,E=L.length;_<E;_+=3)v[N++]=L[_]|L[_+1]<<8|L[_+2]<<16|4278190080}else{for(;p<f-2;p+=3,N+=4){const _=c[p],E=c[p+1],C=c[p+2];v[N]=_|255,v[N+1]=_<<24|E>>>8|255,v[N+2]=E<<16|C>>>16|255,v[N+3]=C<<8|255}for(let _=p*4,E=L.length;_<E;_+=3)v[N++]=L[_]<<24|L[_+1]<<16|L[_+2]<<8|255}return{srcPos:M,destPos:N}}function Z(L,M){if(l.FeatureTest.isLittleEndian)for(let v=0,N=L.length;v<N;v++)M[v]=L[v]*65793|4278190080;else for(let v=0,N=L.length;v<N;v++)M[v]=L[v]*16843008|255}},(R,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.GlobalWorkerOptions=void 0;const U=Object.create(null);i.GlobalWorkerOptions=U,U.workerPort=null,U.workerSrc=""},(R,i,U)=>{var L,Ge,v,He,w,oe;Object.defineProperty(i,"__esModule",{value:!0}),i.MessageHandler=void 0;var l=U(1);const A={UNKNOWN:0,DATA:1,ERROR:2},G={UNKNOWN:0,CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function q(p){switch(p instanceof Error||typeof p=="object"&&p!==null||(0,l.unreachable)('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),p.name){case"AbortException":return new l.AbortException(p.message);case"MissingPDFException":return new l.MissingPDFException(p.message);case"PasswordException":return new l.PasswordException(p.message,p.code);case"UnexpectedResponseException":return new l.UnexpectedResponseException(p.message,p.status);case"UnknownErrorException":return new l.UnknownErrorException(p.message,p.details);default:return new l.UnknownErrorException(p.message,p.toString())}}class Z{constructor(f,c,_){tt(this,L);tt(this,v);tt(this,w);this.sourceName=f,this.targetName=c,this.comObj=_,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=E=>{const C=E.data;if(C.targetName!==this.sourceName)return;if(C.stream){it(this,v,He).call(this,C);return}if(C.callback){const e=C.callbackId,n=this.callbackCapabilities[e];if(!n)throw new Error(`Cannot resolve callback ${e}`);if(delete this.callbackCapabilities[e],C.callback===A.DATA)n.resolve(C.data);else if(C.callback===A.ERROR)n.reject(q(C.reason));else throw new Error("Unexpected callback case");return}const m=this.actionHandler[C.action];if(!m)throw new Error(`Unknown action from worker: ${C.action}`);if(C.callbackId){const e=this.sourceName,n=C.sourceName;new Promise(function(h){h(m(C.data))}).then(function(h){_.postMessage({sourceName:e,targetName:n,callback:A.DATA,callbackId:C.callbackId,data:h})},function(h){_.postMessage({sourceName:e,targetName:n,callback:A.ERROR,callbackId:C.callbackId,reason:q(h)})});return}if(C.streamId){it(this,L,Ge).call(this,C);return}m(C.data)},_.addEventListener("message",this._onComObjOnMessage)}on(f,c){const _=this.actionHandler;if(_[f])throw new Error(`There is already an actionName called "${f}"`);_[f]=c}send(f,c,_){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:f,data:c},_)}sendWithPromise(f,c,_){const E=this.callbackId++,C=new l.PromiseCapability;this.callbackCapabilities[E]=C;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:f,callbackId:E,data:c},_)}catch(m){C.reject(m)}return C.promise}sendWithStream(f,c,_,E){const C=this.streamId++,m=this.sourceName,e=this.targetName,n=this.comObj;return new ReadableStream({start:h=>{const o=new l.PromiseCapability;return this.streamControllers[C]={controller:h,startCall:o,pullCall:null,cancelCall:null,isClosed:!1},n.postMessage({sourceName:m,targetName:e,action:f,streamId:C,data:c,desiredSize:h.desiredSize},E),o.promise},pull:h=>{const o=new l.PromiseCapability;return this.streamControllers[C].pullCall=o,n.postMessage({sourceName:m,targetName:e,stream:G.PULL,streamId:C,desiredSize:h.desiredSize}),o.promise},cancel:h=>{(0,l.assert)(h instanceof Error,"cancel must have a valid reason");const o=new l.PromiseCapability;return this.streamControllers[C].cancelCall=o,this.streamControllers[C].isClosed=!0,n.postMessage({sourceName:m,targetName:e,stream:G.CANCEL,streamId:C,reason:q(h)}),o.promise}},_)}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}L=new WeakSet,Ge=function(f){const c=f.streamId,_=this.sourceName,E=f.sourceName,C=this.comObj,m=this,e=this.actionHandler[f.action],n={enqueue(h,o=1,d){if(this.isCancelled)return;const F=this.desiredSize;this.desiredSize-=o,F>0&&this.desiredSize<=0&&(this.sinkCapability=new l.PromiseCapability,this.ready=this.sinkCapability.promise),C.postMessage({sourceName:_,targetName:E,stream:G.ENQUEUE,streamId:c,chunk:h},d)},close(){this.isCancelled||(this.isCancelled=!0,C.postMessage({sourceName:_,targetName:E,stream:G.CLOSE,streamId:c}),delete m.streamSinks[c])},error(h){(0,l.assert)(h instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,C.postMessage({sourceName:_,targetName:E,stream:G.ERROR,streamId:c,reason:q(h)}))},sinkCapability:new l.PromiseCapability,onPull:null,onCancel:null,isCancelled:!1,desiredSize:f.desiredSize,ready:null};n.sinkCapability.resolve(),n.ready=n.sinkCapability.promise,this.streamSinks[c]=n,new Promise(function(h){h(e(f.data,n))}).then(function(){C.postMessage({sourceName:_,targetName:E,stream:G.START_COMPLETE,streamId:c,success:!0})},function(h){C.postMessage({sourceName:_,targetName:E,stream:G.START_COMPLETE,streamId:c,reason:q(h)})})},v=new WeakSet,He=function(f){const c=f.streamId,_=this.sourceName,E=f.sourceName,C=this.comObj,m=this.streamControllers[c],e=this.streamSinks[c];switch(f.stream){case G.START_COMPLETE:f.success?m.startCall.resolve():m.startCall.reject(q(f.reason));break;case G.PULL_COMPLETE:f.success?m.pullCall.resolve():m.pullCall.reject(q(f.reason));break;case G.PULL:if(!e){C.postMessage({sourceName:_,targetName:E,stream:G.PULL_COMPLETE,streamId:c,success:!0});break}e.desiredSize<=0&&f.desiredSize>0&&e.sinkCapability.resolve(),e.desiredSize=f.desiredSize,new Promise(function(n){var h;n((h=e.onPull)==null?void 0:h.call(e))}).then(function(){C.postMessage({sourceName:_,targetName:E,stream:G.PULL_COMPLETE,streamId:c,success:!0})},function(n){C.postMessage({sourceName:_,targetName:E,stream:G.PULL_COMPLETE,streamId:c,reason:q(n)})});break;case G.ENQUEUE:if((0,l.assert)(m,"enqueue should have stream controller"),m.isClosed)break;m.controller.enqueue(f.chunk);break;case G.CLOSE:if((0,l.assert)(m,"close should have stream controller"),m.isClosed)break;m.isClosed=!0,m.controller.close(),it(this,w,oe).call(this,m,c);break;case G.ERROR:(0,l.assert)(m,"error should have stream controller"),m.controller.error(q(f.reason)),it(this,w,oe).call(this,m,c);break;case G.CANCEL_COMPLETE:f.success?m.cancelCall.resolve():m.cancelCall.reject(q(f.reason)),it(this,w,oe).call(this,m,c);break;case G.CANCEL:if(!e)break;new Promise(function(n){var h;n((h=e.onCancel)==null?void 0:h.call(e,q(f.reason)))}).then(function(){C.postMessage({sourceName:_,targetName:E,stream:G.CANCEL_COMPLETE,streamId:c,success:!0})},function(n){C.postMessage({sourceName:_,targetName:E,stream:G.CANCEL_COMPLETE,streamId:c,reason:q(n)})}),e.sinkCapability.reject(q(f.reason)),e.isCancelled=!0,delete this.streamSinks[c];break;default:throw new Error("Unexpected stream case")}},w=new WeakSet,oe=async function(f,c){var _,E,C;await Promise.allSettled([(_=f.startCall)==null?void 0:_.promise,(E=f.pullCall)==null?void 0:E.promise,(C=f.cancelCall)==null?void 0:C.promise]),delete this.streamControllers[c]},i.MessageHandler=Z},(R,i,U)=>{var G,q;Object.defineProperty(i,"__esModule",{value:!0}),i.Metadata=void 0;var l=U(1);class A{constructor({parsedData:L,rawData:M}){tt(this,G,void 0);tt(this,q,void 0);gt(this,G,L),gt(this,q,M)}getRaw(){return y(this,q)}get(L){return y(this,G).get(L)??null}getAll(){return(0,l.objectFromMap)(y(this,G))}has(L){return y(this,G).has(L)}}G=new WeakMap,q=new WeakMap,i.Metadata=A},(R,i,U)=>{var L,M,v,N,w,P,Ae;Object.defineProperty(i,"__esModule",{value:!0}),i.OptionalContentConfig=void 0;var l=U(1),A=U(8);const G=Symbol("INTERNAL");class q{constructor(c,_){tt(this,L,!0);this.name=c,this.intent=_}get visible(){return y(this,L)}_setVisible(c,_){c!==G&&(0,l.unreachable)("Internal method `_setVisible` called."),gt(this,L,_)}}L=new WeakMap;class Z{constructor(c){tt(this,P);tt(this,M,null);tt(this,v,new Map);tt(this,N,null);tt(this,w,null);if(this.name=null,this.creator=null,c!==null){this.name=c.name,this.creator=c.creator,gt(this,w,c.order);for(const _ of c.groups)y(this,v).set(_.id,new q(_.name,_.intent));if(c.baseState==="OFF")for(const _ of y(this,v).values())_._setVisible(G,!1);for(const _ of c.on)y(this,v).get(_)._setVisible(G,!0);for(const _ of c.off)y(this,v).get(_)._setVisible(G,!1);gt(this,N,this.getHash())}}isVisible(c){if(y(this,v).size===0)return!0;if(!c)return(0,l.warn)("Optional content group not defined."),!0;if(c.type==="OCG")return y(this,v).has(c.id)?y(this,v).get(c.id).visible:((0,l.warn)(`Optional content group not found: ${c.id}`),!0);if(c.type==="OCMD"){if(c.expression)return it(this,P,Ae).call(this,c.expression);if(!c.policy||c.policy==="AnyOn"){for(const _ of c.ids){if(!y(this,v).has(_))return(0,l.warn)(`Optional content group not found: ${_}`),!0;if(y(this,v).get(_).visible)return!0}return!1}else if(c.policy==="AllOn"){for(const _ of c.ids){if(!y(this,v).has(_))return(0,l.warn)(`Optional content group not found: ${_}`),!0;if(!y(this,v).get(_).visible)return!1}return!0}else if(c.policy==="AnyOff"){for(const _ of c.ids){if(!y(this,v).has(_))return(0,l.warn)(`Optional content group not found: ${_}`),!0;if(!y(this,v).get(_).visible)return!0}return!1}else if(c.policy==="AllOff"){for(const _ of c.ids){if(!y(this,v).has(_))return(0,l.warn)(`Optional content group not found: ${_}`),!0;if(y(this,v).get(_).visible)return!1}return!0}return(0,l.warn)(`Unknown optional content policy ${c.policy}.`),!0}return(0,l.warn)(`Unknown group type ${c.type}.`),!0}setVisibility(c,_=!0){if(!y(this,v).has(c)){(0,l.warn)(`Optional content group not found: ${c}`);return}y(this,v).get(c)._setVisible(G,!!_),gt(this,M,null)}get hasInitialVisibility(){return this.getHash()===y(this,N)}getOrder(){return y(this,v).size?y(this,w)?y(this,w).slice():[...y(this,v).keys()]:null}getGroups(){return y(this,v).size>0?(0,l.objectFromMap)(y(this,v)):null}getGroup(c){return y(this,v).get(c)||null}getHash(){if(y(this,M)!==null)return y(this,M);const c=new A.MurmurHash3_64;for(const[_,E]of y(this,v))c.update(`${_}:${E.visible}`);return gt(this,M,c.hexdigest())}}M=new WeakMap,v=new WeakMap,N=new WeakMap,w=new WeakMap,P=new WeakSet,Ae=function(c){const _=c.length;if(_<2)return!0;const E=c[0];for(let C=1;C<_;C++){const m=c[C];let e;if(Array.isArray(m))e=it(this,P,Ae).call(this,m);else if(y(this,v).has(m))e=y(this,v).get(m).visible;else return(0,l.warn)(`Optional content group not found: ${m}`),!0;switch(E){case"And":if(!e)return!1;break;case"Or":if(e)return!0;break;case"Not":return!e;default:return!0}}return E==="And"},i.OptionalContentConfig=Z},(R,i,U)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.PDFDataTransportStream=void 0;var l=U(1),A=U(6);class G{constructor({length:M,initialData:v,progressiveDone:N=!1,contentDispositionFilename:w=null,disableRange:P=!1,disableStream:p=!1},f){if((0,l.assert)(f,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.'),this._queuedChunks=[],this._progressiveDone=N,this._contentDispositionFilename=w,(v==null?void 0:v.length)>0){const c=v instanceof Uint8Array&&v.byteLength===v.buffer.byteLength?v.buffer:new Uint8Array(v).buffer;this._queuedChunks.push(c)}this._pdfDataRangeTransport=f,this._isStreamingSupported=!p,this._isRangeSupported=!P,this._contentLength=M,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener((c,_)=>{this._onReceiveData({begin:c,chunk:_})}),this._pdfDataRangeTransport.addProgressListener((c,_)=>{this._onProgress({loaded:c,total:_})}),this._pdfDataRangeTransport.addProgressiveReadListener(c=>{this._onReceiveData({chunk:c})}),this._pdfDataRangeTransport.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),this._pdfDataRangeTransport.transportReady()}_onReceiveData({begin:M,chunk:v}){const N=v instanceof Uint8Array&&v.byteLength===v.buffer.byteLength?v.buffer:new Uint8Array(v).buffer;if(M===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(N):this._queuedChunks.push(N);else{const w=this._rangeReaders.some(function(P){return P._begin!==M?!1:(P._enqueue(N),!0)});(0,l.assert)(w,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var M;return((M=this._fullRequestReader)==null?void 0:M._loaded)??0}_onProgress(M){var v,N,w,P;M.total===void 0?(N=(v=this._rangeReaders[0])==null?void 0:v.onProgress)==null||N.call(v,{loaded:M.loaded}):(P=(w=this._fullRequestReader)==null?void 0:w.onProgress)==null||P.call(w,{loaded:M.loaded,total:M.total})}_onProgressiveDone(){var M;(M=this._fullRequestReader)==null||M.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(M){const v=this._rangeReaders.indexOf(M);v>=0&&this._rangeReaders.splice(v,1)}getFullReader(){(0,l.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const M=this._queuedChunks;return this._queuedChunks=null,new q(this,M,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(M,v){if(v<=this._progressiveDataLength)return null;const N=new Z(this,M,v);return this._pdfDataRangeTransport.requestDataRange(M,v),this._rangeReaders.push(N),N}cancelAllRequests(M){var v;(v=this._fullRequestReader)==null||v.cancel(M);for(const N of this._rangeReaders.slice(0))N.cancel(M);this._pdfDataRangeTransport.abort()}}i.PDFDataTransportStream=G;class q{constructor(M,v,N=!1,w=null){this._stream=M,this._done=N||!1,this._filename=(0,A.isPdfFile)(w)?w:null,this._queuedChunks=v||[],this._loaded=0;for(const P of this._queuedChunks)this._loaded+=P.byteLength;this._requests=[],this._headersReady=Promise.resolve(),M._fullRequestReader=this,this.onProgress=null}_enqueue(M){this._done||(this._requests.length>0?this._requests.shift().resolve({value:M,done:!1}):this._queuedChunks.push(M),this._loaded+=M.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const M=new l.PromiseCapability;return this._requests.push(M),M.promise}cancel(M){this._done=!0;for(const v of this._requests)v.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class Z{constructor(M,v,N){this._stream=M,this._begin=v,this._end=N,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(M){if(!this._done){if(this._requests.length===0)this._queuedChunk=M;else{this._requests.shift().resolve({value:M,done:!1});for(const N of this._requests)N.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const v=this._queuedChunk;return this._queuedChunk=null,{value:v,done:!1}}if(this._done)return{value:void 0,done:!0};const M=new l.PromiseCapability;return this._requests.push(M),M.promise}cancel(M){this._done=!0;for(const v of this._requests)v.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}},(R,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.XfaText=void 0;class U{static textContent(A){const G=[],q={items:G,styles:Object.create(null)};function Z(L){var N;if(!L)return;let M=null;const v=L.name;if(v==="#text")M=L.value;else if(U.shouldBuildText(v))(N=L==null?void 0:L.attributes)!=null&&N.textContent?M=L.attributes.textContent:L.value&&(M=L.value);else return;if(M!==null&&G.push({str:M}),!!L.children)for(const w of L.children)Z(w)}return Z(A),q}static shouldBuildText(A){return!(A==="textarea"||A==="input"||A==="option"||A==="select")}}i.XfaText=U},(R,i,U)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.NodeStandardFontDataFactory=i.NodeFilterFactory=i.NodeCanvasFactory=i.NodeCMapReaderFactory=void 0;var l=U(7);const A=function(M){return new Promise((v,N)=>{require$$5.readFile(M,(P,p)=>{if(P||!p){N(new Error(P));return}v(new Uint8Array(p))})})};class G extends l.BaseFilterFactory{}i.NodeFilterFactory=G;class q extends l.BaseCanvasFactory{_createCanvas(v,N){return require$$5.createCanvas(v,N)}}i.NodeCanvasFactory=q;class Z extends l.BaseCMapReaderFactory{_fetchData(v,N){return A(v).then(w=>({cMapData:w,compressionType:N}))}}i.NodeCMapReaderFactory=Z;class L extends l.BaseStandardFontDataFactory{_fetchData(v){return A(v)}}i.NodeStandardFontDataFactory=L},(R,i,U)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.PDFNodeStream=void 0;var l=U(1),A=U(22);const G=require$$5,q=require$$5,Z=require$$5,L=require$$5,M=/^file:\/\/\/[a-zA-Z]:\//;function v(C){const m=L.parse(C);return m.protocol==="file:"||m.host?m:/^[a-z]:[/\\]/i.test(C)?L.parse(`file:///${C}`):(m.host||(m.protocol="file:"),m)}class N{constructor(m){this.source=m,this.url=v(m.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.httpHeaders=this.isHttp&&m.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var m;return((m=this._fullRequestReader)==null?void 0:m._loaded)??0}getFullReader(){return(0,l.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new _(this):new f(this),this._fullRequestReader}getRangeReader(m,e){if(e<=this._progressiveDataLength)return null;const n=this.isFsUrl?new E(this,m,e):new c(this,m,e);return this._rangeRequestReaders.push(n),n}cancelAllRequests(m){var e;(e=this._fullRequestReader)==null||e.cancel(m);for(const n of this._rangeRequestReaders.slice(0))n.cancel(m)}}i.PDFNodeStream=N;class w{constructor(m){this._url=m.url,this._done=!1,this._storedError=null,this.onProgress=null;const e=m.source;this._contentLength=e.length,this._loaded=0,this._filename=null,this._disableRange=e.disableRange||!1,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!e.disableStream,this._isRangeSupported=!e.disableRange,this._readableStream=null,this._readCapability=new l.PromiseCapability,this._headersCapability=new l.PromiseCapability}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var n;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const m=this._readableStream.read();return m===null?(this._readCapability=new l.PromiseCapability,this.read()):(this._loaded+=m.length,(n=this.onProgress)==null||n.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(m).buffer,done:!1})}cancel(m){if(!this._readableStream){this._error(m);return}this._readableStream.destroy(m)}_error(m){this._storedError=m,this._readCapability.resolve()}_setReadableStream(m){this._readableStream=m,m.on("readable",()=>{this._readCapability.resolve()}),m.on("end",()=>{m.destroy(),this._done=!0,this._readCapability.resolve()}),m.on("error",e=>{this._error(e)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new l.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class P{constructor(m){this._url=m.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=new l.PromiseCapability;const e=m.source;this._isStreamingSupported=!e.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){var n;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const m=this._readableStream.read();return m===null?(this._readCapability=new l.PromiseCapability,this.read()):(this._loaded+=m.length,(n=this.onProgress)==null||n.call(this,{loaded:this._loaded}),{value:new Uint8Array(m).buffer,done:!1})}cancel(m){if(!this._readableStream){this._error(m);return}this._readableStream.destroy(m)}_error(m){this._storedError=m,this._readCapability.resolve()}_setReadableStream(m){this._readableStream=m,m.on("readable",()=>{this._readCapability.resolve()}),m.on("end",()=>{m.destroy(),this._done=!0,this._readCapability.resolve()}),m.on("error",e=>{this._error(e)}),this._storedError&&this._readableStream.destroy(this._storedError)}}function p(C,m){return{protocol:C.protocol,auth:C.auth,host:C.hostname,port:C.port,path:C.path,method:"GET",headers:m}}class f extends w{constructor(m){super(m);const e=n=>{if(n.statusCode===404){const F=new l.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=F,this._headersCapability.reject(F);return}this._headersCapability.resolve(),this._setReadableStream(n);const h=F=>this._readableStream.headers[F.toLowerCase()],{allowRangeRequests:o,suggestedLength:d}=(0,A.validateRangeRequestCapabilities)({getResponseHeader:h,isHttp:m.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=o,this._contentLength=d||this._contentLength,this._filename=(0,A.extractFilenameFromHeader)(h)};this._request=null,this._url.protocol==="http:"?this._request=q.request(p(this._url,m.httpHeaders),e):this._request=Z.request(p(this._url,m.httpHeaders),e),this._request.on("error",n=>{this._storedError=n,this._headersCapability.reject(n)}),this._request.end()}}class c extends P{constructor(m,e,n){super(m),this._httpHeaders={};for(const o in m.httpHeaders){const d=m.httpHeaders[o];d!==void 0&&(this._httpHeaders[o]=d)}this._httpHeaders.Range=`bytes=${e}-${n-1}`;const h=o=>{if(o.statusCode===404){const d=new l.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=d;return}this._setReadableStream(o)};this._request=null,this._url.protocol==="http:"?this._request=q.request(p(this._url,this._httpHeaders),h):this._request=Z.request(p(this._url,this._httpHeaders),h),this._request.on("error",o=>{this._storedError=o}),this._request.end()}}class _ extends w{constructor(m){super(m);let e=decodeURIComponent(this._url.path);M.test(this._url.href)&&(e=e.replace(/^\//,"")),G.lstat(e,(n,h)=>{if(n){n.code==="ENOENT"&&(n=new l.MissingPDFException(`Missing PDF "${e}".`)),this._storedError=n,this._headersCapability.reject(n);return}this._contentLength=h.size,this._setReadableStream(G.createReadStream(e)),this._headersCapability.resolve()})}}class E extends P{constructor(m,e,n){super(m);let h=decodeURIComponent(this._url.path);M.test(this._url.href)&&(h=h.replace(/^\//,"")),this._setReadableStream(G.createReadStream(h,{start:e,end:n-1}))}}},(R,i,U)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.createResponseStatusError=L,i.extractFilenameFromHeader=Z,i.validateRangeRequestCapabilities=q,i.validateResponseStatus=M;var l=U(1),A=U(23),G=U(6);function q({getResponseHeader:v,isHttp:N,rangeChunkSize:w,disableRange:P}){const p={allowRangeRequests:!1,suggestedLength:void 0},f=parseInt(v("Content-Length"),10);return!Number.isInteger(f)||(p.suggestedLength=f,f<=2*w)||P||!N||v("Accept-Ranges")!=="bytes"||(v("Content-Encoding")||"identity")!=="identity"||(p.allowRangeRequests=!0),p}function Z(v){const N=v("Content-Disposition");if(N){let w=(0,A.getFilenameFromContentDispositionHeader)(N);if(w.includes("%"))try{w=decodeURIComponent(w)}catch{}if((0,G.isPdfFile)(w))return w}return null}function L(v,N){return v===404||v===0&&N.startsWith("file:")?new l.MissingPDFException('Missing PDF "'+N+'".'):new l.UnexpectedResponseException(`Unexpected server response (${v}) while retrieving PDF "${N}".`,v)}function M(v){return v===200||v===206}},(R,i,U)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.getFilenameFromContentDispositionHeader=A;var l=U(1);function A(G){let q=!0,Z=L("filename\\*","i").exec(G);if(Z){Z=Z[1];let f=w(Z);return f=unescape(f),f=P(f),f=p(f),v(f)}if(Z=N(G),Z){const f=p(Z);return v(f)}if(Z=L("filename","i").exec(G),Z){Z=Z[1];let f=w(Z);return f=p(f),v(f)}function L(f,c){return new RegExp("(?:^|;)\\s*"+f+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',c)}function M(f,c){if(f){if(!/^[\x00-\xFF]+$/.test(c))return c;try{const _=new TextDecoder(f,{fatal:!0}),E=(0,l.stringToBytes)(c);c=_.decode(E),q=!1}catch{}}return c}function v(f){return q&&/[\x80-\xff]/.test(f)&&(f=M("utf-8",f),q&&(f=M("iso-8859-1",f))),f}function N(f){const c=[];let _;const E=L("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(_=E.exec(f))!==null;){let[,m,e,n]=_;if(m=parseInt(m,10),m in c){if(m===0)break;continue}c[m]=[e,n]}const C=[];for(let m=0;m<c.length&&m in c;++m){let[e,n]=c[m];n=w(n),e&&(n=unescape(n),m===0&&(n=P(n))),C.push(n)}return C.join("")}function w(f){if(f.startsWith('"')){const c=f.slice(1).split('\\"');for(let _=0;_<c.length;++_){const E=c[_].indexOf('"');E!==-1&&(c[_]=c[_].slice(0,E),c.length=_+1),c[_]=c[_].replaceAll(/\\(.)/g,"$1")}f=c.join('"')}return f}function P(f){const c=f.indexOf("'");if(c===-1)return f;const _=f.slice(0,c),C=f.slice(c+1).replace(/^[^']*'/,"");return M(_,C)}function p(f){return!f.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(f)?f:f.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(c,_,E,C){if(E==="q"||E==="Q")return C=C.replaceAll("_"," "),C=C.replaceAll(/=([0-9a-fA-F]{2})/g,function(m,e){return String.fromCharCode(parseInt(e,16))}),M(_,C);try{C=atob(C)}catch{}return M(_,C)})}return""}},(R,i,U)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.PDFNetworkStream=void 0;var l=U(1),A=U(22);const G=200,q=206;function Z(w){const P=w.response;return typeof P!="string"?P:(0,l.stringToBytes)(P).buffer}class L{constructor(P,p={}){this.url=P,this.isHttp=/^https?:/i.test(P),this.httpHeaders=this.isHttp&&p.httpHeaders||Object.create(null),this.withCredentials=p.withCredentials||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(P,p,f){const c={begin:P,end:p};for(const _ in f)c[_]=f[_];return this.request(c)}requestFull(P){return this.request(P)}request(P){const p=new XMLHttpRequest,f=this.currXhrId++,c=this.pendingRequests[f]={xhr:p};p.open("GET",this.url),p.withCredentials=this.withCredentials;for(const _ in this.httpHeaders){const E=this.httpHeaders[_];E!==void 0&&p.setRequestHeader(_,E)}return this.isHttp&&"begin"in P&&"end"in P?(p.setRequestHeader("Range",`bytes=${P.begin}-${P.end-1}`),c.expectedStatus=q):c.expectedStatus=G,p.responseType="arraybuffer",P.onError&&(p.onerror=function(_){P.onError(p.status)}),p.onreadystatechange=this.onStateChange.bind(this,f),p.onprogress=this.onProgress.bind(this,f),c.onHeadersReceived=P.onHeadersReceived,c.onDone=P.onDone,c.onError=P.onError,c.onProgress=P.onProgress,p.send(null),f}onProgress(P,p){var c;const f=this.pendingRequests[P];f&&((c=f.onProgress)==null||c.call(f,p))}onStateChange(P,p){var m,e,n;const f=this.pendingRequests[P];if(!f)return;const c=f.xhr;if(c.readyState>=2&&f.onHeadersReceived&&(f.onHeadersReceived(),delete f.onHeadersReceived),c.readyState!==4||!(P in this.pendingRequests))return;if(delete this.pendingRequests[P],c.status===0&&this.isHttp){(m=f.onError)==null||m.call(f,c.status);return}const _=c.status||G;if(!(_===G&&f.expectedStatus===q)&&_!==f.expectedStatus){(e=f.onError)==null||e.call(f,c.status);return}const C=Z(c);if(_===q){const h=c.getResponseHeader("Content-Range"),o=/bytes (\d+)-(\d+)\/(\d+)/.exec(h);f.onDone({begin:parseInt(o[1],10),chunk:C})}else C?f.onDone({begin:0,chunk:C}):(n=f.onError)==null||n.call(f,c.status)}getRequestXhr(P){return this.pendingRequests[P].xhr}isPendingRequest(P){return P in this.pendingRequests}abortRequest(P){const p=this.pendingRequests[P].xhr;delete this.pendingRequests[P],p.abort()}}class M{constructor(P){this._source=P,this._manager=new L(P.url,{httpHeaders:P.httpHeaders,withCredentials:P.withCredentials}),this._rangeChunkSize=P.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(P){const p=this._rangeRequestReaders.indexOf(P);p>=0&&this._rangeRequestReaders.splice(p,1)}getFullReader(){return(0,l.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new v(this._manager,this._source),this._fullRequestReader}getRangeReader(P,p){const f=new N(this._manager,P,p);return f.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(f),f}cancelAllRequests(P){var p;(p=this._fullRequestReader)==null||p.cancel(P);for(const f of this._rangeRequestReaders.slice(0))f.cancel(P)}}i.PDFNetworkStream=M;class v{constructor(P,p){this._manager=P;const f={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=p.url,this._fullRequestId=P.requestFull(f),this._headersReceivedCapability=new l.PromiseCapability,this._disableRange=p.disableRange||!1,this._contentLength=p.length,this._rangeChunkSize=p.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const P=this._fullRequestId,p=this._manager.getRequestXhr(P),f=E=>p.getResponseHeader(E),{allowRangeRequests:c,suggestedLength:_}=(0,A.validateRangeRequestCapabilities)({getResponseHeader:f,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});c&&(this._isRangeSupported=!0),this._contentLength=_||this._contentLength,this._filename=(0,A.extractFilenameFromHeader)(f),this._isRangeSupported&&this._manager.abortRequest(P),this._headersReceivedCapability.resolve()}_onDone(P){if(P&&(this._requests.length>0?this._requests.shift().resolve({value:P.chunk,done:!1}):this._cachedChunks.push(P.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const p of this._requests)p.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(P){this._storedError=(0,A.createResponseStatusError)(P,this._url),this._headersReceivedCapability.reject(this._storedError);for(const p of this._requests)p.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(P){var p;(p=this.onProgress)==null||p.call(this,{loaded:P.loaded,total:P.lengthComputable?P.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const P=new l.PromiseCapability;return this._requests.push(P),P.promise}cancel(P){this._done=!0,this._headersReceivedCapability.reject(P);for(const p of this._requests)p.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class N{constructor(P,p,f){this._manager=P;const c={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=P.url,this._requestId=P.requestRange(p,f,c),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){var P;(P=this.onClosed)==null||P.call(this,this)}_onDone(P){const p=P.chunk;this._requests.length>0?this._requests.shift().resolve({value:p,done:!1}):this._queuedChunk=p,this._done=!0;for(const f of this._requests)f.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(P){this._storedError=(0,A.createResponseStatusError)(P,this._url);for(const p of this._requests)p.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(P){var p;this.isStreamingSupported||(p=this.onProgress)==null||p.call(this,{loaded:P.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const p=this._queuedChunk;return this._queuedChunk=null,{value:p,done:!1}}if(this._done)return{value:void 0,done:!0};const P=new l.PromiseCapability;return this._requests.push(P),P.promise}cancel(P){this._done=!0;for(const p of this._requests)p.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}},(R,i,U)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.PDFFetchStream=void 0;var l=U(1),A=U(22);function G(N,w,P){return{method:"GET",headers:N,signal:P.signal,mode:"cors",credentials:w?"include":"same-origin",redirect:"follow"}}function q(N){const w=new Headers;for(const P in N){const p=N[P];p!==void 0&&w.append(P,p)}return w}function Z(N){return N instanceof Uint8Array?N.buffer:N instanceof ArrayBuffer?N:((0,l.warn)(`getArrayBuffer - unexpected data format: ${N}`),new Uint8Array(N).buffer)}class L{constructor(w){this.source=w,this.isHttp=/^https?:/i.test(w.url),this.httpHeaders=this.isHttp&&w.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var w;return((w=this._fullRequestReader)==null?void 0:w._loaded)??0}getFullReader(){return(0,l.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new M(this),this._fullRequestReader}getRangeReader(w,P){if(P<=this._progressiveDataLength)return null;const p=new v(this,w,P);return this._rangeRequestReaders.push(p),p}cancelAllRequests(w){var P;(P=this._fullRequestReader)==null||P.cancel(w);for(const p of this._rangeRequestReaders.slice(0))p.cancel(w)}}i.PDFFetchStream=L;class M{constructor(w){this._stream=w,this._reader=null,this._loaded=0,this._filename=null;const P=w.source;this._withCredentials=P.withCredentials||!1,this._contentLength=P.length,this._headersCapability=new l.PromiseCapability,this._disableRange=P.disableRange||!1,this._rangeChunkSize=P.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!P.disableStream,this._isRangeSupported=!P.disableRange,this._headers=q(this._stream.httpHeaders);const p=P.url;fetch(p,G(this._headers,this._withCredentials,this._abortController)).then(f=>{if(!(0,A.validateResponseStatus)(f.status))throw(0,A.createResponseStatusError)(f.status,p);this._reader=f.body.getReader(),this._headersCapability.resolve();const c=C=>f.headers.get(C),{allowRangeRequests:_,suggestedLength:E}=(0,A.validateRangeRequestCapabilities)({getResponseHeader:c,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=_,this._contentLength=E||this._contentLength,this._filename=(0,A.extractFilenameFromHeader)(c),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new l.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var p;await this._headersCapability.promise;const{value:w,done:P}=await this._reader.read();return P?{value:w,done:P}:(this._loaded+=w.byteLength,(p=this.onProgress)==null||p.call(this,{loaded:this._loaded,total:this._contentLength}),{value:Z(w),done:!1})}cancel(w){var P;(P=this._reader)==null||P.cancel(w),this._abortController.abort()}}class v{constructor(w,P,p){this._stream=w,this._reader=null,this._loaded=0;const f=w.source;this._withCredentials=f.withCredentials||!1,this._readCapability=new l.PromiseCapability,this._isStreamingSupported=!f.disableStream,this._abortController=new AbortController,this._headers=q(this._stream.httpHeaders),this._headers.append("Range",`bytes=${P}-${p-1}`);const c=f.url;fetch(c,G(this._headers,this._withCredentials,this._abortController)).then(_=>{if(!(0,A.validateResponseStatus)(_.status))throw(0,A.createResponseStatusError)(_.status,c);this._readCapability.resolve(),this._reader=_.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var p;await this._readCapability.promise;const{value:w,done:P}=await this._reader.read();return P?{value:w,done:P}:(this._loaded+=w.byteLength,(p=this.onProgress)==null||p.call(this,{loaded:this._loaded}),{value:Z(w),done:!1})}cancel(w){var P;(P=this._reader)==null||P.cancel(w),this._abortController.abort()}}},(R,i,U)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.TextLayerRenderTask=void 0,i.renderTextLayer=f,i.updateTextLayer=c;var l=U(1),A=U(6);const G=1e5,q=30,Z=.8,L=new Map;function M(_,E){let C;if(E&&l.FeatureTest.isOffscreenCanvasSupported)C=new OffscreenCanvas(_,_).getContext("2d",{alpha:!1});else{const m=document.createElement("canvas");m.width=m.height=_,C=m.getContext("2d",{alpha:!1})}return C}function v(_,E){const C=L.get(_);if(C)return C;const m=M(q,E);m.font=`${q}px ${_}`;const e=m.measureText("");let n=e.fontBoundingBoxAscent,h=Math.abs(e.fontBoundingBoxDescent);if(n){const d=n/(n+h);return L.set(_,d),m.canvas.width=m.canvas.height=0,d}m.strokeStyle="red",m.clearRect(0,0,q,q),m.strokeText("g",0,0);let o=m.getImageData(0,0,q,q).data;h=0;for(let d=o.length-1-3;d>=0;d-=4)if(o[d]>0){h=Math.ceil(d/4/q);break}m.clearRect(0,0,q,q),m.strokeText("A",0,q),o=m.getImageData(0,0,q,q).data,n=0;for(let d=0,F=o.length;d<F;d+=4)if(o[d]>0){n=q-Math.floor(d/4/q);break}if(m.canvas.width=m.canvas.height=0,n){const d=n/(n+h);return L.set(_,d),d}return L.set(_,Z),Z}function N(_,E,C){const m=document.createElement("span"),e={angle:0,canvasWidth:0,hasText:E.str!=="",hasEOL:E.hasEOL,fontSize:0};_._textDivs.push(m);const n=l.Util.transform(_._transform,E.transform);let h=Math.atan2(n[1],n[0]);const o=C[E.fontName];o.vertical&&(h+=Math.PI/2);const d=Math.hypot(n[2],n[3]),F=d*v(o.fontFamily,_._isOffscreenCanvasSupported);let s,B;h===0?(s=n[4],B=n[5]-F):(s=n[4]+F*Math.sin(h),B=n[5]-F*Math.cos(h));const V="calc(var(--scale-factor)*",Y=m.style;_._container===_._rootContainer?(Y.left=`${(100*s/_._pageWidth).toFixed(2)}%`,Y.top=`${(100*B/_._pageHeight).toFixed(2)}%`):(Y.left=`${V}${s.toFixed(2)}px)`,Y.top=`${V}${B.toFixed(2)}px)`),Y.fontSize=`${V}${d.toFixed(2)}px)`,Y.fontFamily=o.fontFamily,e.fontSize=d,m.setAttribute("role","presentation"),m.textContent=E.str,m.dir=E.dir,_._fontInspectorEnabled&&(m.dataset.fontName=E.fontName),h!==0&&(e.angle=h*(180/Math.PI));let Q=!1;if(E.str.length>1)Q=!0;else if(E.str!==" "&&E.transform[0]!==E.transform[3]){const et=Math.abs(E.transform[0]),ut=Math.abs(E.transform[3]);et!==ut&&Math.max(et,ut)/Math.min(et,ut)>1.5&&(Q=!0)}Q&&(e.canvasWidth=o.vertical?E.height:E.width),_._textDivProperties.set(m,e),_._isReadableStream&&_._layoutText(m)}function w(_){const{div:E,scale:C,properties:m,ctx:e,prevFontSize:n,prevFontFamily:h}=_,{style:o}=E;let d="";if(m.canvasWidth!==0&&m.hasText){const{fontFamily:F}=o,{canvasWidth:s,fontSize:B}=m;(n!==B||h!==F)&&(e.font=`${B*C}px ${F}`,_.prevFontSize=B,_.prevFontFamily=F);const{width:V}=e.measureText(E.textContent);V>0&&(d=`scaleX(${s*C/V})`)}m.angle!==0&&(d=`rotate(${m.angle}deg) ${d}`),d.length>0&&(o.transform=d)}function P(_){if(_._canceled)return;const E=_._textDivs,C=_._capability;if(E.length>G){C.resolve();return}if(!_._isReadableStream)for(const e of E)_._layoutText(e);C.resolve()}class p{constructor({textContentSource:E,container:C,viewport:m,textDivs:e,textDivProperties:n,textContentItemsStr:h,isOffscreenCanvasSupported:o}){var V;this._textContentSource=E,this._isReadableStream=E instanceof ReadableStream,this._container=this._rootContainer=C,this._textDivs=e||[],this._textContentItemsStr=h||[],this._isOffscreenCanvasSupported=o,this._fontInspectorEnabled=!!((V=globalThis.FontInspector)!=null&&V.enabled),this._reader=null,this._textDivProperties=n||new WeakMap,this._canceled=!1,this._capability=new l.PromiseCapability,this._layoutTextParams={prevFontSize:null,prevFontFamily:null,div:null,scale:m.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:M(0,o)};const{pageWidth:d,pageHeight:F,pageX:s,pageY:B}=m.rawDims;this._transform=[1,0,0,-1,-s,B+F],this._pageWidth=d,this._pageHeight=F,(0,A.setLayerDimensions)(C,m),this._capability.promise.finally(()=>{this._layoutTextParams=null}).catch(()=>{})}get promise(){return this._capability.promise}cancel(){this._canceled=!0,this._reader&&(this._reader.cancel(new l.AbortException("TextLayer task cancelled.")).catch(()=>{}),this._reader=null),this._capability.reject(new l.AbortException("TextLayer task cancelled."))}_processItems(E,C){for(const m of E){if(m.str===void 0){if(m.type==="beginMarkedContentProps"||m.type==="beginMarkedContent"){const e=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),m.id!==null&&this._container.setAttribute("id",`${m.id}`),e.append(this._container)}else m.type==="endMarkedContent"&&(this._container=this._container.parentNode);continue}this._textContentItemsStr.push(m.str),N(this,m,C)}}_layoutText(E){const C=this._layoutTextParams.properties=this._textDivProperties.get(E);if(this._layoutTextParams.div=E,w(this._layoutTextParams),C.hasText&&this._container.append(E),C.hasEOL){const m=document.createElement("br");m.setAttribute("role","presentation"),this._container.append(m)}}_render(){const E=new l.PromiseCapability;let C=Object.create(null);if(this._isReadableStream){const m=()=>{this._reader.read().then(({value:e,done:n})=>{if(n){E.resolve();return}Object.assign(C,e.styles),this._processItems(e.items,C),m()},E.reject)};this._reader=this._textContentSource.getReader(),m()}else if(this._textContentSource){const{items:m,styles:e}=this._textContentSource;this._processItems(m,e),E.resolve()}else throw new Error('No "textContentSource" parameter specified.');E.promise.then(()=>{C=null,P(this)},this._capability.reject)}}i.TextLayerRenderTask=p;function f(_){!_.textContentSource&&(_.textContent||_.textContentStream)&&((0,A.deprecated)("The TextLayerRender `textContent`/`textContentStream` parameters will be removed in the future, please use `textContentSource` instead."),_.textContentSource=_.textContent||_.textContentStream);const{container:E,viewport:C}=_,m=getComputedStyle(E),e=m.getPropertyValue("visibility"),n=parseFloat(m.getPropertyValue("--scale-factor"));e==="visible"&&(!n||Math.abs(n-C.scale)>1e-5)&&console.error("The `--scale-factor` CSS-variable must be set, to the same value as `viewport.scale`, either on the `container`-element itself or higher up in the DOM.");const h=new p(_);return h._render(),h}function c({container:_,viewport:E,textDivs:C,textDivProperties:m,isOffscreenCanvasSupported:e,mustRotate:n=!0,mustRescale:h=!0}){if(n&&(0,A.setLayerDimensions)(_,{rotation:E.rotation}),h){const o=M(0,e),F={prevFontSize:null,prevFontFamily:null,div:null,scale:E.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:o};for(const s of C)F.properties=m.get(s),F.div=s,w(F)}}},(R,i,U)=>{var M,v,N,w,P,p,f,c,_,ve,C,qe,e,Ee,h,Se;Object.defineProperty(i,"__esModule",{value:!0}),i.AnnotationEditorLayer=void 0;var l=U(1),A=U(5),G=U(28),q=U(29),Z=U(6);const d=class{constructor(s){tt(this,_);tt(this,C);tt(this,e);tt(this,h);tt(this,M,void 0);tt(this,v,!1);tt(this,N,this.pointerup.bind(this));tt(this,w,this.pointerdown.bind(this));tt(this,P,new Map);tt(this,p,!1);tt(this,f,!1);tt(this,c,void 0);d._initialized||(d._initialized=!0,G.FreeTextEditor.initialize(s.l10n),q.InkEditor.initialize(s.l10n)),s.uiManager.registerEditorTypes([G.FreeTextEditor,q.InkEditor]),gt(this,c,s.uiManager),this.pageIndex=s.pageIndex,this.div=s.div,gt(this,M,s.accessibilityManager),y(this,c).addLayer(this)}get isEmpty(){return y(this,P).size===0}updateToolbar(s){y(this,c).updateToolbar(s)}updateMode(s=y(this,c).getMode()){it(this,h,Se).call(this),s===l.AnnotationEditorType.INK?(this.addInkEditorIfNeeded(!1),this.disableClick()):this.enableClick(),y(this,c).unselectAll(),s!==l.AnnotationEditorType.NONE&&(this.div.classList.toggle("freeTextEditing",s===l.AnnotationEditorType.FREETEXT),this.div.classList.toggle("inkEditing",s===l.AnnotationEditorType.INK),this.div.hidden=!1)}addInkEditorIfNeeded(s){if(!s&&y(this,c).getMode()!==l.AnnotationEditorType.INK)return;if(!s){for(const V of y(this,P).values())if(V.isEmpty()){V.setInBackground();return}}it(this,e,Ee).call(this,{offsetX:0,offsetY:0}).setInBackground()}setEditingState(s){y(this,c).setEditingState(s)}addCommands(s){y(this,c).addCommands(s)}enable(){this.div.style.pointerEvents="auto";for(const s of y(this,P).values())s.enableEditing()}disable(){this.div.style.pointerEvents="none";for(const s of y(this,P).values())s.disableEditing();it(this,h,Se).call(this),this.isEmpty&&(this.div.hidden=!0)}setActiveEditor(s){y(this,c).getActive()!==s&&y(this,c).setActiveEditor(s)}enableClick(){this.div.addEventListener("pointerdown",y(this,w)),this.div.addEventListener("pointerup",y(this,N))}disableClick(){this.div.removeEventListener("pointerdown",y(this,w)),this.div.removeEventListener("pointerup",y(this,N))}attach(s){y(this,P).set(s.id,s)}detach(s){var B;y(this,P).delete(s.id),(B=y(this,M))==null||B.removePointerInTextLayer(s.contentDiv)}remove(s){y(this,c).removeEditor(s),this.detach(s),s.div.style.display="none",setTimeout(()=>{s.div.style.display="",s.div.remove(),s.isAttachedToDOM=!1,document.activeElement===document.body&&y(this,c).focusMainContainer()},0),y(this,f)||this.addInkEditorIfNeeded(!1)}add(s){if(it(this,_,ve).call(this,s),y(this,c).addEditor(s),this.attach(s),!s.isAttachedToDOM){const B=s.render();this.div.append(B),s.isAttachedToDOM=!0}this.moveEditorInDOM(s),s.onceAdded(),y(this,c).addToAnnotationStorage(s)}moveEditorInDOM(s){var B;(B=y(this,M))==null||B.moveElementInDOM(this.div,s.div,s.contentDiv,!0)}addOrRebuild(s){s.needsToBeRebuilt()?s.rebuild():this.add(s)}addANewEditor(s){const B=()=>{this.addOrRebuild(s)},V=()=>{s.remove()};this.addCommands({cmd:B,undo:V,mustExec:!0})}addUndoableEditor(s){const B=()=>{this.addOrRebuild(s)},V=()=>{s.remove()};this.addCommands({cmd:B,undo:V,mustExec:!1})}getNextId(){return y(this,c).getId()}deserialize(s){switch(s.annotationType){case l.AnnotationEditorType.FREETEXT:return G.FreeTextEditor.deserialize(s,this,y(this,c));case l.AnnotationEditorType.INK:return q.InkEditor.deserialize(s,this,y(this,c))}return null}setSelected(s){y(this,c).setSelected(s)}toggleSelected(s){y(this,c).toggleSelected(s)}isSelected(s){return y(this,c).isSelected(s)}unselect(s){y(this,c).unselect(s)}pointerup(s){const{isMac:B}=l.FeatureTest.platform;if(!(s.button!==0||s.ctrlKey&&B)&&s.target===this.div&&y(this,p)){if(gt(this,p,!1),!y(this,v)){gt(this,v,!0);return}it(this,e,Ee).call(this,s)}}pointerdown(s){const{isMac:B}=l.FeatureTest.platform;if(s.button!==0||s.ctrlKey&&B||s.target!==this.div)return;gt(this,p,!0);const V=y(this,c).getActive();gt(this,v,!V||V.isEmpty())}drop(s){const B=s.dataTransfer.getData("text/plain"),V=y(this,c).getEditor(B);if(!V)return;s.preventDefault(),s.dataTransfer.dropEffect="move",it(this,_,ve).call(this,V);const Y=this.div.getBoundingClientRect(),Q=s.clientX-Y.x,et=s.clientY-Y.y;V.translate(Q-V.startX,et-V.startY),this.moveEditorInDOM(V),V.div.focus()}dragover(s){s.preventDefault()}destroy(){var s,B;((s=y(this,c).getActive())==null?void 0:s.parent)===this&&y(this,c).setActiveEditor(null);for(const V of y(this,P).values())(B=y(this,M))==null||B.removePointerInTextLayer(V.contentDiv),V.setParent(null),V.isAttachedToDOM=!1,V.div.remove();this.div=null,y(this,P).clear(),y(this,c).removeLayer(this)}render({viewport:s}){this.viewport=s,(0,Z.setLayerDimensions)(this.div,s),(0,A.bindEvents)(this,this.div,["dragover","drop"]);for(const B of y(this,c).getEditors(this.pageIndex))this.add(B);this.updateMode()}update({viewport:s}){y(this,c).commitOrRemove(),this.viewport=s,(0,Z.setLayerDimensions)(this.div,{rotation:s.rotation}),this.updateMode()}get pageDimensions(){const{pageWidth:s,pageHeight:B}=this.viewport.rawDims;return[s,B]}};let L=d;M=new WeakMap,v=new WeakMap,N=new WeakMap,w=new WeakMap,P=new WeakMap,p=new WeakMap,f=new WeakMap,c=new WeakMap,_=new WeakSet,ve=function(s){var B;s.parent!==this&&(this.attach(s),(B=s.parent)==null||B.detach(s),s.setParent(this),s.div&&s.isAttachedToDOM&&(s.div.remove(),this.div.append(s.div)))},C=new WeakSet,qe=function(s){switch(y(this,c).getMode()){case l.AnnotationEditorType.FREETEXT:return new G.FreeTextEditor(s);case l.AnnotationEditorType.INK:return new q.InkEditor(s)}return null},e=new WeakSet,Ee=function(s){const B=this.getNextId(),V=it(this,C,qe).call(this,{parent:this,id:B,x:s.offsetX,y:s.offsetY,uiManager:y(this,c)});return V&&this.add(V),V},h=new WeakSet,Se=function(){gt(this,f,!0);for(const s of y(this,P).values())s.isEmpty()&&s.remove();gt(this,f,!1)},Lt(L,"_initialized",!1),i.AnnotationEditorLayer=L},(R,i,U)=>{var Z,L,M,v,N,w,P,p,f,c,$e,E,Ve,m,ze,n,xe;Object.defineProperty(i,"__esModule",{value:!0}),i.FreeTextEditor=void 0;var l=U(1),A=U(5),G=U(4);const o=class extends G.AnnotationEditor{constructor(s){super({...s,name:"freeTextEditor"});tt(this,c);tt(this,E);tt(this,m);tt(this,n);tt(this,Z,this.editorDivBlur.bind(this));tt(this,L,this.editorDivFocus.bind(this));tt(this,M,this.editorDivInput.bind(this));tt(this,v,this.editorDivKeydown.bind(this));tt(this,N,void 0);tt(this,w,"");tt(this,P,`${this.id}-editor`);tt(this,p,!1);tt(this,f,void 0);gt(this,N,s.color||o._defaultColor||G.AnnotationEditor._defaultLineColor),gt(this,f,s.fontSize||o._defaultFontSize)}static initialize(s){this._l10nPromise=new Map(["free_text2_default_content","editor_free_text2_aria_label"].map(V=>[V,s.get(V)]));const B=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(B.getPropertyValue("--freetext-padding"))}static updateDefaultParams(s,B){switch(s){case l.AnnotationEditorParamsType.FREETEXT_SIZE:o._defaultFontSize=B;break;case l.AnnotationEditorParamsType.FREETEXT_COLOR:o._defaultColor=B;break}}updateParams(s,B){switch(s){case l.AnnotationEditorParamsType.FREETEXT_SIZE:it(this,c,$e).call(this,B);break;case l.AnnotationEditorParamsType.FREETEXT_COLOR:it(this,E,Ve).call(this,B);break}}static get defaultPropertiesToUpdate(){return[[l.AnnotationEditorParamsType.FREETEXT_SIZE,o._defaultFontSize],[l.AnnotationEditorParamsType.FREETEXT_COLOR,o._defaultColor||G.AnnotationEditor._defaultLineColor]]}get propertiesToUpdate(){return[[l.AnnotationEditorParamsType.FREETEXT_SIZE,y(this,f)],[l.AnnotationEditorParamsType.FREETEXT_COLOR,y(this,N)]]}getInitialTranslation(){const s=this.parentScale;return[-o._internalPadding*s,-(o._internalPadding+y(this,f))*s]}rebuild(){super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this))}enableEditMode(){this.isInEditMode()||(this.parent.setEditingState(!1),this.parent.updateToolbar(l.AnnotationEditorType.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this.div.draggable=!1,this.div.removeAttribute("aria-activedescendant"),this.editorDiv.addEventListener("keydown",y(this,v)),this.editorDiv.addEventListener("focus",y(this,L)),this.editorDiv.addEventListener("blur",y(this,Z)),this.editorDiv.addEventListener("input",y(this,M)))}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",y(this,P)),this.div.draggable=!0,this.editorDiv.removeEventListener("keydown",y(this,v)),this.editorDiv.removeEventListener("focus",y(this,L)),this.editorDiv.removeEventListener("blur",y(this,Z)),this.editorDiv.removeEventListener("input",y(this,M)),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freeTextEditing"))}focusin(s){super.focusin(s),s.target!==this.editorDiv&&this.editorDiv.focus()}onceAdded(){this.width||(this.enableEditMode(),this.editorDiv.focus())}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent.setEditingState(!0),this.parent.div.classList.add("freeTextEditing"),super.remove()}commit(){this.isInEditMode()&&(super.commit(),y(this,p)||(gt(this,p,!0),this.parent.addUndoableEditor(this)),this.disableEditMode(),gt(this,w,it(this,m,ze).call(this).trimEnd()),it(this,n,xe).call(this))}shouldGetKeyboardEvents(){return this.isInEditMode()}dblclick(s){this.enableEditMode(),this.editorDiv.focus()}keydown(s){s.target===this.div&&s.key==="Enter"&&(this.enableEditMode(),this.editorDiv.focus())}editorDivKeydown(s){o._keyboardManager.exec(this,s)}editorDivFocus(s){this.isEditing=!0}editorDivBlur(s){this.isEditing=!1}editorDivInput(s){this.parent.div.classList.toggle("freeTextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let s,B;this.width&&(s=this.x,B=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",y(this,P)),this.enableEditing(),o._l10nPromise.get("editor_free_text2_aria_label").then(Y=>{var Q;return(Q=this.editorDiv)==null?void 0:Q.setAttribute("aria-label",Y)}),o._l10nPromise.get("free_text2_default_content").then(Y=>{var Q;return(Q=this.editorDiv)==null?void 0:Q.setAttribute("default-content",Y)}),this.editorDiv.contentEditable=!0;const{style:V}=this.editorDiv;if(V.fontSize=`calc(${y(this,f)}px * var(--scale-factor))`,V.color=y(this,N),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),(0,A.bindEvents)(this,this.div,["dblclick","keydown"]),this.width){const[Y,Q]=this.parentDimensions;this.setAt(s*Y,B*Q,this.width*Y,this.height*Q);for(const et of y(this,w).split(`
`)){const ut=document.createElement("div");ut.append(et?document.createTextNode(et):document.createElement("br")),this.editorDiv.append(ut)}this.div.draggable=!0,this.editorDiv.contentEditable=!1}else this.div.draggable=!1,this.editorDiv.contentEditable=!0;return this.div}get contentDiv(){return this.editorDiv}static deserialize(s,B,V){const Y=super.deserialize(s,B,V);return gt(Y,f,s.fontSize),gt(Y,N,l.Util.makeHexColor(...s.color)),gt(Y,w,s.value),Y}serialize(){if(this.isEmpty())return null;const s=o._internalPadding*this.parentScale,B=this.getRect(s,s),V=G.AnnotationEditor._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:y(this,N));return{annotationType:l.AnnotationEditorType.FREETEXT,color:V,fontSize:y(this,f),value:y(this,w),pageIndex:this.pageIndex,rect:B,rotation:this.rotation}}};let q=o;Z=new WeakMap,L=new WeakMap,M=new WeakMap,v=new WeakMap,N=new WeakMap,w=new WeakMap,P=new WeakMap,p=new WeakMap,f=new WeakMap,c=new WeakSet,$e=function(s){const B=Y=>{this.editorDiv.style.fontSize=`calc(${Y}px * var(--scale-factor))`,this.translate(0,-(Y-y(this,f))*this.parentScale),gt(this,f,Y),it(this,n,xe).call(this)},V=y(this,f);this.addCommands({cmd:()=>{B(s)},undo:()=>{B(V)},mustExec:!0,type:l.AnnotationEditorParamsType.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},E=new WeakSet,Ve=function(s){const B=y(this,N);this.addCommands({cmd:()=>{gt(this,N,this.editorDiv.style.color=s)},undo:()=>{gt(this,N,this.editorDiv.style.color=B)},mustExec:!0,type:l.AnnotationEditorParamsType.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},m=new WeakSet,ze=function(){const s=this.editorDiv.getElementsByTagName("div");if(s.length===0)return this.editorDiv.innerText;const B=[];for(const V of s)B.push(V.innerText.replace(/\r\n?|\n/,""));return B.join(`
`)},n=new WeakSet,xe=function(){const[s,B]=this.parentDimensions;let V;if(this.isAttachedToDOM)V=this.div.getBoundingClientRect();else{const{currentLayer:Y,div:Q}=this,et=Q.style.display;Q.style.display="hidden",Y.div.append(this.div),V=Q.getBoundingClientRect(),Q.remove(),Q.style.display=et}this.width=V.width/s,this.height=V.height/B},Lt(q,"_freeTextDefaultContent",""),Lt(q,"_l10nPromise"),Lt(q,"_internalPadding",0),Lt(q,"_defaultColor",null),Lt(q,"_defaultFontSize",10),Lt(q,"_keyboardManager",new A.KeyboardManager([[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],o.prototype.commitOrRemove]])),Lt(q,"_type","freetext"),i.FreeTextEditor=q},(R,i,U)=>{var M,v,N,w,P,p,f,c,_,E,C,m,e,n,h,Xe,d,Ye,s,Ke,V,Je,Q,Te,ut,Qe,ht,Ze,At,tn,_t,zt,u,Pe,x,le,D,ce,W,Zt,I,Ce,a,he,S,we,$,en,J,nn,ot,sn,at,Re,pt,de,vt,te,K,ke;Object.defineProperty(i,"__esModule",{value:!0}),i.InkEditor=void 0,Object.defineProperty(i,"fitCurve",{enumerable:!0,get:function(){return G.fitCurve}});var l=U(1),A=U(4),G=U(30),q=U(5);const Z=16,St=class extends A.AnnotationEditor{constructor(k){super({...k,name:"inkEditor"});tt(this,h);tt(this,d);tt(this,s);tt(this,V);tt(this,Q);tt(this,ut);tt(this,ht);tt(this,At);tt(this,_t);tt(this,u);tt(this,x);tt(this,D);tt(this,W);tt(this,I);tt(this,a);tt(this,$);tt(this,J);tt(this,ot);tt(this,at);tt(this,pt);tt(this,vt);tt(this,K);tt(this,M,0);tt(this,v,0);tt(this,N,0);tt(this,w,this.canvasPointermove.bind(this));tt(this,P,this.canvasPointerleave.bind(this));tt(this,p,this.canvasPointerup.bind(this));tt(this,f,this.canvasPointerdown.bind(this));tt(this,c,!1);tt(this,_,!1);tt(this,E,null);tt(this,C,null);tt(this,m,0);tt(this,e,0);tt(this,n,null);this.color=k.color||null,this.thickness=k.thickness||null,this.opacity=k.opacity||null,this.paths=[],this.bezierPath2D=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0}static initialize(k){this._l10nPromise=new Map(["editor_ink_canvas_aria_label","editor_ink2_aria_label"].map(j=>[j,k.get(j)]))}static updateDefaultParams(k,j){switch(k){case l.AnnotationEditorParamsType.INK_THICKNESS:St._defaultThickness=j;break;case l.AnnotationEditorParamsType.INK_COLOR:St._defaultColor=j;break;case l.AnnotationEditorParamsType.INK_OPACITY:St._defaultOpacity=j/100;break}}updateParams(k,j){switch(k){case l.AnnotationEditorParamsType.INK_THICKNESS:it(this,h,Xe).call(this,j);break;case l.AnnotationEditorParamsType.INK_COLOR:it(this,d,Ye).call(this,j);break;case l.AnnotationEditorParamsType.INK_OPACITY:it(this,s,Ke).call(this,j);break}}static get defaultPropertiesToUpdate(){return[[l.AnnotationEditorParamsType.INK_THICKNESS,St._defaultThickness],[l.AnnotationEditorParamsType.INK_COLOR,St._defaultColor||A.AnnotationEditor._defaultLineColor],[l.AnnotationEditorParamsType.INK_OPACITY,Math.round(St._defaultOpacity*100)]]}get propertiesToUpdate(){return[[l.AnnotationEditorParamsType.INK_THICKNESS,this.thickness||St._defaultThickness],[l.AnnotationEditorParamsType.INK_COLOR,this.color||St._defaultColor||A.AnnotationEditor._defaultLineColor],[l.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*(this.opacity??St._defaultOpacity))]]}rebuild(){super.rebuild(),this.div!==null&&(this.canvas||(it(this,x,le).call(this),it(this,D,ce).call(this)),this.isAttachedToDOM||(this.parent.add(this),it(this,W,Zt).call(this)),it(this,vt,te).call(this))}remove(){this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,y(this,C).disconnect(),gt(this,C,null),super.remove())}setParent(k){!this.parent&&k?this._uiManager.removeShouldRescale(this):this.parent&&k===null&&this._uiManager.addShouldRescale(this),super.setParent(k)}onScaleChanging(){const[k,j]=this.parentDimensions,ct=this.width*k,bt=this.height*j;this.setDimensions(ct,bt)}enableEditMode(){y(this,c)||this.canvas===null||(super.enableEditMode(),this.div.draggable=!1,this.canvas.addEventListener("pointerdown",y(this,f)),this.canvas.addEventListener("pointerup",y(this,p)))}disableEditMode(){!this.isInEditMode()||this.canvas===null||(super.disableEditMode(),this.div.draggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerdown",y(this,f)),this.canvas.removeEventListener("pointerup",y(this,p)))}onceAdded(){this.div.draggable=!this.isEmpty()}isEmpty(){return this.paths.length===0||this.paths.length===1&&this.paths[0].length===0}commit(){y(this,c)||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),gt(this,c,!0),this.div.classList.add("disabled"),it(this,vt,te).call(this,!0),this.parent.addInkEditorIfNeeded(!0),this.parent.moveEditorInDOM(this),this.div.focus({preventScroll:!0}))}focusin(k){super.focusin(k),this.enableEditMode()}canvasPointerdown(k){k.button!==0||!this.isInEditMode()||y(this,c)||(this.setInForeground(),k.type!=="mouse"&&this.div.focus(),k.stopPropagation(),this.canvas.addEventListener("pointerleave",y(this,P)),this.canvas.addEventListener("pointermove",y(this,w)),it(this,ut,Qe).call(this,k.offsetX,k.offsetY))}canvasPointermove(k){k.stopPropagation(),it(this,ht,Ze).call(this,k.offsetX,k.offsetY)}canvasPointerup(k){k.button===0&&this.isInEditMode()&&this.currentPath.length!==0&&(k.stopPropagation(),it(this,u,Pe).call(this,k),this.setInBackground())}canvasPointerleave(k){it(this,u,Pe).call(this,k),this.setInBackground()}render(){if(this.div)return this.div;let k,j;this.width&&(k=this.x,j=this.y),super.render(),St._l10nPromise.get("editor_ink2_aria_label").then(kt=>{var Rt;return(Rt=this.div)==null?void 0:Rt.setAttribute("aria-label",kt)});const[ct,bt,Pt,wt]=it(this,V,Je).call(this);if(this.setAt(ct,bt,0,0),this.setDims(Pt,wt),it(this,x,le).call(this),this.width){const[kt,Rt]=this.parentDimensions;this.setAt(k*kt,j*Rt,this.width*kt,this.height*Rt),gt(this,_,!0),it(this,W,Zt).call(this),this.setDims(this.width*kt,this.height*Rt),it(this,_t,zt).call(this),it(this,K,ke).call(this),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return it(this,D,ce).call(this),this.div}setDimensions(k,j){const ct=Math.round(k),bt=Math.round(j);if(y(this,m)===ct&&y(this,e)===bt)return;gt(this,m,ct),gt(this,e,bt),this.canvas.style.visibility="hidden",y(this,M)&&Math.abs(y(this,M)-k/j)>.01&&(j=Math.ceil(k/y(this,M)),this.setDims(k,j));const[Pt,wt]=this.parentDimensions;this.width=k/Pt,this.height=j/wt,y(this,c)&&it(this,I,Ce).call(this,k,j),it(this,W,Zt).call(this),it(this,_t,zt).call(this),this.canvas.style.visibility="visible",this.fixDims()}static deserialize(k,j,ct){var Dt,It;const bt=super.deserialize(k,j,ct);bt.thickness=k.thickness,bt.color=l.Util.makeHexColor(...k.color),bt.opacity=k.opacity;const[Pt,wt]=bt.pageDimensions,kt=bt.width*Pt,Rt=bt.height*wt,Ot=bt.parentScale,Ct=k.thickness/2;gt(bt,M,kt/Rt),gt(bt,c,!0),gt(bt,m,Math.round(kt)),gt(bt,e,Math.round(Rt));for(const{bezier:Ft}of k.paths){const Bt=[];bt.paths.push(Bt);let Wt=Ot*(Ft[0]-Ct),Gt=Ot*(Rt-Ft[1]-Ct);for(let jt=2,Ut=Ft.length;jt<Ut;jt+=6){const $t=Ot*(Ft[jt]-Ct),Xt=Ot*(Rt-Ft[jt+1]-Ct),se=Ot*(Ft[jt+2]-Ct),ie=Ot*(Rt-Ft[jt+3]-Ct),Oe=Ot*(Ft[jt+4]-Ct),De=Ot*(Rt-Ft[jt+5]-Ct);Bt.push([[Wt,Gt],[$t,Xt],[se,ie],[Oe,De]]),Wt=Oe,Gt=De}const qt=it(this,S,we).call(this,Bt);bt.bezierPath2D.push(qt)}const Nt=it(Dt=bt,at,Re).call(Dt);return gt(bt,N,Math.max(Z,Nt[2]-Nt[0])),gt(bt,v,Math.max(Z,Nt[3]-Nt[1])),it(It=bt,I,Ce).call(It,kt,Rt),bt}serialize(){if(this.isEmpty())return null;const k=this.getRect(0,0),j=this.rotation%180===0?k[3]-k[1]:k[2]-k[0],ct=A.AnnotationEditor._colorManager.convert(this.ctx.strokeStyle);return{annotationType:l.AnnotationEditorType.INK,color:ct,thickness:this.thickness,opacity:this.opacity,paths:it(this,$,en).call(this,this.scaleFactor/this.parentScale,this.translationX,this.translationY,j),pageIndex:this.pageIndex,rect:k,rotation:this.rotation}}};let L=St;M=new WeakMap,v=new WeakMap,N=new WeakMap,w=new WeakMap,P=new WeakMap,p=new WeakMap,f=new WeakMap,c=new WeakMap,_=new WeakMap,E=new WeakMap,C=new WeakMap,m=new WeakMap,e=new WeakMap,n=new WeakMap,h=new WeakSet,Xe=function(k){const j=this.thickness;this.addCommands({cmd:()=>{this.thickness=k,it(this,vt,te).call(this)},undo:()=>{this.thickness=j,it(this,vt,te).call(this)},mustExec:!0,type:l.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})},d=new WeakSet,Ye=function(k){const j=this.color;this.addCommands({cmd:()=>{this.color=k,it(this,_t,zt).call(this)},undo:()=>{this.color=j,it(this,_t,zt).call(this)},mustExec:!0,type:l.AnnotationEditorParamsType.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})},s=new WeakSet,Ke=function(k){k/=100;const j=this.opacity;this.addCommands({cmd:()=>{this.opacity=k,it(this,_t,zt).call(this)},undo:()=>{this.opacity=j,it(this,_t,zt).call(this)},mustExec:!0,type:l.AnnotationEditorParamsType.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})},V=new WeakSet,Je=function(){const{parentRotation:k,parentDimensions:[j,ct]}=this;switch(k){case 90:return[0,ct,ct,j];case 180:return[j,ct,j,ct];case 270:return[j,0,ct,j];default:return[0,0,j,ct]}},Q=new WeakSet,Te=function(){const{ctx:k,color:j,opacity:ct,thickness:bt,parentScale:Pt,scaleFactor:wt}=this;k.lineWidth=bt*Pt/wt,k.lineCap="round",k.lineJoin="round",k.miterLimit=10,k.strokeStyle=`${j}${(0,q.opacityToHex)(ct)}`},ut=new WeakSet,Qe=function(k,j){this.isEditing=!0,y(this,_)||(gt(this,_,!0),it(this,W,Zt).call(this),this.thickness||(this.thickness=St._defaultThickness),this.color||(this.color=St._defaultColor||A.AnnotationEditor._defaultLineColor),this.opacity??(this.opacity=St._defaultOpacity)),this.currentPath.push([k,j]),gt(this,E,null),it(this,Q,Te).call(this),this.ctx.beginPath(),this.ctx.moveTo(k,j),gt(this,n,()=>{y(this,n)&&(y(this,E)&&(this.isEmpty()?(this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height)):it(this,_t,zt).call(this),this.ctx.lineTo(...y(this,E)),gt(this,E,null),this.ctx.stroke()),window.requestAnimationFrame(y(this,n)))}),window.requestAnimationFrame(y(this,n))},ht=new WeakSet,Ze=function(k,j){const[ct,bt]=this.currentPath.at(-1);k===ct&&j===bt||(this.currentPath.push([k,j]),gt(this,E,[k,j]))},At=new WeakSet,tn=function(k,j){var Ot;this.ctx.closePath(),gt(this,n,null),k=Math.min(Math.max(k,0),this.canvas.width),j=Math.min(Math.max(j,0),this.canvas.height);const[ct,bt]=this.currentPath.at(-1);(k!==ct||j!==bt)&&this.currentPath.push([k,j]);let Pt;if(this.currentPath.length!==1)Pt=(0,G.fitCurve)(this.currentPath,30,null);else{const Ct=[k,j];Pt=[[Ct,Ct.slice(),Ct.slice(),Ct]]}const wt=it(Ot=St,S,we).call(Ot,Pt);this.currentPath.length=0;const kt=()=>{this.paths.push(Pt),this.bezierPath2D.push(wt),this.rebuild()},Rt=()=>{this.paths.pop(),this.bezierPath2D.pop(),this.paths.length===0?this.remove():(this.canvas||(it(this,x,le).call(this),it(this,D,ce).call(this)),it(this,vt,te).call(this))};this.addCommands({cmd:kt,undo:Rt,mustExec:!0})},_t=new WeakSet,zt=function(){if(this.isEmpty()){it(this,a,he).call(this);return}it(this,Q,Te).call(this);const{canvas:k,ctx:j}=this;j.setTransform(1,0,0,1,0,0),j.clearRect(0,0,k.width,k.height),it(this,a,he).call(this);for(const ct of this.bezierPath2D)j.stroke(ct)},u=new WeakSet,Pe=function(k){it(this,At,tn).call(this,k.offsetX,k.offsetY),this.canvas.removeEventListener("pointerleave",y(this,P)),this.canvas.removeEventListener("pointermove",y(this,w)),this.addToAnnotationStorage()},x=new WeakSet,le=function(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",St._l10nPromise.get("editor_ink_canvas_aria_label").then(k=>{var j;return(j=this.canvas)==null?void 0:j.setAttribute("aria-label",k)}),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")},D=new WeakSet,ce=function(){gt(this,C,new ResizeObserver(k=>{const j=k[0].contentRect;j.width&&j.height&&this.setDimensions(j.width,j.height)})),y(this,C).observe(this.div)},W=new WeakSet,Zt=function(){if(!y(this,_))return;const[k,j]=this.parentDimensions;this.canvas.width=Math.ceil(this.width*k),this.canvas.height=Math.ceil(this.height*j),it(this,a,he).call(this)},I=new WeakSet,Ce=function(k,j){const ct=it(this,pt,de).call(this),bt=(k-ct)/y(this,N),Pt=(j-ct)/y(this,v);this.scaleFactor=Math.min(bt,Pt)},a=new WeakSet,he=function(){const k=it(this,pt,de).call(this)/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+k,this.translationY*this.scaleFactor+k)},S=new WeakSet,we=function(k){const j=new Path2D;for(let ct=0,bt=k.length;ct<bt;ct++){const[Pt,wt,kt,Rt]=k[ct];ct===0&&j.moveTo(...Pt),j.bezierCurveTo(wt[0],wt[1],kt[0],kt[1],Rt[0],Rt[1])}return j},$=new WeakSet,en=function(k,j,ct,bt){const wt=[],kt=this.thickness/2;let Rt,Ot;for(const Ct of this.paths){Rt=[],Ot=[];for(let Nt=0,Dt=Ct.length;Nt<Dt;Nt++){const[It,Ft,Bt,Wt]=Ct[Nt],Gt=k*(It[0]+j)+kt,qt=bt-k*(It[1]+ct)-kt,jt=k*(Ft[0]+j)+kt,Ut=bt-k*(Ft[1]+ct)-kt,$t=k*(Bt[0]+j)+kt,Xt=bt-k*(Bt[1]+ct)-kt,se=k*(Wt[0]+j)+kt,ie=bt-k*(Wt[1]+ct)-kt;Nt===0&&(Rt.push(Gt,qt),Ot.push(Gt,qt)),Rt.push(jt,Ut,$t,Xt,se,ie),it(this,J,nn).call(this,Gt,qt,jt,Ut,$t,Xt,se,ie,4,Ot)}wt.push({bezier:Rt,points:Ot})}return wt},J=new WeakSet,nn=function(k,j,ct,bt,Pt,wt,kt,Rt,Ot,Ct){if(it(this,ot,sn).call(this,k,j,ct,bt,Pt,wt,kt,Rt)){Ct.push(kt,Rt);return}for(let Nt=1;Nt<Ot-1;Nt++){const Dt=Nt/Ot,It=1-Dt;let Ft=Dt*k+It*ct,Bt=Dt*j+It*bt,Wt=Dt*ct+It*Pt,Gt=Dt*bt+It*wt;const qt=Dt*Pt+It*kt,jt=Dt*wt+It*Rt;Ft=Dt*Ft+It*Wt,Bt=Dt*Bt+It*Gt,Wt=Dt*Wt+It*qt,Gt=Dt*Gt+It*jt,Ft=Dt*Ft+It*Wt,Bt=Dt*Bt+It*Gt,Ct.push(Ft,Bt)}Ct.push(kt,Rt)},ot=new WeakSet,sn=function(k,j,ct,bt,Pt,wt,kt,Rt){const Ct=(3*ct-2*k-kt)**2,Nt=(3*bt-2*j-Rt)**2,Dt=(3*Pt-k-2*kt)**2,It=(3*wt-j-2*Rt)**2;return Math.max(Ct,Dt)+Math.max(Nt,It)<=10},at=new WeakSet,Re=function(){let k=1/0,j=-1/0,ct=1/0,bt=-1/0;for(const Pt of this.paths)for(const[wt,kt,Rt,Ot]of Pt){const Ct=l.Util.bezierBoundingBox(...wt,...kt,...Rt,...Ot);k=Math.min(k,Ct[0]),ct=Math.min(ct,Ct[1]),j=Math.max(j,Ct[2]),bt=Math.max(bt,Ct[3])}return[k,ct,j,bt]},pt=new WeakSet,de=function(){return y(this,c)?Math.ceil(this.thickness*this.parentScale):0},vt=new WeakSet,te=function(k=!1){if(this.isEmpty())return;if(!y(this,c)){it(this,_t,zt).call(this);return}const j=it(this,at,Re).call(this),ct=it(this,pt,de).call(this);gt(this,N,Math.max(Z,j[2]-j[0])),gt(this,v,Math.max(Z,j[3]-j[1]));const bt=Math.ceil(ct+y(this,N)*this.scaleFactor),Pt=Math.ceil(ct+y(this,v)*this.scaleFactor),[wt,kt]=this.parentDimensions;this.width=bt/wt,this.height=Pt/kt,gt(this,M,bt/Pt),it(this,K,ke).call(this);const Rt=this.translationX,Ot=this.translationY;this.translationX=-j[0],this.translationY=-j[1],it(this,W,Zt).call(this),it(this,_t,zt).call(this),gt(this,m,bt),gt(this,e,Pt),this.setDims(bt,Pt);const Ct=k?ct/this.scaleFactor/2:0;this.translate(Rt-this.translationX-Ct,Ot-this.translationY-Ct)},K=new WeakSet,ke=function(){const{style:k}=this.div;y(this,M)>=1?(k.minHeight=`${Z}px`,k.minWidth=`${Math.round(y(this,M)*Z)}px`):(k.minWidth=`${Z}px`,k.minHeight=`${Math.round(Z/y(this,M))}px`)},tt(L,S),Lt(L,"_defaultColor",null),Lt(L,"_defaultOpacity",1),Lt(L,"_defaultThickness",1),Lt(L,"_l10nPromise"),Lt(L,"_type","ink"),i.InkEditor=L},(R,i,U)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.fitCurve=void 0;const l=U(31);i.fitCurve=l},R=>{function i(p,f,c){if(!Array.isArray(p))throw new TypeError("First argument should be an array");if(p.forEach(m=>{if(!Array.isArray(m)||m.some(e=>typeof e!="number")||m.length!==p[0].length)throw Error("Each point should be an array of numbers. Each point should have the same amount of numbers.")}),p=p.filter((m,e)=>e===0||!m.every((n,h)=>n===p[e-1][h])),p.length<2)return[];const _=p.length,E=N(p[1],p[0]),C=N(p[_-2],p[_-1]);return U(p,E,C,f,c)}function U(p,f,c,_,E){var m,e,n,h,o,d,F,s,B,V,Y,Q,et;if(p.length===2)return Q=w.vectorLen(w.subtract(p[0],p[1]))/3,m=[p[0],w.addArrays(p[0],w.mulItems(f,Q)),w.addArrays(p[1],w.mulItems(c,Q)),p[1]],[m];if(e=Z(p),[m,h,d]=l(p,e,e,f,c,E),h===0||h<_)return[m];if(h<_*_)for(n=e,o=h,F=d,et=0;et<20;et++){if(n=G(m,p,n),[m,h,d]=l(p,e,n,f,c,E),h<_)return[m];if(d===F){let ut=h/o;if(ut>.9999&&ut<1.0001)break}o=h,F=d}return Y=[],s=w.subtract(p[d-1],p[d+1]),s.every(ut=>ut===0)&&(s=w.subtract(p[d-1],p[d]),[s[0],s[1]]=[-s[1],s[0]]),B=w.normalize(s),V=w.mulItems(B,-1),Y=Y.concat(U(p.slice(0,d+1),f,B,_,E)),Y=Y.concat(U(p.slice(d),V,c,_,E)),Y}function l(p,f,c,_,E,C){var m,e,n;return m=A(p,c,_,E),[e,n]=L(p,m,f),C&&C({bez:m,points:p,params:f,maxErr:e,maxPoint:n}),[m,e,n]}function A(p,f,c,_){var E,C,m,e,n,h,o,d,F,s,B,V,Y,Q,et,ut,lt,ht=p[0],mt=p[p.length-1];for(E=[ht,null,null,mt],C=w.zeros_Xx2x2(f.length),Y=0,Q=f.length;Y<Q;Y++)ut=f[Y],lt=1-ut,m=C[Y],m[0]=w.mulItems(c,3*ut*(lt*lt)),m[1]=w.mulItems(_,3*lt*(ut*ut));for(e=[[0,0],[0,0]],n=[0,0],Y=0,Q=p.length;Y<Q;Y++)ut=f[Y],m=C[Y],e[0][0]+=w.dot(m[0],m[0]),e[0][1]+=w.dot(m[0],m[1]),e[1][0]+=w.dot(m[0],m[1]),e[1][1]+=w.dot(m[1],m[1]),et=w.subtract(p[Y],P.q([ht,ht,mt,mt],ut)),n[0]+=w.dot(m[0],et),n[1]+=w.dot(m[1],et);return h=e[0][0]*e[1][1]-e[1][0]*e[0][1],o=e[0][0]*n[1]-e[1][0]*n[0],d=n[0]*e[1][1]-n[1]*e[0][1],F=h===0?0:d/h,s=h===0?0:o/h,V=w.vectorLen(w.subtract(ht,mt)),B=1e-6*V,F<B||s<B?(E[1]=w.addArrays(ht,w.mulItems(c,V/3)),E[2]=w.addArrays(mt,w.mulItems(_,V/3))):(E[1]=w.addArrays(ht,w.mulItems(c,F)),E[2]=w.addArrays(mt,w.mulItems(_,s))),E}function G(p,f,c){return c.map((_,E)=>q(p,f[E],_))}function q(p,f,c){var _=w.subtract(P.q(p,c),f),E=P.qprime(p,c),C=w.mulMatrix(_,E),m=w.sum(w.squareItems(E))+2*w.mulMatrix(_,P.qprimeprime(p,c));return m===0?c:c-C/m}function Z(p){var f=[],c,_,E;return p.forEach((C,m)=>{c=m?_+w.vectorLen(w.subtract(C,E)):0,f.push(c),_=c,E=C}),f=f.map(C=>C/_),f}function L(p,f,c){var _,E,C,m,e,n,h,o;E=0,C=Math.floor(p.length/2);const d=M(f,10);for(e=0,n=p.length;e<n;e++)h=p[e],o=v(f,c[e],d,10),m=w.subtract(P.q(f,o),h),_=m[0]*m[0]+m[1]*m[1],_>E&&(E=_,C=e);return[E,C]}var M=function(p,f){for(var c,_=[0],E=p[0],C=0,m=1;m<=f;m++)c=P.q(p,m/f),C+=w.vectorLen(w.subtract(c,E)),_.push(C),E=c;return _=_.map(e=>e/C),_};function v(p,f,c,_){if(f<0)return 0;if(f>1)return 1;for(var E,C,m,e,n,h=1;h<=_;h++)if(f<=c[h]){e=(h-1)/_,m=h/_,C=c[h-1],E=c[h],n=(f-C)/(E-C)*(m-e)+e;break}return n}function N(p,f){return w.normalize(w.subtract(p,f))}class w{static zeros_Xx2x2(f){for(var c=[];f--;)c.push([0,0]);return c}static mulItems(f,c){return f.map(_=>_*c)}static mulMatrix(f,c){return f.reduce((_,E,C)=>_+E*c[C],0)}static subtract(f,c){return f.map((_,E)=>_-c[E])}static addArrays(f,c){return f.map((_,E)=>_+c[E])}static addItems(f,c){return f.map(_=>_+c)}static sum(f){return f.reduce((c,_)=>c+_)}static dot(f,c){return w.mulMatrix(f,c)}static vectorLen(f){return Math.hypot(...f)}static divItems(f,c){return f.map(_=>_/c)}static squareItems(f){return f.map(c=>c*c)}static normalize(f){return this.divItems(f,this.vectorLen(f))}}class P{static q(f,c){var _=1-c,E=w.mulItems(f[0],_*_*_),C=w.mulItems(f[1],3*_*_*c),m=w.mulItems(f[2],3*_*c*c),e=w.mulItems(f[3],c*c*c);return w.addArrays(w.addArrays(E,C),w.addArrays(m,e))}static qprime(f,c){var _=1-c,E=w.mulItems(w.subtract(f[1],f[0]),3*_*_),C=w.mulItems(w.subtract(f[2],f[1]),6*_*c),m=w.mulItems(w.subtract(f[3],f[2]),3*c*c);return w.addArrays(w.addArrays(E,C),m)}static qprimeprime(f,c){return w.addArrays(w.mulItems(w.addArrays(w.subtract(f[2],w.mulItems(f[1],2)),f[0]),6*(1-c)),w.mulItems(w.addArrays(w.subtract(f[3],w.mulItems(f[2],2)),f[1]),6*c))}}R.exports=i,R.exports.fitCubic=U,R.exports.createTangent=N},(R,i,U)=>{var _t,Kt,u,rn,H,Fe,X,Me;Object.defineProperty(i,"__esModule",{value:!0}),i.AnnotationLayer=void 0;var l=U(1),A=U(6),G=U(3),q=U(33),Z=U(34);const L=1e3,M=9,v=new WeakSet;function N(I){return{width:I[2]-I[0],height:I[3]-I[1]}}class w{static create(t){switch(t.data.annotationType){case l.AnnotationType.LINK:return new p(t);case l.AnnotationType.TEXT:return new f(t);case l.AnnotationType.WIDGET:switch(t.data.fieldType){case"Tx":return new _(t);case"Btn":return t.data.radioButton?new C(t):t.data.checkBox?new E(t):new m(t);case"Ch":return new e(t)}return new c(t);case l.AnnotationType.POPUP:return new n(t);case l.AnnotationType.FREETEXT:return new o(t);case l.AnnotationType.LINE:return new d(t);case l.AnnotationType.SQUARE:return new F(t);case l.AnnotationType.CIRCLE:return new s(t);case l.AnnotationType.POLYLINE:return new B(t);case l.AnnotationType.CARET:return new Y(t);case l.AnnotationType.INK:return new Q(t);case l.AnnotationType.POLYGON:return new V(t);case l.AnnotationType.HIGHLIGHT:return new et(t);case l.AnnotationType.UNDERLINE:return new ut(t);case l.AnnotationType.SQUIGGLY:return new lt(t);case l.AnnotationType.STRIKEOUT:return new ht(t);case l.AnnotationType.STAMP:return new mt(t);case l.AnnotationType.FILEATTACHMENT:return new At(t);default:return new P(t)}}}class P{constructor(t,{isRenderable:a=!1,ignoreBorder:b=!1,createQuadrilaterals:S=!1}={}){this.isRenderable=a,this.data=t.data,this.layer=t.layer,this.page=t.page,this.viewport=t.viewport,this.linkService=t.linkService,this.downloadManager=t.downloadManager,this.imageResourcesPath=t.imageResourcesPath,this.renderForms=t.renderForms,this.svgFactory=t.svgFactory,this.annotationStorage=t.annotationStorage,this.enableScripting=t.enableScripting,this.hasJSActions=t.hasJSActions,this._fieldObjects=t.fieldObjects,a&&(this.container=this._createContainer(b)),S&&(this.quadrilaterals=this._createQuadrilaterals(b))}_createContainer(t=!1){const{data:a,page:b,viewport:S}=this,T=document.createElement("section");T.setAttribute("data-annotation-id",a.id),a.noRotate&&T.classList.add("norotate");const{pageWidth:$,pageHeight:st,pageX:J,pageY:rt}=S.rawDims,{width:ot,height:nt}=N(a.rect),at=l.Util.normalizeRect([a.rect[0],b.view[3]-a.rect[1]+b.view[1],a.rect[2],b.view[3]-a.rect[3]+b.view[1]]);if(!t&&a.borderStyle.width>0){T.style.borderWidth=`${a.borderStyle.width}px`;const pt=a.borderStyle.horizontalCornerRadius,xt=a.borderStyle.verticalCornerRadius;if(pt>0||xt>0){const Tt=`calc(${pt}px * var(--scale-factor)) / calc(${xt}px * var(--scale-factor))`;T.style.borderRadius=Tt}else if(this instanceof C){const Tt=`calc(${ot}px * var(--scale-factor)) / calc(${nt}px * var(--scale-factor))`;T.style.borderRadius=Tt}switch(a.borderStyle.style){case l.AnnotationBorderStyleType.SOLID:T.style.borderStyle="solid";break;case l.AnnotationBorderStyleType.DASHED:T.style.borderStyle="dashed";break;case l.AnnotationBorderStyleType.BEVELED:(0,l.warn)("Unimplemented border style: beveled");break;case l.AnnotationBorderStyleType.INSET:(0,l.warn)("Unimplemented border style: inset");break;case l.AnnotationBorderStyleType.UNDERLINE:T.style.borderBottomStyle="solid";break}const vt=a.borderColor||null;vt?T.style.borderColor=l.Util.makeHexColor(vt[0]|0,vt[1]|0,vt[2]|0):T.style.borderWidth=0}T.style.left=`${100*(at[0]-J)/$}%`,T.style.top=`${100*(at[1]-rt)/st}%`;const{rotation:ft}=a;return a.hasOwnCanvas||ft===0?(T.style.width=`${100*ot/$}%`,T.style.height=`${100*nt/st}%`):this.setRotation(ft,T),T}setRotation(t,a=this.container){const{pageWidth:b,pageHeight:S}=this.viewport.rawDims,{width:T,height:$}=N(this.data.rect);let st,J;t%180===0?(st=100*T/b,J=100*$/S):(st=100*$/b,J=100*T/S),a.style.width=`${st}%`,a.style.height=`${J}%`,a.setAttribute("data-main-rotation",(360-t)%360)}get _commonActions(){const t=(a,b,S)=>{const T=S.detail[a];S.target.style[b]=q.ColorConverters[`${T[0]}_HTML`](T.slice(1))};return(0,l.shadow)(this,"_commonActions",{display:a=>{const b=a.detail.display%2===1;this.container.style.visibility=b?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{hidden:b,print:a.detail.display===0||a.detail.display===3})},print:a=>{this.annotationStorage.setValue(this.data.id,{print:a.detail.print})},hidden:a=>{this.container.style.visibility=a.detail.hidden?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{hidden:a.detail.hidden})},focus:a=>{setTimeout(()=>a.target.focus({preventScroll:!1}),0)},userName:a=>{a.target.title=a.detail.userName},readonly:a=>{a.detail.readonly?a.target.setAttribute("readonly",""):a.target.removeAttribute("readonly")},required:a=>{this._setRequired(a.target,a.detail.required)},bgColor:a=>{t("bgColor","backgroundColor",a)},fillColor:a=>{t("fillColor","backgroundColor",a)},fgColor:a=>{t("fgColor","color",a)},textColor:a=>{t("textColor","color",a)},borderColor:a=>{t("borderColor","borderColor",a)},strokeColor:a=>{t("strokeColor","borderColor",a)},rotation:a=>{const b=a.detail.rotation;this.setRotation(b),this.annotationStorage.setValue(this.data.id,{rotation:b})}})}_dispatchEventFromSandbox(t,a){const b=this._commonActions;for(const S of Object.keys(a.detail)){const T=t[S]||b[S];T==null||T(a)}}_setDefaultPropertiesFromJS(t){if(!this.enableScripting)return;const a=this.annotationStorage.getRawValue(this.data.id);if(!a)return;const b=this._commonActions;for(const[S,T]of Object.entries(a)){const $=b[S];if($){const st={detail:{[S]:T},target:t};$(st),delete a[S]}}}_createQuadrilaterals(t=!1){if(!this.data.quadPoints)return null;const a=[],b=this.data.rect;for(const S of this.data.quadPoints)this.data.rect=[S[2].x,S[2].y,S[1].x,S[1].y],a.push(this._createContainer(t));return this.data.rect=b,a}_createPopup(t,a){let b=this.container;this.quadrilaterals&&(t||(t=this.quadrilaterals),b=this.quadrilaterals[0]),t||(t=document.createElement("div"),t.classList.add("popupTriggerArea"),b.append(t));const T=new h({container:b,trigger:t,color:a.color,titleObj:a.titleObj,modificationDate:a.modificationDate,contentsObj:a.contentsObj,richText:a.richText,hideWrapper:!0}).render();T.style.left="100%",b.append(T)}_renderQuadrilaterals(t){for(const a of this.quadrilaterals)a.classList.add(t);return this.quadrilaterals}render(){(0,l.unreachable)("Abstract method `AnnotationElement.render` called")}_getElementsByName(t,a=null){const b=[];if(this._fieldObjects){const S=this._fieldObjects[t];if(S)for(const{page:T,id:$,exportValues:st}of S){if(T===-1||$===a)continue;const J=typeof st=="string"?st:null,rt=document.querySelector(`[data-element-id="${$}"]`);if(rt&&!v.has(rt)){(0,l.warn)(`_getElementsByName - element not allowed: ${$}`);continue}b.push({id:$,exportValue:J,domElement:rt})}return b}for(const S of document.getElementsByName(t)){const{exportValue:T}=S,$=S.getAttribute("data-element-id");$!==a&&v.has(S)&&b.push({id:$,exportValue:T,domElement:S})}return b}}class p extends P{constructor(a,b=null){super(a,{isRenderable:!0,ignoreBorder:!!(b!=null&&b.ignoreBorder),createQuadrilaterals:!0});tt(this,_t);tt(this,u);this.isTooltipOnly=a.data.isTooltipOnly}render(){const{data:a,linkService:b}=this,S=document.createElement("a");S.setAttribute("data-element-id",a.id);let T=!1;return a.url?(b.addLinkAttributes(S,a.url,a.newWindow),T=!0):a.action?(this._bindNamedAction(S,a.action),T=!0):a.attachment?(this._bindAttachment(S,a.attachment),T=!0):a.setOCGState?(it(this,u,rn).call(this,S,a.setOCGState),T=!0):a.dest?(this._bindLink(S,a.dest),T=!0):(a.actions&&(a.actions.Action||a.actions["Mouse Up"]||a.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(S,a),T=!0),a.resetForm?(this._bindResetFormAction(S,a.resetForm),T=!0):this.isTooltipOnly&&!T&&(this._bindLink(S,""),T=!0)),this.quadrilaterals?this._renderQuadrilaterals("linkAnnotation").map(($,st)=>{const J=st===0?S:S.cloneNode();return $.append(J),$}):(this.container.classList.add("linkAnnotation"),T&&this.container.append(S),this.container)}_bindLink(a,b){a.href=this.linkService.getDestinationHash(b),a.onclick=()=>(b&&this.linkService.goToDestination(b),!1),(b||b==="")&&it(this,_t,Kt).call(this)}_bindNamedAction(a,b){a.href=this.linkService.getAnchorUrl(""),a.onclick=()=>(this.linkService.executeNamedAction(b),!1),it(this,_t,Kt).call(this)}_bindAttachment(a,b){a.href=this.linkService.getAnchorUrl(""),a.onclick=()=>{var S;return(S=this.downloadManager)==null||S.openOrDownloadData(this.container,b.content,b.filename),!1},it(this,_t,Kt).call(this)}_bindJSAction(a,b){a.href=this.linkService.getAnchorUrl("");const S=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const T of Object.keys(b.actions)){const $=S.get(T);$&&(a[$]=()=>{var st;return(st=this.linkService.eventBus)==null||st.dispatch("dispatcheventinsandbox",{source:this,detail:{id:b.id,name:T}}),!1})}a.onclick||(a.onclick=()=>!1),it(this,_t,Kt).call(this)}_bindResetFormAction(a,b){const S=a.onclick;if(S||(a.href=this.linkService.getAnchorUrl("")),it(this,_t,Kt).call(this),!this._fieldObjects){(0,l.warn)('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),S||(a.onclick=()=>!1);return}a.onclick=()=>{var nt;S==null||S();const{fields:T,refs:$,include:st}=b,J=[];if(T.length!==0||$.length!==0){const at=new Set($);for(const ft of T){const pt=this._fieldObjects[ft]||[];for(const{id:xt}of pt)at.add(xt)}for(const ft of Object.values(this._fieldObjects))for(const pt of ft)at.has(pt.id)===st&&J.push(pt)}else for(const at of Object.values(this._fieldObjects))J.push(...at);const rt=this.annotationStorage,ot=[];for(const at of J){const{id:ft}=at;switch(ot.push(ft),at.type){case"text":{const xt=at.defaultValue||"";rt.setValue(ft,{value:xt});break}case"checkbox":case"radiobutton":{const xt=at.defaultValue===at.exportValues;rt.setValue(ft,{value:xt});break}case"combobox":case"listbox":{const xt=at.defaultValue||"";rt.setValue(ft,{value:xt});break}default:continue}const pt=document.querySelector(`[data-element-id="${ft}"]`);if(pt){if(!v.has(pt)){(0,l.warn)(`_bindResetFormAction - element not allowed: ${ft}`);continue}}else continue;pt.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((nt=this.linkService.eventBus)==null||nt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:ot,name:"ResetForm"}})),!1}}}_t=new WeakSet,Kt=function(){this.container.setAttribute("data-internal-link","")},u=new WeakSet,rn=function(a,b){a.href=this.linkService.getAnchorUrl(""),a.onclick=()=>(this.linkService.executeSetOCGState(b),!1),it(this,_t,Kt).call(this)};class f extends P{constructor(t){var b,S,T;const a=!!(t.data.hasPopup||(b=t.data.titleObj)!=null&&b.str||(S=t.data.contentsObj)!=null&&S.str||(T=t.data.richText)!=null&&T.str);super(t,{isRenderable:a})}render(){this.container.classList.add("textAnnotation");const t=document.createElement("img");return t.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",t.alt="[{{type}} Annotation]",t.dataset.l10nId="text_annotation_type",t.dataset.l10nArgs=JSON.stringify({type:this.data.name}),this.data.hasPopup||this._createPopup(t,this.data),this.container.append(t),this.container}}class c extends P{render(){return this.data.alternativeText&&(this.container.title=this.data.alternativeText),this.container}showElementAndHideCanvas(t){var a;this.data.hasOwnCanvas&&(((a=t.previousSibling)==null?void 0:a.nodeName)==="CANVAS"&&(t.previousSibling.hidden=!0),t.hidden=!1)}_getKeyModifier(t){const{isWin:a,isMac:b}=l.FeatureTest.platform;return a&&t.ctrlKey||b&&t.metaKey}_setEventListener(t,a,b,S){a.includes("mouse")?t.addEventListener(a,T=>{var $;($=this.linkService.eventBus)==null||$.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:b,value:S(T),shift:T.shiftKey,modifier:this._getKeyModifier(T)}})}):t.addEventListener(a,T=>{var $;($=this.linkService.eventBus)==null||$.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:b,value:S(T)}})})}_setEventListeners(t,a,b){var S;for(const[T,$]of a)($==="Action"||(S=this.data.actions)!=null&&S[$])&&this._setEventListener(t,T,$,b)}_setBackgroundColor(t){const a=this.data.backgroundColor||null;t.style.backgroundColor=a===null?"transparent":l.Util.makeHexColor(a[0],a[1],a[2])}_setTextStyle(t){const a=["left","center","right"],{fontColor:b}=this.data.defaultAppearanceData,S=this.data.defaultAppearanceData.fontSize||M,T=t.style;let $;const st=2,J=rt=>Math.round(10*rt)/10;if(this.data.multiLine){const rt=Math.abs(this.data.rect[3]-this.data.rect[1]-st),ot=Math.round(rt/(l.LINE_FACTOR*S))||1,nt=rt/ot;$=Math.min(S,J(nt/l.LINE_FACTOR))}else{const rt=Math.abs(this.data.rect[3]-this.data.rect[1]-st);$=Math.min(S,J(rt/l.LINE_FACTOR))}T.fontSize=`calc(${$}px * var(--scale-factor))`,T.color=l.Util.makeHexColor(b[0],b[1],b[2]),this.data.textAlignment!==null&&(T.textAlign=a[this.data.textAlignment])}_setRequired(t,a){a?t.setAttribute("required",!0):t.removeAttribute("required"),t.setAttribute("aria-required",a)}}class _ extends c{constructor(t){const a=t.renderForms||!t.data.hasAppearance&&!!t.data.fieldValue;super(t,{isRenderable:a})}setPropertyOnSiblings(t,a,b,S){const T=this.annotationStorage;for(const $ of this._getElementsByName(t.name,t.id))$.domElement&&($.domElement[a]=b),T.setValue($.id,{[S]:b})}render(){var S;const t=this.annotationStorage,a=this.data.id;this.container.classList.add("textWidgetAnnotation");let b=null;if(this.renderForms){const T=t.getValue(a,{value:this.data.fieldValue});let $=T.formattedValue||T.value||"";const st=t.getValue(a,{charLimit:this.data.maxLen}).charLimit;st&&$.length>st&&($=$.slice(0,st));const J={userValue:$,formattedValue:null,lastCommittedValue:null,commitKey:1};this.data.multiLine?(b=document.createElement("textarea"),b.textContent=$,this.data.doNotScroll&&(b.style.overflowY="hidden")):(b=document.createElement("input"),b.type="text",b.setAttribute("value",$),this.data.doNotScroll&&(b.style.overflowX="hidden")),this.data.hasOwnCanvas&&(b.hidden=!0),v.add(b),b.setAttribute("data-element-id",a),b.disabled=this.data.readOnly,b.name=this.data.fieldName,b.tabIndex=L,this._setRequired(b,this.data.required),st&&(b.maxLength=st),b.addEventListener("input",ot=>{t.setValue(a,{value:ot.target.value}),this.setPropertyOnSiblings(b,"value",ot.target.value,"value")}),b.addEventListener("resetform",ot=>{const nt=this.data.defaultFieldValue??"";b.value=J.userValue=nt,J.formattedValue=null});let rt=ot=>{const{formattedValue:nt}=J;nt!=null&&(ot.target.value=nt),ot.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){b.addEventListener("focus",nt=>{const{target:at}=nt;J.userValue&&(at.value=J.userValue),J.lastCommittedValue=at.value,J.commitKey=1}),b.addEventListener("updatefromsandbox",nt=>{this.showElementAndHideCanvas(nt.target);const at={value(ft){J.userValue=ft.detail.value??"",t.setValue(a,{value:J.userValue.toString()}),ft.target.value=J.userValue},formattedValue(ft){const{formattedValue:pt}=ft.detail;J.formattedValue=pt,pt!=null&&ft.target!==document.activeElement&&(ft.target.value=pt),t.setValue(a,{formattedValue:pt})},selRange(ft){ft.target.setSelectionRange(...ft.detail.selRange)},charLimit:ft=>{var Tt;const{charLimit:pt}=ft.detail,{target:xt}=ft;if(pt===0){xt.removeAttribute("maxLength");return}xt.setAttribute("maxLength",pt);let vt=J.userValue;!vt||vt.length<=pt||(vt=vt.slice(0,pt),xt.value=J.userValue=vt,t.setValue(a,{value:vt}),(Tt=this.linkService.eventBus)==null||Tt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:a,name:"Keystroke",value:vt,willCommit:!0,commitKey:1,selStart:xt.selectionStart,selEnd:xt.selectionEnd}}))}};this._dispatchEventFromSandbox(at,nt)}),b.addEventListener("keydown",nt=>{var pt;J.commitKey=1;let at=-1;if(nt.key==="Escape"?at=0:nt.key==="Enter"&&!this.data.multiLine?at=2:nt.key==="Tab"&&(J.commitKey=3),at===-1)return;const{value:ft}=nt.target;J.lastCommittedValue!==ft&&(J.lastCommittedValue=ft,J.userValue=ft,(pt=this.linkService.eventBus)==null||pt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:a,name:"Keystroke",value:ft,willCommit:!0,commitKey:at,selStart:nt.target.selectionStart,selEnd:nt.target.selectionEnd}}))});const ot=rt;rt=null,b.addEventListener("blur",nt=>{var ft;if(!nt.relatedTarget)return;const{value:at}=nt.target;J.userValue=at,J.lastCommittedValue!==at&&((ft=this.linkService.eventBus)==null||ft.dispatch("dispatcheventinsandbox",{source:this,detail:{id:a,name:"Keystroke",value:at,willCommit:!0,commitKey:J.commitKey,selStart:nt.target.selectionStart,selEnd:nt.target.selectionEnd}})),ot(nt)}),(S=this.data.actions)!=null&&S.Keystroke&&b.addEventListener("beforeinput",nt=>{var yt;J.lastCommittedValue=null;const{data:at,target:ft}=nt,{value:pt,selectionStart:xt,selectionEnd:vt}=ft;let Tt=xt,K=vt;switch(nt.inputType){case"deleteWordBackward":{const St=pt.substring(0,xt).match(/\w*[^\w]*$/);St&&(Tt-=St[0].length);break}case"deleteWordForward":{const St=pt.substring(xt).match(/^[^\w]*\w*/);St&&(K+=St[0].length);break}case"deleteContentBackward":xt===vt&&(Tt-=1);break;case"deleteContentForward":xt===vt&&(K+=1);break}nt.preventDefault(),(yt=this.linkService.eventBus)==null||yt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:a,name:"Keystroke",value:pt,change:at||"",willCommit:!1,selStart:Tt,selEnd:K}})}),this._setEventListeners(b,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],nt=>nt.target.value)}if(rt&&b.addEventListener("blur",rt),this.data.comb){const nt=(this.data.rect[2]-this.data.rect[0])/st;b.classList.add("comb"),b.style.letterSpacing=`calc(${nt}px * var(--scale-factor) - 1ch)`}}else b=document.createElement("div"),b.textContent=this.data.fieldValue,b.style.verticalAlign="middle",b.style.display="table-cell";return this._setTextStyle(b),this._setBackgroundColor(b),this._setDefaultPropertiesFromJS(b),this.container.append(b),this.container}}class E extends c{constructor(t){super(t,{isRenderable:t.renderForms})}render(){const t=this.annotationStorage,a=this.data,b=a.id;let S=t.getValue(b,{value:a.exportValue===a.fieldValue}).value;typeof S=="string"&&(S=S!=="Off",t.setValue(b,{value:S})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const T=document.createElement("input");return v.add(T),T.setAttribute("data-element-id",b),T.disabled=a.readOnly,this._setRequired(T,this.data.required),T.type="checkbox",T.name=a.fieldName,S&&T.setAttribute("checked",!0),T.setAttribute("exportValue",a.exportValue),T.tabIndex=L,T.addEventListener("change",$=>{const{name:st,checked:J}=$.target;for(const rt of this._getElementsByName(st,b)){const ot=J&&rt.exportValue===a.exportValue;rt.domElement&&(rt.domElement.checked=ot),t.setValue(rt.id,{value:ot})}t.setValue(b,{value:J})}),T.addEventListener("resetform",$=>{const st=a.defaultFieldValue||"Off";$.target.checked=st===a.exportValue}),this.enableScripting&&this.hasJSActions&&(T.addEventListener("updatefromsandbox",$=>{const st={value(J){J.target.checked=J.detail.value!=="Off",t.setValue(b,{value:J.target.checked})}};this._dispatchEventFromSandbox(st,$)}),this._setEventListeners(T,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],$=>$.target.checked)),this._setBackgroundColor(T),this._setDefaultPropertiesFromJS(T),this.container.append(T),this.container}}class C extends c{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const t=this.annotationStorage,a=this.data,b=a.id;let S=t.getValue(b,{value:a.fieldValue===a.buttonValue}).value;typeof S=="string"&&(S=S!==a.buttonValue,t.setValue(b,{value:S}));const T=document.createElement("input");if(v.add(T),T.setAttribute("data-element-id",b),T.disabled=a.readOnly,this._setRequired(T,this.data.required),T.type="radio",T.name=a.fieldName,S&&T.setAttribute("checked",!0),T.tabIndex=L,T.addEventListener("change",$=>{const{name:st,checked:J}=$.target;for(const rt of this._getElementsByName(st,b))t.setValue(rt.id,{value:!1});t.setValue(b,{value:J})}),T.addEventListener("resetform",$=>{const st=a.defaultFieldValue;$.target.checked=st!=null&&st===a.buttonValue}),this.enableScripting&&this.hasJSActions){const $=a.buttonValue;T.addEventListener("updatefromsandbox",st=>{const J={value:rt=>{const ot=$===rt.detail.value;for(const nt of this._getElementsByName(rt.target.name)){const at=ot&&nt.id===b;nt.domElement&&(nt.domElement.checked=at),t.setValue(nt.id,{value:at})}}};this._dispatchEventFromSandbox(J,st)}),this._setEventListeners(T,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],st=>st.target.checked)}return this._setBackgroundColor(T),this._setDefaultPropertiesFromJS(T),this.container.append(T),this.container}}class m extends p{constructor(t){super(t,{ignoreBorder:t.data.hasAppearance})}render(){const t=super.render();t.classList.add("buttonWidgetAnnotation","pushButton"),this.data.alternativeText&&(t.title=this.data.alternativeText);const a=t.lastChild;return this.enableScripting&&this.hasJSActions&&a&&(this._setDefaultPropertiesFromJS(a),a.addEventListener("updatefromsandbox",b=>{this._dispatchEventFromSandbox({},b)})),t}}class e extends c{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const t=this.annotationStorage,a=this.data.id,b=t.getValue(a,{value:this.data.fieldValue}),S=document.createElement("select");v.add(S),S.setAttribute("data-element-id",a),S.disabled=this.data.readOnly,this._setRequired(S,this.data.required),S.name=this.data.fieldName,S.tabIndex=L;let T=this.data.combo&&this.data.options.length>0;this.data.combo||(S.size=this.data.options.length,this.data.multiSelect&&(S.multiple=!0)),S.addEventListener("resetform",ot=>{const nt=this.data.defaultFieldValue;for(const at of S.options)at.selected=at.value===nt});for(const ot of this.data.options){const nt=document.createElement("option");nt.textContent=ot.displayValue,nt.value=ot.exportValue,b.value.includes(ot.exportValue)&&(nt.setAttribute("selected",!0),T=!1),S.append(nt)}let $=null;if(T){const ot=document.createElement("option");ot.value=" ",ot.setAttribute("hidden",!0),ot.setAttribute("selected",!0),S.prepend(ot),$=()=>{ot.remove(),S.removeEventListener("input",$),$=null},S.addEventListener("input",$)}const st=ot=>{const nt=ot?"value":"textContent",{options:at,multiple:ft}=S;return ft?Array.prototype.filter.call(at,pt=>pt.selected).map(pt=>pt[nt]):at.selectedIndex===-1?null:at[at.selectedIndex][nt]};let J=st(!1);const rt=ot=>{const nt=ot.target.options;return Array.prototype.map.call(nt,at=>({displayValue:at.textContent,exportValue:at.value}))};return this.enableScripting&&this.hasJSActions?(S.addEventListener("updatefromsandbox",ot=>{const nt={value(at){$==null||$();const ft=at.detail.value,pt=new Set(Array.isArray(ft)?ft:[ft]);for(const xt of S.options)xt.selected=pt.has(xt.value);t.setValue(a,{value:st(!0)}),J=st(!1)},multipleSelection(at){S.multiple=!0},remove(at){const ft=S.options,pt=at.detail.remove;ft[pt].selected=!1,S.remove(pt),ft.length>0&&Array.prototype.findIndex.call(ft,vt=>vt.selected)===-1&&(ft[0].selected=!0),t.setValue(a,{value:st(!0),items:rt(at)}),J=st(!1)},clear(at){for(;S.length!==0;)S.remove(0);t.setValue(a,{value:null,items:[]}),J=st(!1)},insert(at){const{index:ft,displayValue:pt,exportValue:xt}=at.detail.insert,vt=S.children[ft],Tt=document.createElement("option");Tt.textContent=pt,Tt.value=xt,vt?vt.before(Tt):S.append(Tt),t.setValue(a,{value:st(!0),items:rt(at)}),J=st(!1)},items(at){const{items:ft}=at.detail;for(;S.length!==0;)S.remove(0);for(const pt of ft){const{displayValue:xt,exportValue:vt}=pt,Tt=document.createElement("option");Tt.textContent=xt,Tt.value=vt,S.append(Tt)}S.options.length>0&&(S.options[0].selected=!0),t.setValue(a,{value:st(!0),items:rt(at)}),J=st(!1)},indices(at){const ft=new Set(at.detail.indices);for(const pt of at.target.options)pt.selected=ft.has(pt.index);t.setValue(a,{value:st(!0)}),J=st(!1)},editable(at){at.target.disabled=!at.detail.editable}};this._dispatchEventFromSandbox(nt,ot)}),S.addEventListener("input",ot=>{var at;const nt=st(!0);t.setValue(a,{value:nt}),ot.preventDefault(),(at=this.linkService.eventBus)==null||at.dispatch("dispatcheventinsandbox",{source:this,detail:{id:a,name:"Keystroke",value:J,changeEx:nt,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(S,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],ot=>ot.target.value)):S.addEventListener("input",function(ot){t.setValue(a,{value:st(!0)})}),this.data.combo&&this._setTextStyle(S),this._setBackgroundColor(S),this._setDefaultPropertiesFromJS(S),this.container.append(S),this.container}}const x=class extends P{constructor(t){var S,T,$;const{data:a}=t,b=!x.IGNORE_TYPES.has(a.parentType)&&!!((S=a.titleObj)!=null&&S.str||(T=a.contentsObj)!=null&&T.str||($=a.richText)!=null&&$.str);super(t,{isRenderable:b})}render(){this.container.classList.add("popupAnnotation");const t=this.layer.querySelectorAll(`[data-annotation-id="${this.data.parentId}"]`);if(t.length===0)return this.container;const a=new h({container:this.container,trigger:Array.from(t),color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText}),b=this.page,S=l.Util.normalizeRect([this.data.parentRect[0],b.view[3]-this.data.parentRect[1]+b.view[1],this.data.parentRect[2],b.view[3]-this.data.parentRect[3]+b.view[1]]),T=S[0]+this.data.parentRect[2]-this.data.parentRect[0],$=S[1],{pageWidth:st,pageHeight:J,pageX:rt,pageY:ot}=this.viewport.rawDims;return this.container.style.left=`${100*(T-rt)/st}%`,this.container.style.top=`${100*($-ot)/J}%`,this.container.append(a.render()),this.container}};let n=x;Lt(n,"IGNORE_TYPES",new Set(["Line","Square","Circle","PolyLine","Polygon","Ink"]));class h{constructor(t){this.container=t.container,this.trigger=t.trigger,this.color=t.color,this.titleObj=t.titleObj,this.modificationDate=t.modificationDate,this.contentsObj=t.contentsObj,this.richText=t.richText,this.hideWrapper=t.hideWrapper||!1,this.pinned=!1}render(){var st,J;const a=document.createElement("div");a.classList.add("popupWrapper"),this.hideElement=this.hideWrapper?a:this.container,this.hideElement.hidden=!0;const b=document.createElement("div");b.classList.add("popup");const S=this.color;if(S){const rt=.7*(255-S[0])+S[0],ot=.7*(255-S[1])+S[1],nt=.7*(255-S[2])+S[2];b.style.backgroundColor=l.Util.makeHexColor(rt|0,ot|0,nt|0)}const T=document.createElement("h1");T.dir=this.titleObj.dir,T.textContent=this.titleObj.str,b.append(T);const $=A.PDFDateString.toDateObject(this.modificationDate);if($){const rt=document.createElement("span");rt.classList.add("popupDate"),rt.textContent="{{date}}, {{time}}",rt.dataset.l10nId="annotation_date_string",rt.dataset.l10nArgs=JSON.stringify({date:$.toLocaleDateString(),time:$.toLocaleTimeString()}),b.append(rt)}if((st=this.richText)!=null&&st.str&&(!((J=this.contentsObj)!=null&&J.str)||this.contentsObj.str===this.richText.str))Z.XfaLayer.render({xfaHtml:this.richText.html,intent:"richText",div:b}),b.lastChild.classList.add("richText","popupContent");else{const rt=this._formatContents(this.contentsObj);b.append(rt)}Array.isArray(this.trigger)||(this.trigger=[this.trigger]);for(const rt of this.trigger)rt.addEventListener("click",this._toggle.bind(this)),rt.addEventListener("mouseover",this._show.bind(this,!1)),rt.addEventListener("mouseout",this._hide.bind(this,!1));return b.addEventListener("click",this._hide.bind(this,!0)),a.append(b),a}_formatContents({str:t,dir:a}){const b=document.createElement("p");b.classList.add("popupContent"),b.dir=a;const S=t.split(/(?:\r\n?|\n)/);for(let T=0,$=S.length;T<$;++T){const st=S[T];b.append(document.createTextNode(st)),T<$-1&&b.append(document.createElement("br"))}return b}_toggle(){this.pinned?this._hide(!0):this._show(!0)}_show(t=!1){t&&(this.pinned=!0),this.hideElement.hidden&&(this.hideElement.hidden=!1,this.container.style.zIndex=parseInt(this.container.style.zIndex)+1e3)}_hide(t=!0){t&&(this.pinned=!1),!this.hideElement.hidden&&!this.pinned&&(this.hideElement.hidden=!0,this.container.style.zIndex=parseInt(this.container.style.zIndex)-1e3)}}class o extends P{constructor(t){var b,S,T;const a=!!(t.data.hasPopup||(b=t.data.titleObj)!=null&&b.str||(S=t.data.contentsObj)!=null&&S.str||(T=t.data.richText)!=null&&T.str);super(t,{isRenderable:a,ignoreBorder:!0}),this.textContent=t.data.textContent}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const t=document.createElement("div");t.classList.add("annotationTextContent"),t.setAttribute("role","comment");for(const a of this.textContent){const b=document.createElement("span");b.textContent=a,t.append(b)}this.container.append(t)}return this.data.hasPopup||this._createPopup(null,this.data),this.container}}class d extends P{constructor(t){var b,S,T;const a=!!(t.data.hasPopup||(b=t.data.titleObj)!=null&&b.str||(S=t.data.contentsObj)!=null&&S.str||(T=t.data.richText)!=null&&T.str);super(t,{isRenderable:a,ignoreBorder:!0})}render(){this.container.classList.add("lineAnnotation");const t=this.data,{width:a,height:b}=N(t.rect),S=this.svgFactory.create(a,b,!0),T=this.svgFactory.createElement("svg:line");return T.setAttribute("x1",t.rect[2]-t.lineCoordinates[0]),T.setAttribute("y1",t.rect[3]-t.lineCoordinates[1]),T.setAttribute("x2",t.rect[2]-t.lineCoordinates[2]),T.setAttribute("y2",t.rect[3]-t.lineCoordinates[3]),T.setAttribute("stroke-width",t.borderStyle.width||1),T.setAttribute("stroke","transparent"),T.setAttribute("fill","transparent"),S.append(T),this.container.append(S),this._createPopup(T,t),this.container}}class F extends P{constructor(t){var b,S,T;const a=!!(t.data.hasPopup||(b=t.data.titleObj)!=null&&b.str||(S=t.data.contentsObj)!=null&&S.str||(T=t.data.richText)!=null&&T.str);super(t,{isRenderable:a,ignoreBorder:!0})}render(){this.container.classList.add("squareAnnotation");const t=this.data,{width:a,height:b}=N(t.rect),S=this.svgFactory.create(a,b,!0),T=t.borderStyle.width,$=this.svgFactory.createElement("svg:rect");return $.setAttribute("x",T/2),$.setAttribute("y",T/2),$.setAttribute("width",a-T),$.setAttribute("height",b-T),$.setAttribute("stroke-width",T||1),$.setAttribute("stroke","transparent"),$.setAttribute("fill","transparent"),S.append($),this.container.append(S),this._createPopup($,t),this.container}}class s extends P{constructor(t){var b,S,T;const a=!!(t.data.hasPopup||(b=t.data.titleObj)!=null&&b.str||(S=t.data.contentsObj)!=null&&S.str||(T=t.data.richText)!=null&&T.str);super(t,{isRenderable:a,ignoreBorder:!0})}render(){this.container.classList.add("circleAnnotation");const t=this.data,{width:a,height:b}=N(t.rect),S=this.svgFactory.create(a,b,!0),T=t.borderStyle.width,$=this.svgFactory.createElement("svg:ellipse");return $.setAttribute("cx",a/2),$.setAttribute("cy",b/2),$.setAttribute("rx",a/2-T/2),$.setAttribute("ry",b/2-T/2),$.setAttribute("stroke-width",T||1),$.setAttribute("stroke","transparent"),$.setAttribute("fill","transparent"),S.append($),this.container.append(S),this._createPopup($,t),this.container}}class B extends P{constructor(t){var b,S,T;const a=!!(t.data.hasPopup||(b=t.data.titleObj)!=null&&b.str||(S=t.data.contentsObj)!=null&&S.str||(T=t.data.richText)!=null&&T.str);super(t,{isRenderable:a,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const t=this.data,{width:a,height:b}=N(t.rect),S=this.svgFactory.create(a,b,!0);let T=[];for(const st of t.vertices){const J=st.x-t.rect[0],rt=t.rect[3]-st.y;T.push(J+","+rt)}T=T.join(" ");const $=this.svgFactory.createElement(this.svgElementName);return $.setAttribute("points",T),$.setAttribute("stroke-width",t.borderStyle.width||1),$.setAttribute("stroke","transparent"),$.setAttribute("fill","transparent"),S.append($),this.container.append(S),this._createPopup($,t),this.container}}class V extends B{constructor(t){super(t),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class Y extends P{constructor(t){var b,S,T;const a=!!(t.data.hasPopup||(b=t.data.titleObj)!=null&&b.str||(S=t.data.contentsObj)!=null&&S.str||(T=t.data.richText)!=null&&T.str);super(t,{isRenderable:a,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),this.data.hasPopup||this._createPopup(null,this.data),this.container}}class Q extends P{constructor(t){var b,S,T;const a=!!(t.data.hasPopup||(b=t.data.titleObj)!=null&&b.str||(S=t.data.contentsObj)!=null&&S.str||(T=t.data.richText)!=null&&T.str);super(t,{isRenderable:a,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const t=this.data,{width:a,height:b}=N(t.rect),S=this.svgFactory.create(a,b,!0);for(const T of t.inkLists){let $=[];for(const J of T){const rt=J.x-t.rect[0],ot=t.rect[3]-J.y;$.push(`${rt},${ot}`)}$=$.join(" ");const st=this.svgFactory.createElement(this.svgElementName);st.setAttribute("points",$),st.setAttribute("stroke-width",t.borderStyle.width||1),st.setAttribute("stroke","transparent"),st.setAttribute("fill","transparent"),this._createPopup(st,t),S.append(st)}return this.container.append(S),this.container}}class et extends P{constructor(t){var b,S,T;const a=!!(t.data.hasPopup||(b=t.data.titleObj)!=null&&b.str||(S=t.data.contentsObj)!=null&&S.str||(T=t.data.richText)!=null&&T.str);super(t,{isRenderable:a,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("highlightAnnotation"):(this.container.classList.add("highlightAnnotation"),this.container)}}class ut extends P{constructor(t){var b,S,T;const a=!!(t.data.hasPopup||(b=t.data.titleObj)!=null&&b.str||(S=t.data.contentsObj)!=null&&S.str||(T=t.data.richText)!=null&&T.str);super(t,{isRenderable:a,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("underlineAnnotation"):(this.container.classList.add("underlineAnnotation"),this.container)}}class lt extends P{constructor(t){var b,S,T;const a=!!(t.data.hasPopup||(b=t.data.titleObj)!=null&&b.str||(S=t.data.contentsObj)!=null&&S.str||(T=t.data.richText)!=null&&T.str);super(t,{isRenderable:a,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("squigglyAnnotation"):(this.container.classList.add("squigglyAnnotation"),this.container)}}class ht extends P{constructor(t){var b,S,T;const a=!!(t.data.hasPopup||(b=t.data.titleObj)!=null&&b.str||(S=t.data.contentsObj)!=null&&S.str||(T=t.data.richText)!=null&&T.str);super(t,{isRenderable:a,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("strikeoutAnnotation"):(this.container.classList.add("strikeoutAnnotation"),this.container)}}class mt extends P{constructor(t){var b,S,T;const a=!!(t.data.hasPopup||(b=t.data.titleObj)!=null&&b.str||(S=t.data.contentsObj)!=null&&S.str||(T=t.data.richText)!=null&&T.str);super(t,{isRenderable:a,ignoreBorder:!0})}render(){return this.container.classList.add("stampAnnotation"),this.data.hasPopup||this._createPopup(null,this.data),this.container}}class At extends P{constructor(t){var S;super(t,{isRenderable:!0});const{filename:a,content:b}=this.data.file;this.filename=(0,A.getFilenameFromUrl)(a,!0),this.content=b,(S=this.linkService.eventBus)==null||S.dispatch("fileattachmentannotation",{source:this,filename:a,content:b})}render(){var a,b;this.container.classList.add("fileAttachmentAnnotation");let t;return this.data.hasAppearance?t=document.createElement("div"):(t=document.createElement("img"),t.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(this.data.name)?"paperclip":"pushpin"}.svg`),t.classList.add("popupTriggerArea"),t.addEventListener("dblclick",this._download.bind(this)),!this.data.hasPopup&&((a=this.data.titleObj)!=null&&a.str||(b=this.data.contentsObj)!=null&&b.str||this.data.richText)&&this._createPopup(t,this.data),this.container.append(t),this.container}_download(){var t;(t=this.downloadManager)==null||t.openOrDownloadData(this.container,this.content,this.filename)}}const O=class{static render(t){var J,rt;const{annotations:a,div:b,viewport:S,accessibilityManager:T}=t;(0,A.setLayerDimensions)(b,S);const $={data:null,layer:b,page:t.page,viewport:S,linkService:t.linkService,downloadManager:t.downloadManager,imageResourcesPath:t.imageResourcesPath||"",renderForms:t.renderForms!==!1,svgFactory:new A.DOMSVGFactory,annotationStorage:t.annotationStorage||new G.AnnotationStorage,enableScripting:t.enableScripting===!0,hasJSActions:t.hasJSActions,fieldObjects:t.fieldObjects};let st=0;for(const ot of a){if(ot.noHTML)continue;if(ot.annotationType!==l.AnnotationType.POPUP){const{width:ft,height:pt}=N(ot.rect);if(ft<=0||pt<=0)continue}$.data=ot;const nt=w.create($);if(!nt.isRenderable)continue;const at=nt.render();if(ot.hidden&&(at.style.visibility="hidden"),Array.isArray(at))for(const ft of at)ft.style.zIndex=st++,it(J=O,H,Fe).call(J,ft,ot.id,b,T);else at.style.zIndex=st++,nt instanceof n?b.prepend(at):it(rt=O,H,Fe).call(rt,at,ot.id,b,T)}it(this,X,Me).call(this,b,t.annotationCanvasMap)}static update(t){const{annotationCanvasMap:a,div:b,viewport:S}=t;(0,A.setLayerDimensions)(b,{rotation:S.rotation}),it(this,X,Me).call(this,b,a),b.hidden=!1}};let Et=O;H=new WeakSet,Fe=function(t,a,b,S){const T=t.firstChild||t;T.id=`${A.AnnotationPrefix}${a}`,b.append(t),S==null||S.moveElementInDOM(b,t,T,!1)},X=new WeakSet,Me=function(t,a){if(a){for(const[b,S]of a){const T=t.querySelector(`[data-annotation-id="${b}"]`);if(!T)continue;const{firstChild:$}=T;$?$.nodeName==="CANVAS"?$.replaceWith(S):$.before(S):T.append(S)}a.clear()}},tt(Et,H),tt(Et,X),i.AnnotationLayer=Et},(R,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.ColorConverters=void 0;function U(A){return Math.floor(Math.max(0,Math.min(1,A))*255).toString(16).padStart(2,"0")}class l{static CMYK_G([G,q,Z,L]){return["G",1-Math.min(1,.3*G+.59*Z+.11*q+L)]}static G_CMYK([G]){return["CMYK",0,0,0,1-G]}static G_RGB([G]){return["RGB",G,G,G]}static G_HTML([G]){const q=U(G);return`#${q}${q}${q}`}static RGB_G([G,q,Z]){return["G",.3*G+.59*q+.11*Z]}static RGB_HTML([G,q,Z]){const L=U(G),M=U(q),v=U(Z);return`#${L}${M}${v}`}static T_HTML(){return"#00000000"}static CMYK_RGB([G,q,Z,L]){return["RGB",1-Math.min(1,G+L),1-Math.min(1,Z+L),1-Math.min(1,q+L)]}static CMYK_HTML(G){const q=this.CMYK_RGB(G).slice(1);return this.RGB_HTML(q)}static RGB_CMYK([G,q,Z]){const L=1-G,M=1-q,v=1-Z,N=Math.min(L,M,v);return["CMYK",L,M,v,N]}}i.ColorConverters=l},(R,i,U)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.XfaLayer=void 0;var l=U(19);class A{static setupStorage(q,Z,L,M,v){const N=M.getValue(Z,{value:null});switch(L.name){case"textarea":if(N.value!==null&&(q.textContent=N.value),v==="print")break;q.addEventListener("input",w=>{M.setValue(Z,{value:w.target.value})});break;case"input":if(L.attributes.type==="radio"||L.attributes.type==="checkbox"){if(N.value===L.attributes.xfaOn?q.setAttribute("checked",!0):N.value===L.attributes.xfaOff&&q.removeAttribute("checked"),v==="print")break;q.addEventListener("change",w=>{M.setValue(Z,{value:w.target.checked?w.target.getAttribute("xfaOn"):w.target.getAttribute("xfaOff")})})}else{if(N.value!==null&&q.setAttribute("value",N.value),v==="print")break;q.addEventListener("input",w=>{M.setValue(Z,{value:w.target.value})})}break;case"select":if(N.value!==null)for(const w of L.children)w.attributes.value===N.value&&(w.attributes.selected=!0);q.addEventListener("input",w=>{const P=w.target.options,p=P.selectedIndex===-1?"":P[P.selectedIndex].value;M.setValue(Z,{value:p})});break}}static setAttributes({html:q,element:Z,storage:L=null,intent:M,linkService:v}){const{attributes:N}=Z,w=q instanceof HTMLAnchorElement;N.type==="radio"&&(N.name=`${N.name}-${M}`);for(const[P,p]of Object.entries(N))if(p!=null)switch(P){case"class":p.length&&q.setAttribute(P,p.join(" "));break;case"dataId":break;case"id":q.setAttribute("data-element-id",p);break;case"style":Object.assign(q.style,p);break;case"textContent":q.textContent=p;break;default:(!w||P!=="href"&&P!=="newWindow")&&q.setAttribute(P,p)}w&&v.addLinkAttributes(q,N.href,N.newWindow),L&&N.dataId&&this.setupStorage(q,N.dataId,Z,L)}static render(q){var f;const Z=q.annotationStorage,L=q.linkService,M=q.xfaHtml,v=q.intent||"display",N=document.createElement(M.name);M.attributes&&this.setAttributes({html:N,element:M,intent:v,linkService:L});const w=[[M,-1,N]],P=q.div;if(P.append(N),q.viewport){const c=`matrix(${q.viewport.transform.join(",")})`;P.style.transform=c}v!=="richText"&&P.setAttribute("class","xfaLayer xfaFont");const p=[];for(;w.length>0;){const[c,_,E]=w.at(-1);if(_+1===c.children.length){w.pop();continue}const C=c.children[++w.at(-1)[1]];if(C===null)continue;const{name:m}=C;if(m==="#text"){const n=document.createTextNode(C.value);p.push(n),E.append(n);continue}let e;if((f=C==null?void 0:C.attributes)!=null&&f.xmlns?e=document.createElementNS(C.attributes.xmlns,m):e=document.createElement(m),E.append(e),C.attributes&&this.setAttributes({html:e,element:C,storage:Z,intent:v,linkService:L}),C.children&&C.children.length>0)w.push([C,-1,e]);else if(C.value){const n=document.createTextNode(C.value);l.XfaText.shouldBuildText(m)&&p.push(n),e.append(n)}}for(const c of P.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))c.setAttribute("readOnly",!0);return{textDivs:p}}static update(q){const Z=`matrix(${q.viewport.transform.join(",")})`;q.div.style.transform=Z,q.div.hidden=!1}}i.XfaLayer=A},(R,i,U)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.SVGGraphics=void 0;var l=U(6),A=U(1),G=U(10);let q=class{constructor(){(0,A.unreachable)("Not implemented: SVGGraphics")}};i.SVGGraphics=q;{let f=function(e){let n=[];const h=[];for(const o of e){if(o.fn==="save"){n.push({fnId:92,fn:"group",items:[]}),h.push(n),n=n.at(-1).items;continue}o.fn==="restore"?n=h.pop():n.push(o)}return n},c=function(e){if(Number.isInteger(e))return e.toString();const n=e.toFixed(10);let h=n.length-1;if(n[h]!=="0")return n;do h--;while(n[h]==="0");return n.substring(0,n[h]==="."?h:h+1)},_=function(e){if(e[4]===0&&e[5]===0){if(e[1]===0&&e[2]===0)return e[0]===1&&e[3]===1?"":`scale(${c(e[0])} ${c(e[3])})`;if(e[0]===e[3]&&e[1]===-e[2]){const n=Math.acos(e[0])*180/Math.PI;return`rotate(${c(n)})`}}else if(e[0]===1&&e[1]===0&&e[2]===0&&e[3]===1)return`translate(${c(e[4])} ${c(e[5])})`;return`matrix(${c(e[0])} ${c(e[1])} ${c(e[2])} ${c(e[3])} ${c(e[4])} ${c(e[5])})`};const Z={fontStyle:"normal",fontWeight:"normal",fillColor:"#000000"},L="http://www.w3.org/XML/1998/namespace",M="http://www.w3.org/1999/xlink",v=["butt","round","square"],N=["miter","round","bevel"],w=function(e,n="",h=!1){if(URL.createObjectURL&&typeof Blob<"u"&&!h)return URL.createObjectURL(new Blob([e],{type:n}));const o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let d=`data:${n};base64,`;for(let F=0,s=e.length;F<s;F+=3){const B=e[F]&255,V=e[F+1]&255,Y=e[F+2]&255,Q=B>>2,et=(B&3)<<4|V>>4,ut=F+1<s?(V&15)<<2|Y>>6:64,lt=F+2<s?Y&63:64;d+=o[Q]+o[et]+o[ut]+o[lt]}return d},P=function(){const e=new Uint8Array([137,80,78,71,13,10,26,10]),n=12,h=new Int32Array(256);for(let Y=0;Y<256;Y++){let Q=Y;for(let et=0;et<8;et++)Q&1?Q=3988292384^Q>>1&2147483647:Q=Q>>1&2147483647;h[Y]=Q}function o(Y,Q,et){let ut=-1;for(let lt=Q;lt<et;lt++){const ht=(ut^Y[lt])&255,mt=h[ht];ut=ut>>>8^mt}return ut^-1}function d(Y,Q,et,ut){let lt=ut;const ht=Q.length;et[lt]=ht>>24&255,et[lt+1]=ht>>16&255,et[lt+2]=ht>>8&255,et[lt+3]=ht&255,lt+=4,et[lt]=Y.charCodeAt(0)&255,et[lt+1]=Y.charCodeAt(1)&255,et[lt+2]=Y.charCodeAt(2)&255,et[lt+3]=Y.charCodeAt(3)&255,lt+=4,et.set(Q,lt),lt+=Q.length;const mt=o(et,ut+4,lt);et[lt]=mt>>24&255,et[lt+1]=mt>>16&255,et[lt+2]=mt>>8&255,et[lt+3]=mt&255}function F(Y,Q,et){let ut=1,lt=0;for(let ht=Q;ht<et;++ht)ut=(ut+(Y[ht]&255))%65521,lt=(lt+ut)%65521;return lt<<16|ut}function s(Y){if(!G.isNodeJS)return B(Y);try{let Q;parseInt(process.versions.node)>=8?Q=Y:Q=Buffer.from(Y);const et=require$$5.deflateSync(Q,{level:9});return et instanceof Uint8Array?et:new Uint8Array(et)}catch(Q){(0,A.warn)("Not compressing PNG because zlib.deflateSync is unavailable: "+Q)}return B(Y)}function B(Y){let Q=Y.length;const et=65535,ut=Math.ceil(Q/et),lt=new Uint8Array(2+Q+ut*5+4);let ht=0;lt[ht++]=120,lt[ht++]=156;let mt=0;for(;Q>et;)lt[ht++]=0,lt[ht++]=255,lt[ht++]=255,lt[ht++]=0,lt[ht++]=0,lt.set(Y.subarray(mt,mt+et),ht),ht+=et,mt+=et,Q-=et;lt[ht++]=1,lt[ht++]=Q&255,lt[ht++]=Q>>8&255,lt[ht++]=~Q&65535&255,lt[ht++]=(~Q&65535)>>8&255,lt.set(Y.subarray(mt),ht),ht+=Y.length-mt;const At=F(Y,0,Y.length);return lt[ht++]=At>>24&255,lt[ht++]=At>>16&255,lt[ht++]=At>>8&255,lt[ht++]=At&255,lt}function V(Y,Q,et,ut){const lt=Y.width,ht=Y.height;let mt,At,Et;const _t=Y.data;switch(Q){case A.ImageKind.GRAYSCALE_1BPP:At=0,mt=1,Et=lt+7>>3;break;case A.ImageKind.RGB_24BPP:At=2,mt=8,Et=lt*3;break;case A.ImageKind.RGBA_32BPP:At=6,mt=8,Et=lt*4;break;default:throw new Error("invalid format")}const z=new Uint8Array((1+Et)*ht);let u=0,g=0;for(let O=0;O<ht;++O)z[u++]=0,z.set(_t.subarray(g,g+Et),u),g+=Et,u+=Et;if(Q===A.ImageKind.GRAYSCALE_1BPP&&ut){u=0;for(let O=0;O<ht;O++){u++;for(let I=0;I<Et;I++)z[u++]^=255}}const x=new Uint8Array([lt>>24&255,lt>>16&255,lt>>8&255,lt&255,ht>>24&255,ht>>16&255,ht>>8&255,ht&255,mt,At,0,0,0]),H=s(z),D=e.length+n*3+x.length+H.length,X=new Uint8Array(D);let W=0;return X.set(e,W),W+=e.length,d("IHDR",x,X,W),W+=n+x.length,d("IDATA",H,X,W),W+=n+H.length,d("IEND",new Uint8Array(0),X,W),w(X,"image/png",et)}return function(Q,et,ut){const lt=Q.kind===void 0?A.ImageKind.GRAYSCALE_1BPP:Q.kind;return V(Q,lt,et,ut)}}();class p{constructor(){this.fontSizeScale=1,this.fontWeight=Z.fontWeight,this.fontSize=0,this.textMatrix=A.IDENTITY_MATRIX,this.fontMatrix=A.FONT_IDENTITY_MATRIX,this.leading=0,this.textRenderingMode=A.TextRenderingMode.FILL,this.textMatrixScale=1,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=Z.fillColor,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.activeClipUrl=null,this.clipGroup=null,this.maskId=""}clone(){return Object.create(this)}setCurrentPoint(n,h){this.x=n,this.y=h}}let E=0,C=0,m=0;i.SVGGraphics=q=class{constructor(e,n,h=!1){(0,l.deprecated)("The SVG back-end is no longer maintained and *may* be removed in the future."),this.svgFactory=new l.DOMSVGFactory,this.current=new p,this.transformMatrix=A.IDENTITY_MATRIX,this.transformStack=[],this.extraStack=[],this.commonObjs=e,this.objs=n,this.pendingClip=null,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts=Object.create(null),this.cssStyle=null,this.forceDataSchema=!!h,this._operatorIdMapping=[];for(const o in A.OPS)this._operatorIdMapping[A.OPS[o]]=o}getObject(e,n=null){return typeof e=="string"?e.startsWith("g_")?this.commonObjs.get(e):this.objs.get(e):n}save(){this.transformStack.push(this.transformMatrix);const e=this.current;this.extraStack.push(e),this.current=e.clone()}restore(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.pendingClip=null,this.tgrp=null}group(e){this.save(),this.executeOpTree(e),this.restore()}loadDependencies(e){const n=e.fnArray,h=e.argsArray;for(let o=0,d=n.length;o<d;o++)if(n[o]===A.OPS.dependency)for(const F of h[o]){const s=F.startsWith("g_")?this.commonObjs:this.objs,B=new Promise(V=>{s.get(F,V)});this.current.dependencies.push(B)}return Promise.all(this.current.dependencies)}transform(e,n,h,o,d,F){const s=[e,n,h,o,d,F];this.transformMatrix=A.Util.transform(this.transformMatrix,s),this.tgrp=null}getSVG(e,n){this.viewport=n;const h=this._initialize(n);return this.loadDependencies(e).then(()=>(this.transformMatrix=A.IDENTITY_MATRIX,this.executeOpTree(this.convertOpList(e)),h))}convertOpList(e){const n=this._operatorIdMapping,h=e.argsArray,o=e.fnArray,d=[];for(let F=0,s=o.length;F<s;F++){const B=o[F];d.push({fnId:B,fn:n[B],args:h[F]})}return f(d)}executeOpTree(e){for(const n of e){const h=n.fn,o=n.fnId,d=n.args;switch(o|0){case A.OPS.beginText:this.beginText();break;case A.OPS.dependency:break;case A.OPS.setLeading:this.setLeading(d);break;case A.OPS.setLeadingMoveText:this.setLeadingMoveText(d[0],d[1]);break;case A.OPS.setFont:this.setFont(d);break;case A.OPS.showText:this.showText(d[0]);break;case A.OPS.showSpacedText:this.showText(d[0]);break;case A.OPS.endText:this.endText();break;case A.OPS.moveText:this.moveText(d[0],d[1]);break;case A.OPS.setCharSpacing:this.setCharSpacing(d[0]);break;case A.OPS.setWordSpacing:this.setWordSpacing(d[0]);break;case A.OPS.setHScale:this.setHScale(d[0]);break;case A.OPS.setTextMatrix:this.setTextMatrix(d[0],d[1],d[2],d[3],d[4],d[5]);break;case A.OPS.setTextRise:this.setTextRise(d[0]);break;case A.OPS.setTextRenderingMode:this.setTextRenderingMode(d[0]);break;case A.OPS.setLineWidth:this.setLineWidth(d[0]);break;case A.OPS.setLineJoin:this.setLineJoin(d[0]);break;case A.OPS.setLineCap:this.setLineCap(d[0]);break;case A.OPS.setMiterLimit:this.setMiterLimit(d[0]);break;case A.OPS.setFillRGBColor:this.setFillRGBColor(d[0],d[1],d[2]);break;case A.OPS.setStrokeRGBColor:this.setStrokeRGBColor(d[0],d[1],d[2]);break;case A.OPS.setStrokeColorN:this.setStrokeColorN(d);break;case A.OPS.setFillColorN:this.setFillColorN(d);break;case A.OPS.shadingFill:this.shadingFill(d[0]);break;case A.OPS.setDash:this.setDash(d[0],d[1]);break;case A.OPS.setRenderingIntent:this.setRenderingIntent(d[0]);break;case A.OPS.setFlatness:this.setFlatness(d[0]);break;case A.OPS.setGState:this.setGState(d[0]);break;case A.OPS.fill:this.fill();break;case A.OPS.eoFill:this.eoFill();break;case A.OPS.stroke:this.stroke();break;case A.OPS.fillStroke:this.fillStroke();break;case A.OPS.eoFillStroke:this.eoFillStroke();break;case A.OPS.clip:this.clip("nonzero");break;case A.OPS.eoClip:this.clip("evenodd");break;case A.OPS.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case A.OPS.paintImageXObject:this.paintImageXObject(d[0]);break;case A.OPS.paintInlineImageXObject:this.paintInlineImageXObject(d[0]);break;case A.OPS.paintImageMaskXObject:this.paintImageMaskXObject(d[0]);break;case A.OPS.paintFormXObjectBegin:this.paintFormXObjectBegin(d[0],d[1]);break;case A.OPS.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case A.OPS.closePath:this.closePath();break;case A.OPS.closeStroke:this.closeStroke();break;case A.OPS.closeFillStroke:this.closeFillStroke();break;case A.OPS.closeEOFillStroke:this.closeEOFillStroke();break;case A.OPS.nextLine:this.nextLine();break;case A.OPS.transform:this.transform(d[0],d[1],d[2],d[3],d[4],d[5]);break;case A.OPS.constructPath:this.constructPath(d[0],d[1]);break;case A.OPS.endPath:this.endPath();break;case 92:this.group(n.items);break;default:(0,A.warn)(`Unimplemented operator ${h}`);break}}}setWordSpacing(e){this.current.wordSpacing=e}setCharSpacing(e){this.current.charSpacing=e}nextLine(){this.moveText(0,this.current.leading)}setTextMatrix(e,n,h,o,d,F){const s=this.current;s.textMatrix=s.lineMatrix=[e,n,h,o,d,F],s.textMatrixScale=Math.hypot(e,n),s.x=s.lineX=0,s.y=s.lineY=0,s.xcoords=[],s.ycoords=[],s.tspan=this.svgFactory.createElement("svg:tspan"),s.tspan.setAttributeNS(null,"font-family",s.fontFamily),s.tspan.setAttributeNS(null,"font-size",`${c(s.fontSize)}px`),s.tspan.setAttributeNS(null,"y",c(-s.y)),s.txtElement=this.svgFactory.createElement("svg:text"),s.txtElement.append(s.tspan)}beginText(){const e=this.current;e.x=e.lineX=0,e.y=e.lineY=0,e.textMatrix=A.IDENTITY_MATRIX,e.lineMatrix=A.IDENTITY_MATRIX,e.textMatrixScale=1,e.tspan=this.svgFactory.createElement("svg:tspan"),e.txtElement=this.svgFactory.createElement("svg:text"),e.txtgrp=this.svgFactory.createElement("svg:g"),e.xcoords=[],e.ycoords=[]}moveText(e,n){const h=this.current;h.x=h.lineX+=e,h.y=h.lineY+=n,h.xcoords=[],h.ycoords=[],h.tspan=this.svgFactory.createElement("svg:tspan"),h.tspan.setAttributeNS(null,"font-family",h.fontFamily),h.tspan.setAttributeNS(null,"font-size",`${c(h.fontSize)}px`),h.tspan.setAttributeNS(null,"y",c(-h.y))}showText(e){const n=this.current,h=n.font,o=n.fontSize;if(o===0)return;const d=n.fontSizeScale,F=n.charSpacing,s=n.wordSpacing,B=n.fontDirection,V=n.textHScale*B,Y=h.vertical,Q=Y?1:-1,et=h.defaultVMetrics,ut=o*n.fontMatrix[0];let lt=0;for(const At of e){if(At===null){lt+=B*s;continue}else if(typeof At=="number"){lt+=Q*At*o/1e3;continue}const Et=(At.isSpace?s:0)+F,_t=At.fontChar;let z,u,g=At.width;if(Y){let H;const D=At.vmetric||et;H=At.vmetric?D[1]:g*.5,H=-H*ut;const X=D[2]*ut;g=D?-D[0]:g,z=H/d,u=(lt+X)/d}else z=lt/d,u=0;(At.isInFont||h.missingFile)&&(n.xcoords.push(n.x+z),Y&&n.ycoords.push(-n.y+u),n.tspan.textContent+=_t);let x;Y?x=g*ut-Et*B:x=g*ut+Et*B,lt+=x}n.tspan.setAttributeNS(null,"x",n.xcoords.map(c).join(" ")),Y?n.tspan.setAttributeNS(null,"y",n.ycoords.map(c).join(" ")):n.tspan.setAttributeNS(null,"y",c(-n.y)),Y?n.y-=lt:n.x+=lt*V,n.tspan.setAttributeNS(null,"font-family",n.fontFamily),n.tspan.setAttributeNS(null,"font-size",`${c(n.fontSize)}px`),n.fontStyle!==Z.fontStyle&&n.tspan.setAttributeNS(null,"font-style",n.fontStyle),n.fontWeight!==Z.fontWeight&&n.tspan.setAttributeNS(null,"font-weight",n.fontWeight);const ht=n.textRenderingMode&A.TextRenderingMode.FILL_STROKE_MASK;if(ht===A.TextRenderingMode.FILL||ht===A.TextRenderingMode.FILL_STROKE?(n.fillColor!==Z.fillColor&&n.tspan.setAttributeNS(null,"fill",n.fillColor),n.fillAlpha<1&&n.tspan.setAttributeNS(null,"fill-opacity",n.fillAlpha)):n.textRenderingMode===A.TextRenderingMode.ADD_TO_PATH?n.tspan.setAttributeNS(null,"fill","transparent"):n.tspan.setAttributeNS(null,"fill","none"),ht===A.TextRenderingMode.STROKE||ht===A.TextRenderingMode.FILL_STROKE){const At=1/(n.textMatrixScale||1);this._setStrokeAttributes(n.tspan,At)}let mt=n.textMatrix;n.textRise!==0&&(mt=mt.slice(),mt[5]+=n.textRise),n.txtElement.setAttributeNS(null,"transform",`${_(mt)} scale(${c(V)}, -1)`),n.txtElement.setAttributeNS(L,"xml:space","preserve"),n.txtElement.append(n.tspan),n.txtgrp.append(n.txtElement),this._ensureTransformGroup().append(n.txtElement)}setLeadingMoveText(e,n){this.setLeading(-n),this.moveText(e,n)}addFontStyle(e){if(!e.data)throw new Error('addFontStyle: No font data available, ensure that the "fontExtraProperties" API parameter is set.');this.cssStyle||(this.cssStyle=this.svgFactory.createElement("svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.append(this.cssStyle));const n=w(e.data,e.mimetype,this.forceDataSchema);this.cssStyle.textContent+=`@font-face { font-family: "${e.loadedName}"; src: url(${n}); }
`}setFont(e){const n=this.current,h=this.commonObjs.get(e[0]);let o=e[1];n.font=h,this.embedFonts&&!h.missingFile&&!this.embeddedFonts[h.loadedName]&&(this.addFontStyle(h),this.embeddedFonts[h.loadedName]=h),n.fontMatrix=h.fontMatrix||A.FONT_IDENTITY_MATRIX;let d="normal";h.black?d="900":h.bold&&(d="bold");const F=h.italic?"italic":"normal";o<0?(o=-o,n.fontDirection=-1):n.fontDirection=1,n.fontSize=o,n.fontFamily=h.loadedName,n.fontWeight=d,n.fontStyle=F,n.tspan=this.svgFactory.createElement("svg:tspan"),n.tspan.setAttributeNS(null,"y",c(-n.y)),n.xcoords=[],n.ycoords=[]}endText(){var n;const e=this.current;e.textRenderingMode&A.TextRenderingMode.ADD_TO_PATH_FLAG&&((n=e.txtElement)!=null&&n.hasChildNodes())&&(e.element=e.txtElement,this.clip("nonzero"),this.endPath())}setLineWidth(e){e>0&&(this.current.lineWidth=e)}setLineCap(e){this.current.lineCap=v[e]}setLineJoin(e){this.current.lineJoin=N[e]}setMiterLimit(e){this.current.miterLimit=e}setStrokeAlpha(e){this.current.strokeAlpha=e}setStrokeRGBColor(e,n,h){this.current.strokeColor=A.Util.makeHexColor(e,n,h)}setFillAlpha(e){this.current.fillAlpha=e}setFillRGBColor(e,n,h){this.current.fillColor=A.Util.makeHexColor(e,n,h),this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.xcoords=[],this.current.ycoords=[]}setStrokeColorN(e){this.current.strokeColor=this._makeColorN_Pattern(e)}setFillColorN(e){this.current.fillColor=this._makeColorN_Pattern(e)}shadingFill(e){const n=this.viewport.width,h=this.viewport.height,o=A.Util.inverseTransform(this.transformMatrix),d=A.Util.applyTransform([0,0],o),F=A.Util.applyTransform([0,h],o),s=A.Util.applyTransform([n,0],o),B=A.Util.applyTransform([n,h],o),V=Math.min(d[0],F[0],s[0],B[0]),Y=Math.min(d[1],F[1],s[1],B[1]),Q=Math.max(d[0],F[0],s[0],B[0]),et=Math.max(d[1],F[1],s[1],B[1]),ut=this.svgFactory.createElement("svg:rect");ut.setAttributeNS(null,"x",V),ut.setAttributeNS(null,"y",Y),ut.setAttributeNS(null,"width",Q-V),ut.setAttributeNS(null,"height",et-Y),ut.setAttributeNS(null,"fill",this._makeShadingPattern(e)),this.current.fillAlpha<1&&ut.setAttributeNS(null,"fill-opacity",this.current.fillAlpha),this._ensureTransformGroup().append(ut)}_makeColorN_Pattern(e){return e[0]==="TilingPattern"?this._makeTilingPattern(e):this._makeShadingPattern(e)}_makeTilingPattern(e){const n=e[1],h=e[2],o=e[3]||A.IDENTITY_MATRIX,[d,F,s,B]=e[4],V=e[5],Y=e[6],Q=e[7],et=`shading${m++}`,[ut,lt,ht,mt]=A.Util.normalizeRect([...A.Util.applyTransform([d,F],o),...A.Util.applyTransform([s,B],o)]),[At,Et]=A.Util.singularValueDecompose2dScale(o),_t=V*At,z=Y*Et,u=this.svgFactory.createElement("svg:pattern");u.setAttributeNS(null,"id",et),u.setAttributeNS(null,"patternUnits","userSpaceOnUse"),u.setAttributeNS(null,"width",_t),u.setAttributeNS(null,"height",z),u.setAttributeNS(null,"x",`${ut}`),u.setAttributeNS(null,"y",`${lt}`);const g=this.svg,x=this.transformMatrix,H=this.current.fillColor,D=this.current.strokeColor,X=this.svgFactory.create(ht-ut,mt-lt);if(this.svg=X,this.transformMatrix=o,Q===2){const W=A.Util.makeHexColor(...n);this.current.fillColor=W,this.current.strokeColor=W}return this.executeOpTree(this.convertOpList(h)),this.svg=g,this.transformMatrix=x,this.current.fillColor=H,this.current.strokeColor=D,u.append(X.childNodes[0]),this.defs.append(u),`url(#${et})`}_makeShadingPattern(e){switch(typeof e=="string"&&(e=this.objs.get(e)),e[0]){case"RadialAxial":const n=`shading${m++}`,h=e[3];let o;switch(e[1]){case"axial":const d=e[4],F=e[5];o=this.svgFactory.createElement("svg:linearGradient"),o.setAttributeNS(null,"id",n),o.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),o.setAttributeNS(null,"x1",d[0]),o.setAttributeNS(null,"y1",d[1]),o.setAttributeNS(null,"x2",F[0]),o.setAttributeNS(null,"y2",F[1]);break;case"radial":const s=e[4],B=e[5],V=e[6],Y=e[7];o=this.svgFactory.createElement("svg:radialGradient"),o.setAttributeNS(null,"id",n),o.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),o.setAttributeNS(null,"cx",B[0]),o.setAttributeNS(null,"cy",B[1]),o.setAttributeNS(null,"r",Y),o.setAttributeNS(null,"fx",s[0]),o.setAttributeNS(null,"fy",s[1]),o.setAttributeNS(null,"fr",V);break;default:throw new Error(`Unknown RadialAxial type: ${e[1]}`)}for(const d of h){const F=this.svgFactory.createElement("svg:stop");F.setAttributeNS(null,"offset",d[0]),F.setAttributeNS(null,"stop-color",d[1]),o.append(F)}return this.defs.append(o),`url(#${n})`;case"Mesh":return(0,A.warn)("Unimplemented pattern Mesh"),null;case"Dummy":return"hotpink";default:throw new Error(`Unknown IR type: ${e[0]}`)}}setDash(e,n){this.current.dashArray=e,this.current.dashPhase=n}constructPath(e,n){const h=this.current;let o=h.x,d=h.y,F=[],s=0;for(const B of e)switch(B|0){case A.OPS.rectangle:o=n[s++],d=n[s++];const V=n[s++],Y=n[s++],Q=o+V,et=d+Y;F.push("M",c(o),c(d),"L",c(Q),c(d),"L",c(Q),c(et),"L",c(o),c(et),"Z");break;case A.OPS.moveTo:o=n[s++],d=n[s++],F.push("M",c(o),c(d));break;case A.OPS.lineTo:o=n[s++],d=n[s++],F.push("L",c(o),c(d));break;case A.OPS.curveTo:o=n[s+4],d=n[s+5],F.push("C",c(n[s]),c(n[s+1]),c(n[s+2]),c(n[s+3]),c(o),c(d)),s+=6;break;case A.OPS.curveTo2:F.push("C",c(o),c(d),c(n[s]),c(n[s+1]),c(n[s+2]),c(n[s+3])),o=n[s+2],d=n[s+3],s+=4;break;case A.OPS.curveTo3:o=n[s+2],d=n[s+3],F.push("C",c(n[s]),c(n[s+1]),c(o),c(d),c(o),c(d)),s+=4;break;case A.OPS.closePath:F.push("Z");break}F=F.join(" "),h.path&&e.length>0&&e[0]!==A.OPS.rectangle&&e[0]!==A.OPS.moveTo?F=h.path.getAttributeNS(null,"d")+F:(h.path=this.svgFactory.createElement("svg:path"),this._ensureTransformGroup().append(h.path)),h.path.setAttributeNS(null,"d",F),h.path.setAttributeNS(null,"fill","none"),h.element=h.path,h.setCurrentPoint(o,d)}endPath(){const e=this.current;if(e.path=null,!this.pendingClip)return;if(!e.element){this.pendingClip=null;return}const n=`clippath${E++}`,h=this.svgFactory.createElement("svg:clipPath");h.setAttributeNS(null,"id",n),h.setAttributeNS(null,"transform",_(this.transformMatrix));const o=e.element.cloneNode(!0);if(this.pendingClip==="evenodd"?o.setAttributeNS(null,"clip-rule","evenodd"):o.setAttributeNS(null,"clip-rule","nonzero"),this.pendingClip=null,h.append(o),this.defs.append(h),e.activeClipUrl){e.clipGroup=null;for(const d of this.extraStack)d.clipGroup=null;h.setAttributeNS(null,"clip-path",e.activeClipUrl)}e.activeClipUrl=`url(#${n})`,this.tgrp=null}clip(e){this.pendingClip=e}closePath(){const e=this.current;if(e.path){const n=`${e.path.getAttributeNS(null,"d")}Z`;e.path.setAttributeNS(null,"d",n)}}setLeading(e){this.current.leading=-e}setTextRise(e){this.current.textRise=e}setTextRenderingMode(e){this.current.textRenderingMode=e}setHScale(e){this.current.textHScale=e/100}setRenderingIntent(e){}setFlatness(e){}setGState(e){for(const[n,h]of e)switch(n){case"LW":this.setLineWidth(h);break;case"LC":this.setLineCap(h);break;case"LJ":this.setLineJoin(h);break;case"ML":this.setMiterLimit(h);break;case"D":this.setDash(h[0],h[1]);break;case"RI":this.setRenderingIntent(h);break;case"FL":this.setFlatness(h);break;case"Font":this.setFont(h);break;case"CA":this.setStrokeAlpha(h);break;case"ca":this.setFillAlpha(h);break;default:(0,A.warn)(`Unimplemented graphic state operator ${n}`);break}}fill(){const e=this.current;e.element&&(e.element.setAttributeNS(null,"fill",e.fillColor),e.element.setAttributeNS(null,"fill-opacity",e.fillAlpha),this.endPath())}stroke(){const e=this.current;e.element&&(this._setStrokeAttributes(e.element),e.element.setAttributeNS(null,"fill","none"),this.endPath())}_setStrokeAttributes(e,n=1){const h=this.current;let o=h.dashArray;n!==1&&o.length>0&&(o=o.map(function(d){return n*d})),e.setAttributeNS(null,"stroke",h.strokeColor),e.setAttributeNS(null,"stroke-opacity",h.strokeAlpha),e.setAttributeNS(null,"stroke-miterlimit",c(h.miterLimit)),e.setAttributeNS(null,"stroke-linecap",h.lineCap),e.setAttributeNS(null,"stroke-linejoin",h.lineJoin),e.setAttributeNS(null,"stroke-width",c(n*h.lineWidth)+"px"),e.setAttributeNS(null,"stroke-dasharray",o.map(c).join(" ")),e.setAttributeNS(null,"stroke-dashoffset",c(n*h.dashPhase)+"px")}eoFill(){var e;(e=this.current.element)==null||e.setAttributeNS(null,"fill-rule","evenodd"),this.fill()}fillStroke(){this.stroke(),this.fill()}eoFillStroke(){var e;(e=this.current.element)==null||e.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()}closeStroke(){this.closePath(),this.stroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.closePath(),this.eoFillStroke()}paintSolidColorImageMask(){const e=this.svgFactory.createElement("svg:rect");e.setAttributeNS(null,"x","0"),e.setAttributeNS(null,"y","0"),e.setAttributeNS(null,"width","1px"),e.setAttributeNS(null,"height","1px"),e.setAttributeNS(null,"fill",this.current.fillColor),this._ensureTransformGroup().append(e)}paintImageXObject(e){const n=this.getObject(e);if(!n){(0,A.warn)(`Dependent image with object ID ${e} is not ready yet`);return}this.paintInlineImageXObject(n)}paintInlineImageXObject(e,n){const h=e.width,o=e.height,d=P(e,this.forceDataSchema,!!n),F=this.svgFactory.createElement("svg:rect");F.setAttributeNS(null,"x","0"),F.setAttributeNS(null,"y","0"),F.setAttributeNS(null,"width",c(h)),F.setAttributeNS(null,"height",c(o)),this.current.element=F,this.clip("nonzero");const s=this.svgFactory.createElement("svg:image");s.setAttributeNS(M,"xlink:href",d),s.setAttributeNS(null,"x","0"),s.setAttributeNS(null,"y",c(-o)),s.setAttributeNS(null,"width",c(h)+"px"),s.setAttributeNS(null,"height",c(o)+"px"),s.setAttributeNS(null,"transform",`scale(${c(1/h)} ${c(-1/o)})`),n?n.append(s):this._ensureTransformGroup().append(s)}paintImageMaskXObject(e){const n=this.getObject(e.data,e);if(n.bitmap){(0,A.warn)("paintImageMaskXObject: ImageBitmap support is not implemented, ensure that the `isOffscreenCanvasSupported` API parameter is disabled.");return}const h=this.current,o=n.width,d=n.height,F=h.fillColor;h.maskId=`mask${C++}`;const s=this.svgFactory.createElement("svg:mask");s.setAttributeNS(null,"id",h.maskId);const B=this.svgFactory.createElement("svg:rect");B.setAttributeNS(null,"x","0"),B.setAttributeNS(null,"y","0"),B.setAttributeNS(null,"width",c(o)),B.setAttributeNS(null,"height",c(d)),B.setAttributeNS(null,"fill",F),B.setAttributeNS(null,"mask",`url(#${h.maskId})`),this.defs.append(s),this._ensureTransformGroup().append(B),this.paintInlineImageXObject(n,s)}paintFormXObjectBegin(e,n){if(Array.isArray(e)&&e.length===6&&this.transform(e[0],e[1],e[2],e[3],e[4],e[5]),n){const h=n[2]-n[0],o=n[3]-n[1],d=this.svgFactory.createElement("svg:rect");d.setAttributeNS(null,"x",n[0]),d.setAttributeNS(null,"y",n[1]),d.setAttributeNS(null,"width",c(h)),d.setAttributeNS(null,"height",c(o)),this.current.element=d,this.clip("nonzero"),this.endPath()}}paintFormXObjectEnd(){}_initialize(e){const n=this.svgFactory.create(e.width,e.height),h=this.svgFactory.createElement("svg:defs");n.append(h),this.defs=h;const o=this.svgFactory.createElement("svg:g");return o.setAttributeNS(null,"transform",_(e.transform)),n.append(o),this.svg=o,n}_ensureClipGroup(){if(!this.current.clipGroup){const e=this.svgFactory.createElement("svg:g");e.setAttributeNS(null,"clip-path",this.current.activeClipUrl),this.svg.append(e),this.current.clipGroup=e}return this.current.clipGroup}_ensureTransformGroup(){return this.tgrp||(this.tgrp=this.svgFactory.createElement("svg:g"),this.tgrp.setAttributeNS(null,"transform",_(this.transformMatrix)),this.current.activeClipUrl?this._ensureClipGroup().append(this.tgrp):this.svg.append(this.tgrp)),this.tgrp}}}}],__webpack_module_cache__={};function __w_pdfjs_require__(R){var i=__webpack_module_cache__[R];if(i!==void 0)return i.exports;var U=__webpack_module_cache__[R]={exports:{}};return __webpack_modules__[R](U,U.exports,__w_pdfjs_require__),U.exports}var __webpack_exports__={};return(()=>{var R=__webpack_exports__;Object.defineProperty(R,"__esModule",{value:!0}),Object.defineProperty(R,"AbortException",{enumerable:!0,get:function(){return i.AbortException}}),Object.defineProperty(R,"AnnotationEditorLayer",{enumerable:!0,get:function(){return G.AnnotationEditorLayer}}),Object.defineProperty(R,"AnnotationEditorParamsType",{enumerable:!0,get:function(){return i.AnnotationEditorParamsType}}),Object.defineProperty(R,"AnnotationEditorType",{enumerable:!0,get:function(){return i.AnnotationEditorType}}),Object.defineProperty(R,"AnnotationEditorUIManager",{enumerable:!0,get:function(){return q.AnnotationEditorUIManager}}),Object.defineProperty(R,"AnnotationLayer",{enumerable:!0,get:function(){return Z.AnnotationLayer}}),Object.defineProperty(R,"AnnotationMode",{enumerable:!0,get:function(){return i.AnnotationMode}}),Object.defineProperty(R,"CMapCompressionType",{enumerable:!0,get:function(){return i.CMapCompressionType}}),Object.defineProperty(R,"FeatureTest",{enumerable:!0,get:function(){return i.FeatureTest}}),Object.defineProperty(R,"GlobalWorkerOptions",{enumerable:!0,get:function(){return L.GlobalWorkerOptions}}),Object.defineProperty(R,"InvalidPDFException",{enumerable:!0,get:function(){return i.InvalidPDFException}}),Object.defineProperty(R,"MissingPDFException",{enumerable:!0,get:function(){return i.MissingPDFException}}),Object.defineProperty(R,"OPS",{enumerable:!0,get:function(){return i.OPS}}),Object.defineProperty(R,"PDFDataRangeTransport",{enumerable:!0,get:function(){return U.PDFDataRangeTransport}}),Object.defineProperty(R,"PDFDateString",{enumerable:!0,get:function(){return l.PDFDateString}}),Object.defineProperty(R,"PDFWorker",{enumerable:!0,get:function(){return U.PDFWorker}}),Object.defineProperty(R,"PasswordResponses",{enumerable:!0,get:function(){return i.PasswordResponses}}),Object.defineProperty(R,"PermissionFlag",{enumerable:!0,get:function(){return i.PermissionFlag}}),Object.defineProperty(R,"PixelsPerInch",{enumerable:!0,get:function(){return l.PixelsPerInch}}),Object.defineProperty(R,"PromiseCapability",{enumerable:!0,get:function(){return i.PromiseCapability}}),Object.defineProperty(R,"RenderingCancelledException",{enumerable:!0,get:function(){return l.RenderingCancelledException}}),Object.defineProperty(R,"SVGGraphics",{enumerable:!0,get:function(){return M.SVGGraphics}}),Object.defineProperty(R,"UnexpectedResponseException",{enumerable:!0,get:function(){return i.UnexpectedResponseException}}),Object.defineProperty(R,"Util",{enumerable:!0,get:function(){return i.Util}}),Object.defineProperty(R,"VerbosityLevel",{enumerable:!0,get:function(){return i.VerbosityLevel}}),Object.defineProperty(R,"XfaLayer",{enumerable:!0,get:function(){return v.XfaLayer}}),Object.defineProperty(R,"build",{enumerable:!0,get:function(){return U.build}}),Object.defineProperty(R,"createValidAbsoluteUrl",{enumerable:!0,get:function(){return i.createValidAbsoluteUrl}}),Object.defineProperty(R,"getDocument",{enumerable:!0,get:function(){return U.getDocument}}),Object.defineProperty(R,"getFilenameFromUrl",{enumerable:!0,get:function(){return l.getFilenameFromUrl}}),Object.defineProperty(R,"getPdfFilenameFromUrl",{enumerable:!0,get:function(){return l.getPdfFilenameFromUrl}}),Object.defineProperty(R,"getXfaPageViewport",{enumerable:!0,get:function(){return l.getXfaPageViewport}}),Object.defineProperty(R,"isDataScheme",{enumerable:!0,get:function(){return l.isDataScheme}}),Object.defineProperty(R,"isPdfFile",{enumerable:!0,get:function(){return l.isPdfFile}}),Object.defineProperty(R,"loadScript",{enumerable:!0,get:function(){return l.loadScript}}),Object.defineProperty(R,"normalizeUnicode",{enumerable:!0,get:function(){return i.normalizeUnicode}}),Object.defineProperty(R,"renderTextLayer",{enumerable:!0,get:function(){return A.renderTextLayer}}),Object.defineProperty(R,"setLayerDimensions",{enumerable:!0,get:function(){return l.setLayerDimensions}}),Object.defineProperty(R,"shadow",{enumerable:!0,get:function(){return i.shadow}}),Object.defineProperty(R,"updateTextLayer",{enumerable:!0,get:function(){return A.updateTextLayer}}),Object.defineProperty(R,"version",{enumerable:!0,get:function(){return U.version}});var i=__w_pdfjs_require__(1),U=__w_pdfjs_require__(2),l=__w_pdfjs_require__(6),A=__w_pdfjs_require__(26),G=__w_pdfjs_require__(27),q=__w_pdfjs_require__(5),Z=__w_pdfjs_require__(32),L=__w_pdfjs_require__(14),M=__w_pdfjs_require__(35),v=__w_pdfjs_require__(34)})(),__webpack_exports__})())})(pdf$1);var pdfExports=pdf$1.exports;const pdf=getDefaultExportFromCjs(pdfExports),pdfjs=_mergeNamespaces({__proto__:null,default:pdf},[pdfExports]);var __spreadArray=globalThis&&globalThis.__spreadArray||function(R,i,U){if(U||arguments.length===2)for(var l=0,A=i.length,G;l<A;l++)(G||!(l in i))&&(G||(G=Array.prototype.slice.call(i,0,l)),G[l]=i[l]);return R.concat(G||Array.prototype.slice.call(i))},clipboardEvents=["onCopy","onCut","onPaste"],compositionEvents=["onCompositionEnd","onCompositionStart","onCompositionUpdate"],focusEvents=["onFocus","onBlur"],formEvents=["onInput","onInvalid","onReset","onSubmit"],imageEvents=["onLoad","onError"],keyboardEvents=["onKeyDown","onKeyPress","onKeyUp"],mediaEvents=["onAbort","onCanPlay","onCanPlayThrough","onDurationChange","onEmptied","onEncrypted","onEnded","onError","onLoadedData","onLoadedMetadata","onLoadStart","onPause","onPlay","onPlaying","onProgress","onRateChange","onSeeked","onSeeking","onStalled","onSuspend","onTimeUpdate","onVolumeChange","onWaiting"],mouseEvents=["onClick","onContextMenu","onDoubleClick","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp"],dragEvents=["onDrag","onDragEnd","onDragEnter","onDragExit","onDragLeave","onDragOver","onDragStart","onDrop"],selectionEvents=["onSelect"],touchEvents=["onTouchCancel","onTouchEnd","onTouchMove","onTouchStart"],pointerEvents=["onPointerDown","onPointerMove","onPointerUp","onPointerCancel","onGotPointerCapture","onLostPointerCapture","onPointerEnter","onPointerLeave","onPointerOver","onPointerOut"],uiEvents=["onScroll"],wheelEvents=["onWheel"],animationEvents=["onAnimationStart","onAnimationEnd","onAnimationIteration"],transitionEvents=["onTransitionEnd"],otherEvents=["onToggle"],changeEvents=["onChange"],allEvents=__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray([],clipboardEvents,!0),compositionEvents,!0),focusEvents,!0),formEvents,!0),imageEvents,!0),keyboardEvents,!0),mediaEvents,!0),mouseEvents,!0),dragEvents,!0),selectionEvents,!0),touchEvents,!0),pointerEvents,!0),uiEvents,!0),wheelEvents,!0),animationEvents,!0),transitionEvents,!0),changeEvents,!0),otherEvents,!0);function makeEventProps(R,i){var U={};return allEvents.forEach(function(l){var A=R[l];A&&(i?U[l]=function(G){return A(G,i(l))}:U[l]=A)}),U}function makeCancellablePromise(R){var i=!1,U=new Promise(function(l,A){R.then(function(G){return!i&&l(G)}).catch(function(G){return!i&&A(G)})});return{promise:U,cancel:function(){i=!0}}}function r(R){var i,U,l="";if(typeof R=="string"||typeof R=="number")l+=R;else if(typeof R=="object")if(Array.isArray(R))for(i=0;i<R.length;i++)R[i]&&(U=r(R[i]))&&(l&&(l+=" "),l+=U);else for(i in R)R[i]&&(l&&(l+=" "),l+=i);return l}function clsx(){for(var R,i,U=0,l="";U<arguments.length;)(R=arguments[U++])&&(i=r(R))&&(l&&(l+=" "),l+=i);return l}var isProduction$1=!0,prefix="Invariant failed";function invariant(R,i){if(!R){if(isProduction$1)throw new Error(prefix);var U=typeof i=="function"?i():i,l=U?"".concat(prefix,": ").concat(U):prefix;throw new Error(l)}}var isProduction=!0;function warning(R,i){if(!isProduction){if(R)return;var U="Warning: "+i;typeof console<"u"&&console.warn(U);try{throw Error(U)}catch{}}}const DocumentContext=reactExports.createContext(null);function Message({children:R,type:i}){return React.createElement("div",{className:`react-pdf__message react-pdf__message--${i}`},R)}Message.propTypes={children:PropTypes.node,type:PropTypes.oneOf(["error","loading","no-data"]).isRequired};const DEFAULT_LINK_REL="noopener noreferrer nofollow";class LinkService{constructor(){this.externalLinkEnabled=!0,this.externalLinkRel=void 0,this.externalLinkTarget=void 0,this.isInPresentationMode=!1,this.pdfDocument=void 0,this.pdfViewer=void 0}setDocument(i){this.pdfDocument=i}setViewer(i){this.pdfViewer=i}setExternalLinkRel(i){this.externalLinkRel=i}setExternalLinkTarget(i){this.externalLinkTarget=i}setHistory(){}get pagesCount(){return this.pdfDocument?this.pdfDocument.numPages:0}get page(){return invariant(this.pdfViewer,"PDF viewer is not initialized."),this.pdfViewer.currentPageNumber||0}set page(i){invariant(this.pdfViewer,"PDF viewer is not initialized."),this.pdfViewer.currentPageNumber=i}get rotation(){return 0}set rotation(i){}goToDestination(i){return new Promise(U=>{invariant(this.pdfDocument,"PDF document not loaded."),invariant(i,"Destination is not specified."),typeof i=="string"?this.pdfDocument.getDestination(i).then(U):Array.isArray(i)?U(i):i.then(U)}).then(U=>{invariant(Array.isArray(U),`"${U}" is not a valid destination array.`);const l=U[0];new Promise(A=>{invariant(this.pdfDocument,"PDF document not loaded."),l instanceof Object?this.pdfDocument.getPageIndex(l).then(G=>{A(G)}).catch(()=>{invariant(!1,`"${l}" is not a valid page reference.`)}):typeof l=="number"?A(l):invariant(!1,`"${l}" is not a valid destination reference.`)}).then(A=>{const G=A+1;invariant(this.pdfViewer,"PDF viewer is not initialized."),invariant(G>=1&&G<=this.pagesCount,`"${G}" is not a valid page number.`),this.pdfViewer.scrollPageIntoView({dest:U,pageIndex:A,pageNumber:G})})})}navigateTo(i){this.goToDestination(i)}goToPage(i){const U=i-1;invariant(this.pdfViewer,"PDF viewer is not initialized."),invariant(i>=1&&i<=this.pagesCount,`"${i}" is not a valid page number.`),this.pdfViewer.scrollPageIntoView({pageIndex:U,pageNumber:i})}addLinkAttributes(i,U,l){i.href=U,i.rel=this.externalLinkRel||DEFAULT_LINK_REL,i.target=l?"_blank":this.externalLinkTarget||""}getDestinationHash(){return"#"}getAnchorUrl(){return"#"}setHash(){}executeNamedAction(){}cachePageRef(){}isPageVisible(){return!0}isPageCached(){return!0}executeSetOCGState(){}}const PasswordResponses={NEED_PASSWORD:1,INCORRECT_PASSWORD:2},PasswordResponses$1=PasswordResponses,isBrowser=typeof document<"u",isLocalFileSystem=isBrowser&&window.location.protocol==="file:";function isDefined(R){return typeof R<"u"}function isProvided(R){return isDefined(R)&&R!==null}function isString(R){return typeof R=="string"}function isArrayBuffer(R){return R instanceof ArrayBuffer}function isBlob(R){return invariant(isBrowser,"isBlob can only be used in a browser environment"),R instanceof Blob}function isDataURI(R){return isString(R)&&/^data:/.test(R)}function dataURItoByteString(R){invariant(isDataURI(R),"Invalid data URI.");const[i="",U=""]=R.split(",");return i.split(";").indexOf("base64")!==-1?atob(U):unescape(U)}function getDevicePixelRatio(){return isBrowser&&window.devicePixelRatio||1}const allowFileAccessFromFilesTip="On Chromium based browsers, you can use --allow-file-access-from-files flag for debugging purposes.";function displayCORSWarning(){warning(!isLocalFileSystem,`Loading PDF as base64 strings/URLs may not work on protocols other than HTTP/HTTPS. ${allowFileAccessFromFilesTip}`)}function displayWorkerWarning(){warning(!isLocalFileSystem,`Loading PDF.js worker may not work on protocols other than HTTP/HTTPS. ${allowFileAccessFromFilesTip}`)}function cancelRunningTask(R){R&&R.cancel&&R.cancel()}function makePageCallback(R,i){return Object.defineProperty(R,"width",{get(){return this.view[2]*i},configurable:!0}),Object.defineProperty(R,"height",{get(){return this.view[3]*i},configurable:!0}),Object.defineProperty(R,"originalWidth",{get(){return this.view[2]},configurable:!0}),Object.defineProperty(R,"originalHeight",{get(){return this.view[3]},configurable:!0}),R}function isCancelException(R){return R.name==="RenderingCancelledException"}function loadFromFile(R){return new Promise((i,U)=>{const l=new FileReader;l.onload=()=>{if(!l.result)return U(new Error("Error while reading a file."));i(l.result)},l.onerror=A=>{if(!A.target)return U(new Error("Error while reading a file."));const{error:G}=A.target;if(!G)return U(new Error("Error while reading a file."));switch(G.code){case G.NOT_FOUND_ERR:return U(new Error("Error while reading a file: File not found."));case G.SECURITY_ERR:return U(new Error("Error while reading a file: Security error."));case G.ABORT_ERR:return U(new Error("Error while reading a file: Aborted."));default:return U(new Error("Error while reading a file."))}},l.readAsArrayBuffer(R)})}function reducer(R,i){switch(i.type){case"RESOLVE":return{value:i.value,error:void 0};case"REJECT":return{value:!1,error:i.error};case"RESET":return{value:void 0,error:void 0};default:return R}}function useResolver(){return reactExports.useReducer(reducer,{value:void 0,error:void 0})}const eventProps=(()=>{const R={};return allEvents.forEach(i=>{R[i]=PropTypes.func}),R})(),isTypedArray=PropTypes.oneOfType([PropTypes.instanceOf(Int8Array),PropTypes.instanceOf(Uint8Array),PropTypes.instanceOf(Uint8ClampedArray),PropTypes.instanceOf(Int16Array),PropTypes.instanceOf(Uint16Array),PropTypes.instanceOf(Int32Array),PropTypes.instanceOf(Uint32Array),PropTypes.instanceOf(Float32Array),PropTypes.instanceOf(Float64Array)]),fileTypes=[PropTypes.string,PropTypes.instanceOf(ArrayBuffer),PropTypes.shape({data:PropTypes.oneOfType([PropTypes.string,PropTypes.instanceOf(ArrayBuffer),PropTypes.arrayOf(PropTypes.number.isRequired),isTypedArray]).isRequired}),PropTypes.shape({range:PropTypes.instanceOf(pdfExports.PDFDataRangeTransport).isRequired}),PropTypes.shape({url:PropTypes.string.isRequired})];typeof Blob<"u"&&fileTypes.push(PropTypes.instanceOf(Blob));const isClassName=PropTypes.oneOfType([PropTypes.string,PropTypes.arrayOf(PropTypes.string)]),isFile=PropTypes.oneOfType(fileTypes);PropTypes.instanceOf(LinkService);PropTypes.oneOf(["_self","_blank","_parent","_top"]);PropTypes.shape({commonObjs:PropTypes.shape({}).isRequired,getAnnotations:PropTypes.func.isRequired,getTextContent:PropTypes.func.isRequired,getViewport:PropTypes.func.isRequired,render:PropTypes.func.isRequired});const isPageIndex=function R(i,U,l){const{[U]:A,pageNumber:G,pdf:q}=i;if(!isDefined(q))return null;if(isDefined(A)){if(typeof A!="number")return new Error(`\`${U}\` of type \`${typeof A}\` supplied to \`${l}\`, expected \`number\`.`);if(A<0)return new Error(`Expected \`${U}\` to be greater or equal to 0.`);const{numPages:Z}=q;if(A+1>Z)return new Error(`Expected \`${U}\` to be less or equal to ${Z-1}.`)}else if(!isDefined(G))return new Error(`\`${U}\` not supplied. Either pageIndex or pageNumber must be supplied to \`${l}\`.`);return null},isPageNumber=function R(i,U,l){const{[U]:A,pageIndex:G,pdf:q}=i;if(!isDefined(q))return null;if(isDefined(A)){if(typeof A!="number")return new Error(`\`${U}\` of type \`${typeof A}\` supplied to \`${l}\`, expected \`number\`.`);if(A<1)return new Error(`Expected \`${U}\` to be greater or equal to 1.`);const{numPages:Z}=q;if(A>Z)return new Error(`Expected \`${U}\` to be less or equal to ${Z}.`)}else if(!isDefined(G))return new Error(`\`${U}\` not supplied. Either pageIndex or pageNumber must be supplied to \`${l}\`.`);return null},isPdf=PropTypes.oneOfType([PropTypes.shape({getDestination:PropTypes.func.isRequired,getOutline:PropTypes.func.isRequired,getPage:PropTypes.func.isRequired,numPages:PropTypes.number.isRequired}),PropTypes.bool]),isRef=PropTypes.oneOfType([PropTypes.func,PropTypes.exact({current:PropTypes.any})]),isRenderMode=PropTypes.oneOf(["canvas","none","svg"]),isRotate=PropTypes.oneOf([0,90,180,270]);var __awaiter=globalThis&&globalThis.__awaiter||function(R,i,U,l){function A(G){return G instanceof U?G:new U(function(q){q(G)})}return new(U||(U=Promise))(function(G,q){function Z(v){try{M(l.next(v))}catch(N){q(N)}}function L(v){try{M(l.throw(v))}catch(N){q(N)}}function M(v){v.done?G(v.value):A(v.value).then(Z,L)}M((l=l.apply(R,i||[])).next())})},__rest$1=globalThis&&globalThis.__rest||function(R,i){var U={};for(var l in R)Object.prototype.hasOwnProperty.call(R,l)&&i.indexOf(l)<0&&(U[l]=R[l]);if(R!=null&&typeof Object.getOwnPropertySymbols=="function")for(var A=0,l=Object.getOwnPropertySymbols(R);A<l.length;A++)i.indexOf(l[A])<0&&Object.prototype.propertyIsEnumerable.call(R,l[A])&&(U[l[A]]=R[l[A]]);return U};const{PDFDataRangeTransport}=pdfjs,defaultOnPassword=(R,i)=>{switch(i){case PasswordResponses$1.NEED_PASSWORD:{const U=prompt("Enter the password to open this PDF file.");R(U);break}case PasswordResponses$1.INCORRECT_PASSWORD:{const U=prompt("Invalid password. Please try again.");R(U);break}}},Document=reactExports.forwardRef(function R(i,U){var{children:l,className:A,error:G="Failed to load PDF file.",externalLinkRel:q,externalLinkTarget:Z,file:L,inputRef:M,imageResourcesPath:v,loading:N="Loading PDF…",noData:w="No PDF file specified.",onItemClick:P,onLoadError:p,onLoadProgress:f,onLoadSuccess:c,onPassword:_=defaultOnPassword,onSourceError:E,onSourceSuccess:C,options:m,renderMode:e,rotate:n}=i,h=__rest$1(i,["children","className","error","externalLinkRel","externalLinkTarget","file","inputRef","imageResourcesPath","loading","noData","onItemClick","onLoadError","onLoadProgress","onLoadSuccess","onPassword","onSourceError","onSourceSuccess","options","renderMode","rotate"]);const[o,d]=useResolver(),{value:F,error:s}=o,[B,V]=useResolver(),{value:Y,error:Q}=B,et=reactExports.useRef(new LinkService),ut=reactExports.useRef([]),lt=reactExports.useRef({scrollPageIntoView:t=>{const{dest:a,pageNumber:b,pageIndex:S=b-1}=t;if(P){P({dest:a,pageIndex:S,pageNumber:b});return}const T=ut.current[S];if(T){T.scrollIntoView();return}warning(!1,`An internal link leading to page ${b} was clicked, but neither <Document> was provided with onItemClick nor it was able to find the page within itself. Either provide onItemClick to <Document> and handle navigating by yourself or ensure that all pages are rendered within <Document>.`)}});reactExports.useImperativeHandle(U,()=>({linkService:et,pages:ut,viewer:lt}),[]);function ht(){C&&C()}function mt(){s&&(warning(!1,s.toString()),E&&E(s))}function At(){d({type:"RESET"})}reactExports.useEffect(At,[L,d]);const Et=reactExports.useCallback(()=>__awaiter(this,void 0,void 0,function*(){if(!L)return null;if(typeof L=="string")return isDataURI(L)?{data:dataURItoByteString(L)}:(displayCORSWarning(),{url:L});if(L instanceof PDFDataRangeTransport)return{range:L};if(isArrayBuffer(L))return{data:L};if(isBrowser&&isBlob(L))return{data:yield loadFromFile(L)};if(invariant(typeof L=="object","Invalid parameter in file, need either Uint8Array, string or a parameter object"),invariant("data"in L||"range"in L||"url"in L,"Invalid parameter object: need either .data, .range or .url"),"url"in L&&typeof L.url=="string"){if(isDataURI(L.url)){const{url:t}=L,a=__rest$1(L,["url"]),b=dataURItoByteString(t);return Object.assign({data:b},a)}displayCORSWarning()}return L}),[L]);reactExports.useEffect(()=>{const t=makeCancellablePromise(Et());return t.promise.then(a=>{d({type:"RESOLVE",value:a})}).catch(a=>{d({type:"REJECT",error:a})}),()=>{cancelRunningTask(t)}},[Et,d]),reactExports.useEffect(()=>{if(!(typeof F>"u")){if(F===!1){mt();return}ht()}},[F]);function _t(){Y&&(c&&c(Y),ut.current=new Array(Y.numPages),et.current.setDocument(Y))}function z(){Q&&(warning(!1,Q.toString()),p&&p(Q))}function u(){V({type:"RESET"})}reactExports.useEffect(u,[V,F]);function g(){if(!F)return;const t=m?Object.assign(Object.assign({},F),m):F,a=pdfExports.getDocument(t);f&&(a.onProgress=f),_&&(a.onPassword=_);const b=a;return b.promise.then(S=>{V({type:"RESOLVE",value:S})}).catch(S=>{b.destroyed||V({type:"REJECT",error:S})}),()=>{b.destroy()}}reactExports.useEffect(g,[m,V,F]),reactExports.useEffect(()=>{if(!(typeof Y>"u")){if(Y===!1){z();return}_t()}},[Y]);function x(){et.current.setViewer(lt.current),et.current.setExternalLinkRel(q),et.current.setExternalLinkTarget(Z)}reactExports.useEffect(x,[q,Z]);function H(t,a){ut.current[t]=a}function D(t){delete ut.current[t]}const X=reactExports.useMemo(()=>({imageResourcesPath:v,linkService:et.current,onItemClick:P,pdf:Y,registerPage:H,renderMode:e,rotate:n,unregisterPage:D}),[v,P,Y,e,n]),W=reactExports.useMemo(()=>makeEventProps(h,()=>Y),[h,Y]);function O(){return React.createElement(DocumentContext.Provider,{value:X},l)}function I(){return L?Y==null?React.createElement(Message,{type:"loading"},typeof N=="function"?N():N):Y===!1?React.createElement(Message,{type:"error"},typeof G=="function"?G():G):O():React.createElement(Message,{type:"no-data"},typeof w=="function"?w():w)}return React.createElement("div",Object.assign({className:clsx("react-pdf__Document",A),ref:M,style:{["--scale-factor"]:"1"}},W),I())}),isFunctionOrNode$1=PropTypes.oneOfType([PropTypes.func,PropTypes.node]);Document.propTypes=Object.assign(Object.assign({},eventProps),{children:PropTypes.node,className:isClassName,error:isFunctionOrNode$1,externalLinkRel:PropTypes.string,externalLinkTarget:PropTypes.oneOf(["_self","_blank","_parent","_top"]),file:isFile,imageResourcesPath:PropTypes.string,inputRef:isRef,loading:isFunctionOrNode$1,noData:isFunctionOrNode$1,onItemClick:PropTypes.func,onLoadError:PropTypes.func,onLoadProgress:PropTypes.func,onLoadSuccess:PropTypes.func,onPassword:PropTypes.func,onSourceError:PropTypes.func,onSourceSuccess:PropTypes.func,options:PropTypes.shape({canvasFactory:PropTypes.any,canvasMaxAreaInBytes:PropTypes.number,cMapPacked:PropTypes.bool,CMapReaderFactory:PropTypes.any,cMapUrl:PropTypes.string,disableAutoFetch:PropTypes.bool,disableFontFace:PropTypes.bool,disableRange:PropTypes.bool,disableStream:PropTypes.bool,docBaseUrl:PropTypes.string,enableXfa:PropTypes.bool,filterFactory:PropTypes.any,fontExtraProperties:PropTypes.bool,httpHeaders:PropTypes.object,isEvalSupported:PropTypes.bool,isOffscreenCanvasSupported:PropTypes.bool,length:PropTypes.number,maxImageSize:PropTypes.number,ownerDocument:PropTypes.any,password:PropTypes.string,pdfBug:PropTypes.bool,rangeChunkSize:PropTypes.number,StandardFontDataFactory:PropTypes.any,standardFontDataUrl:PropTypes.string,stopAtErrors:PropTypes.bool,useSystemFonts:PropTypes.bool,useWorkerFetch:PropTypes.bool,verbosity:PropTypes.number,withCredentials:PropTypes.bool,worker:PropTypes.any}),rotate:PropTypes.number});const Document$1=Document;function useDocumentContext(){return reactExports.useContext(DocumentContext)}function mergeRefs(){for(var R=[],i=0;i<arguments.length;i++)R[i]=arguments[i];var U=R.filter(Boolean);if(U.length<=1){var l=U[0];return l||null}return function(G){U.forEach(function(q){typeof q=="function"?q(G):q&&(q.current=G)})}}const PageContext=reactExports.createContext(null),PDF_ROLE_TO_HTML_ROLE={Document:null,DocumentFragment:null,Part:"group",Sect:"group",Div:"group",Aside:"note",NonStruct:"none",P:null,H:"heading",Title:null,FENote:"note",Sub:"group",Lbl:null,Span:null,Em:null,Strong:null,Link:"link",Annot:"note",Form:"form",Ruby:null,RB:null,RT:null,RP:null,Warichu:null,WT:null,WP:null,L:"list",LI:"listitem",LBody:null,Table:"table",TR:"row",TH:"columnheader",TD:"cell",THead:"columnheader",TBody:null,TFoot:null,Caption:null,Figure:"figure",Formula:null,Artifact:null},HEADING_PATTERN=/^H(\d+)$/;function isPdfRole(R){return R in PDF_ROLE_TO_HTML_ROLE}function isStructTreeNode(R){return"children"in R}function isStructTreeNodeWithOnlyContentChild(R){return isStructTreeNode(R)?R.children.length===1&&0 in R.children&&"id"in R.children[0]:!1}function getRoleAttributes(R){const i={};if(isStructTreeNode(R)){const{role:U}=R,l=U.match(HEADING_PATTERN);if(l)i.role="heading",i["aria-level"]=Number(l[1]);else if(isPdfRole(U)){const A=PDF_ROLE_TO_HTML_ROLE[U];A&&(i.role=A)}}return i}function getBaseAttributes(R){const i={};if(isStructTreeNode(R)){if(R.alt!==void 0&&(i["aria-label"]=R.alt),R.lang!==void 0&&(i.lang=R.lang),isStructTreeNodeWithOnlyContentChild(R)){const[U]=R.children;if(U){const l=getBaseAttributes(U);return Object.assign(Object.assign({},i),l)}}}else"id"in R&&(i["aria-owns"]=R.id);return i}function getAttributes(R){return R?Object.assign(Object.assign({},getRoleAttributes(R)),getBaseAttributes(R)):null}function StructTreeItem({className:R,node:i}){const U=reactExports.useMemo(()=>getAttributes(i),[i]),l=reactExports.useMemo(()=>!isStructTreeNode(i)||isStructTreeNodeWithOnlyContentChild(i)?null:i.children.map((A,G)=>React.createElement(StructTreeItem,{key:G,node:A})),[i]);return React.createElement("span",Object.assign({className:R},U),l)}StructTreeItem.propTypes={node:PropTypes.oneOfType([PropTypes.shape({children:PropTypes.object,role:PropTypes.string}),PropTypes.shape({id:PropTypes.string,type:PropTypes.string})]).isRequired};function usePageContext(){return reactExports.useContext(PageContext)}function StructTree(){const R=usePageContext();invariant(R,"Unable to find Page context.");const{onGetStructTreeError:i,onGetStructTreeSuccess:U}=R,[l,A]=useResolver(),{value:G,error:q}=l,{customTextRenderer:Z,page:L}=R;function M(){G&&U&&U(G)}function v(){q&&(warning(!1,q.toString()),i&&i(q))}function N(){A({type:"RESET"})}reactExports.useEffect(N,[A,L]);function w(){if(Z||!L)return;const P=makeCancellablePromise(L.getStructTree()),p=P;return P.promise.then(f=>{A({type:"RESOLVE",value:f})}).catch(f=>{A({type:"REJECT",error:f})}),()=>cancelRunningTask(p)}return reactExports.useEffect(w,[Z,L,A]),reactExports.useEffect(()=>{if(G!==void 0){if(G===!1){v();return}M()}},[G]),G?React.createElement(StructTreeItem,{className:"react-pdf__Page__structTree structTree",node:G}):null}const ANNOTATION_MODE=pdfExports.AnnotationMode;function PageCanvas(R){const i=usePageContext();invariant(i,"Unable to find Page context.");const U=Object.assign(Object.assign({},i),R),{_className:l,canvasBackground:A,devicePixelRatio:G,onRenderError:q,onRenderSuccess:Z,page:L,renderForms:M,renderTextLayer:v,rotate:N,scale:w}=U,{canvasRef:P}=R,p=reactExports.useRef(null);invariant(L,"Attempted to render page canvas, but no page was specified.");const f=G||getDevicePixelRatio();function c(){L&&Z&&Z(makePageCallback(L,w))}function _(n){isCancelException(n)||(warning(!1,n.toString()),q&&q(n))}const E=reactExports.useMemo(()=>L.getViewport({scale:w*f,rotation:N}),[f,L,N,w]),C=reactExports.useMemo(()=>L.getViewport({scale:w,rotation:N}),[L,N,w]);function m(){if(!L)return;L.cleanup();const{current:n}=p;if(!n)return;n.width=E.width,n.height=E.height,n.style.width=`${Math.floor(C.width)}px`,n.style.height=`${Math.floor(C.height)}px`,n.style.visibility="hidden";const h={annotationMode:M?ANNOTATION_MODE.ENABLE_FORMS:ANNOTATION_MODE.ENABLE,canvasContext:n.getContext("2d",{alpha:!1}),viewport:E};A&&(h.background=A);const o=L.render(h),d=o;return o.promise.then(()=>{n.style.visibility="",c()}).catch(_),()=>cancelRunningTask(d)}reactExports.useEffect(m,[A,p,f,L,M,E,C]);const e=reactExports.useCallback(()=>{const{current:n}=p;n&&(n.width=0,n.height=0)},[p]);return reactExports.useEffect(()=>e,[e]),React.createElement("canvas",{className:`${l}__canvas`,dir:"ltr",ref:mergeRefs(P,p),style:{display:"block",userSelect:"none"}},v?React.createElement(StructTree,null):null)}PageCanvas.propTypes={canvasRef:isRef};function PageSVG(){const R=usePageContext();invariant(R,"Unable to find Page context.");const{_className:i,onRenderSuccess:U,onRenderError:l,page:A,rotate:G,scale:q}=R,[Z,L]=useResolver(),{value:M,error:v}=Z;invariant(A,"Attempted to render page SVG, but no page was specified.");function N(){A&&U&&U(makePageCallback(A,q))}function w(){v&&(isCancelException(v)||(warning(!1,v.toString()),l&&l(v)))}const P=reactExports.useMemo(()=>A.getViewport({scale:q,rotation:G}),[A,G,q]);function p(){L({type:"RESET"})}reactExports.useEffect(p,[A,L,P]);function f(){if(!A)return;const C=makeCancellablePromise(A.getOperatorList());return C.promise.then(m=>{new pdfExports.SVGGraphics(A.commonObjs,A.objs).getSVG(m,P).then(n=>{L({type:"RESOLVE",value:n})}).catch(n=>{L({type:"REJECT",error:n})})}).catch(m=>{L({type:"REJECT",error:m})}),()=>cancelRunningTask(C)}reactExports.useEffect(f,[A,L,P]),reactExports.useEffect(()=>{if(M!==void 0){if(M===!1){w();return}N()}},[M]);function c(C){if(!C||!M)return;C.firstElementChild||C.appendChild(M);const{width:m,height:e}=P;M.setAttribute("width",`${m}`),M.setAttribute("height",`${e}`)}const{width:_,height:E}=P;return React.createElement("div",{className:`${i}__svg`,ref:C=>c(C),style:{display:"block",backgroundColor:"white",overflow:"hidden",width:_,height:E,userSelect:"none"}})}function isTextItem(R){return"str"in R}function TextLayer(){const R=usePageContext();invariant(R,"Unable to find Page context.");const{customTextRenderer:i,onGetTextError:U,onGetTextSuccess:l,onRenderTextLayerError:A,onRenderTextLayerSuccess:G,page:q,pageIndex:Z,pageNumber:L,rotate:M,scale:v}=R,[N,w]=useResolver(),{value:P,error:p}=N,f=reactExports.useRef(null),c=reactExports.useRef();invariant(q,"Attempted to load page text content, but no page was specified."),warning(parseInt(window.getComputedStyle(document.body).getPropertyValue("--react-pdf-text-layer"),10)===1,"TextLayer styles not found. Read more: https://github.com/wojtekmaj/react-pdf#support-for-text-layer");function _(){P&&l&&l(P)}function E(){p&&(warning(!1,p.toString()),U&&U(p))}function C(){w({type:"RESET"})}reactExports.useEffect(C,[q,w]);function m(){if(!q)return;const s=makeCancellablePromise(q.getTextContent()),B=s;return s.promise.then(V=>{w({type:"RESOLVE",value:V})}).catch(V=>{w({type:"REJECT",error:V})}),()=>cancelRunningTask(B)}reactExports.useEffect(m,[q,w]),reactExports.useEffect(()=>{if(P!==void 0){if(P===!1){E();return}_()}},[P]);const e=reactExports.useCallback(()=>{G&&G()},[G]),n=reactExports.useCallback(s=>{warning(!1,s.toString()),A&&A(s)},[A]);function h(){const s=c.current;s&&s.classList.add("active")}function o(){const s=c.current;s&&s.classList.remove("active")}const d=reactExports.useMemo(()=>q.getViewport({scale:v,rotation:M}),[q,M,v]);function F(){if(!q||!P)return;const{current:s}=f;if(!s)return;s.innerHTML="";const B=q.streamTextContent({includeMarkedContent:!0}),V={container:s,textContentSource:B,viewport:d},Y=pdfExports.renderTextLayer(V),Q=Y;return Y.promise.then(()=>{const et=document.createElement("div");et.className="endOfContent",s.append(et),c.current=et;const lt=!!s.querySelector(".markedContent")?s.querySelectorAll(".markedContent > *:not(.markedContent"):s.children;if(i){let ht=0;P.items.forEach((mt,At)=>{if(!isTextItem(mt))return;const Et=lt[ht];if(!Et)return;const _t=i(Object.assign({pageIndex:Z,pageNumber:L,itemIndex:At},mt));Et.innerHTML=_t,ht+=mt.str&&mt.hasEOL?2:1})}e()}).catch(n),()=>cancelRunningTask(Q)}return reactExports.useLayoutEffect(F,[i,n,e,q,Z,L,P,d]),React.createElement("div",{className:clsx("react-pdf__Page__textContent","textLayer"),onMouseUp:o,onMouseDown:h,ref:f})}function AnnotationLayer(){const R=useDocumentContext();invariant(R,"Unable to find Document context. Did you wrap <Page /> in <Document />?");const i=usePageContext();invariant(i,"Unable to find Page context.");const U=Object.assign(Object.assign({},R),i),{imageResourcesPath:l,linkService:A,onGetAnnotationsError:G,onGetAnnotationsSuccess:q,onRenderAnnotationLayerError:Z,onRenderAnnotationLayerSuccess:L,page:M,pdf:v,renderForms:N,rotate:w,scale:P=1}=U,[p,f]=useResolver(),{value:c,error:_}=p,E=reactExports.useRef(null);invariant(M,"Attempted to load page annotations, but no page was specified."),warning(parseInt(window.getComputedStyle(document.body).getPropertyValue("--react-pdf-annotation-layer"),10)===1,"AnnotationLayer styles not found. Read more: https://github.com/wojtekmaj/react-pdf#support-for-annotations");function C(){c&&q&&q(c)}function m(){_&&(warning(!1,_.toString()),G&&G(_))}function e(){f({type:"RESET"})}reactExports.useEffect(e,[f,M]);function n(){if(!M)return;const s=makeCancellablePromise(M.getAnnotations()),B=s;return s.promise.then(V=>{f({type:"RESOLVE",value:V})}).catch(V=>{f({type:"REJECT",error:V})}),()=>{cancelRunningTask(B)}}reactExports.useEffect(n,[f,M,N]),reactExports.useEffect(()=>{if(c!==void 0){if(c===!1){m();return}C()}},[c]);function h(){L&&L()}function o(s){warning(!1,`${s}`),Z&&Z(s)}const d=reactExports.useMemo(()=>M.getViewport({scale:P,rotation:w}),[M,w,P]);function F(){if(!v||!M||!c)return;const{current:s}=E;if(!s)return;const B=d.clone({dontFlip:!0}),V={annotations:c,annotationStorage:v.annotationStorage,div:s,downloadManager:null,imageResourcesPath:l,linkService:A,page:M,renderForms:N,viewport:B};s.innerHTML="";try{pdfExports.AnnotationLayer.render(V),h()}catch(Y){o(Y)}return()=>{}}return reactExports.useEffect(F,[c,l,A,M,N,d]),React.createElement("div",{className:clsx("react-pdf__Page__annotations","annotationLayer"),ref:E})}var __rest=globalThis&&globalThis.__rest||function(R,i){var U={};for(var l in R)Object.prototype.hasOwnProperty.call(R,l)&&i.indexOf(l)<0&&(U[l]=R[l]);if(R!=null&&typeof Object.getOwnPropertySymbols=="function")for(var A=0,l=Object.getOwnPropertySymbols(R);A<l.length;A++)i.indexOf(l[A])<0&&Object.prototype.propertyIsEnumerable.call(R,l[A])&&(U[l[A]]=R[l[A]]);return U};const defaultScale=1;function Page(R){const i=useDocumentContext();invariant(i,"Unable to find Document context. Did you wrap <Page /> in <Document />?");const U=Object.assign(Object.assign({},i),R),{_className:l="react-pdf__Page",_enableRegisterUnregisterPage:A=!0,canvasBackground:G,canvasRef:q,children:Z,className:L,customTextRenderer:M,devicePixelRatio:v,error:N="Failed to load the page.",height:w,inputRef:P,loading:p="Loading page…",noData:f="No page specified.",onGetAnnotationsError:c,onGetAnnotationsSuccess:_,onGetStructTreeError:E,onGetStructTreeSuccess:C,onGetTextError:m,onGetTextSuccess:e,onLoadError:n,onLoadSuccess:h,onRenderAnnotationLayerError:o,onRenderAnnotationLayerSuccess:d,onRenderError:F,onRenderSuccess:s,onRenderTextLayerError:B,onRenderTextLayerSuccess:V,pageIndex:Y,pageNumber:Q,pdf:et,registerPage:ut,renderAnnotationLayer:lt=!0,renderForms:ht=!1,renderMode:mt="canvas",renderTextLayer:At=!0,rotate:Et,scale:_t=defaultScale,unregisterPage:z,width:u}=U,g=__rest(U,["_className","_enableRegisterUnregisterPage","canvasBackground","canvasRef","children","className","customTextRenderer","devicePixelRatio","error","height","inputRef","loading","noData","onGetAnnotationsError","onGetAnnotationsSuccess","onGetStructTreeError","onGetStructTreeSuccess","onGetTextError","onGetTextSuccess","onLoadError","onLoadSuccess","onRenderAnnotationLayerError","onRenderAnnotationLayerSuccess","onRenderError","onRenderSuccess","onRenderTextLayerError","onRenderTextLayerSuccess","pageIndex","pageNumber","pdf","registerPage","renderAnnotationLayer","renderForms","renderMode","renderTextLayer","rotate","scale","unregisterPage","width"]),[x,H]=useResolver(),{value:D,error:X}=x,W=reactExports.useRef(null);invariant(et,"Attempted to load a page, but no document was specified.");const O=isProvided(Q)?Q-1:Y??null,I=Q??(isProvided(Y)?Y+1:null),t=Et??(D?D.rotate:null),a=reactExports.useMemo(()=>{if(!D)return null;let Tt=1;const K=_t??defaultScale;if(u||w){const yt=D.getViewport({scale:1,rotation:t});u?Tt=u/yt.width:w&&(Tt=w/yt.height)}return K*Tt},[w,D,t,_t,u]);function b(){return()=>{isProvided(O)&&A&&z&&z(O)}}reactExports.useEffect(b,[A,et,O,z]);function S(){if(h){if(!D||!a)return;h(makePageCallback(D,a))}if(A&&ut){if(!isProvided(O)||!W.current)return;ut(O,W.current)}}function T(){X&&(warning(!1,X.toString()),n&&n(X))}function $(){H({type:"RESET"})}reactExports.useEffect($,[H,et,O]);function st(){if(!et||!I)return;const Tt=makeCancellablePromise(et.getPage(I)),K=Tt;return Tt.promise.then(yt=>{H({type:"RESOLVE",value:yt})}).catch(yt=>{H({type:"REJECT",error:yt})}),()=>cancelRunningTask(K)}reactExports.useEffect(st,[H,et,O,I,ut]),reactExports.useEffect(()=>{if(D!==void 0){if(D===!1){T();return}S()}},[D,a]);const J=reactExports.useMemo(()=>D&&isProvided(O)&&I&&isProvided(t)&&isProvided(a)?{_className:l,canvasBackground:G,customTextRenderer:M,devicePixelRatio:v,onGetAnnotationsError:c,onGetAnnotationsSuccess:_,onGetStructTreeError:E,onGetStructTreeSuccess:C,onGetTextError:m,onGetTextSuccess:e,onRenderAnnotationLayerError:o,onRenderAnnotationLayerSuccess:d,onRenderError:F,onRenderSuccess:s,onRenderTextLayerError:B,onRenderTextLayerSuccess:V,page:D,pageIndex:O,pageNumber:I,renderForms:ht,renderTextLayer:At,rotate:t,scale:a}:null,[l,G,M,v,c,_,E,C,m,e,o,d,F,s,B,V,D,O,I,ht,At,t,a]),rt=reactExports.useMemo(()=>makeEventProps(g,()=>D&&(a?makePageCallback(D,a):void 0)),[g,D,a]),ot=`${O}@${a}/${t}`,nt=`${O}/${t}`;function at(){switch(mt){case"none":return null;case"svg":return React.createElement(PageSVG,{key:`${nt}_svg`});case"canvas":default:return React.createElement(PageCanvas,{key:`${ot}_canvas`,canvasRef:q})}}function ft(){return At?React.createElement(TextLayer,{key:`${ot}_text`}):null}function pt(){return lt?React.createElement(AnnotationLayer,{key:`${ot}_annotations`}):null}function xt(){return React.createElement(PageContext.Provider,{value:J},at(),ft(),pt(),Z)}function vt(){return I?et===null||D===void 0||D===null?React.createElement(Message,{type:"loading"},typeof p=="function"?p():p):et===!1||D===!1?React.createElement(Message,{type:"error"},typeof N=="function"?N():N):xt():React.createElement(Message,{type:"no-data"},typeof f=="function"?f():f)}return React.createElement("div",Object.assign({className:clsx(l,L),"data-page-number":I,ref:mergeRefs(P,W),style:{["--scale-factor"]:`${a}`,backgroundColor:G||"white",position:"relative",minWidth:"min-content",minHeight:"min-content"}},rt),vt())}const isFunctionOrNode=PropTypes.oneOfType([PropTypes.func,PropTypes.node]);Page.propTypes=Object.assign(Object.assign({},eventProps),{canvasBackground:PropTypes.string,canvasRef:isRef,children:PropTypes.node,className:isClassName,customTextRenderer:PropTypes.func,devicePixelRatio:PropTypes.number,error:isFunctionOrNode,height:PropTypes.number,imageResourcesPath:PropTypes.string,inputRef:isRef,loading:isFunctionOrNode,noData:isFunctionOrNode,onGetTextError:PropTypes.func,onGetTextSuccess:PropTypes.func,onLoadError:PropTypes.func,onLoadSuccess:PropTypes.func,onRenderError:PropTypes.func,onRenderSuccess:PropTypes.func,onRenderTextLayerError:PropTypes.func,onRenderTextLayerSuccess:PropTypes.func,pageIndex:isPageIndex,pageNumber:isPageNumber,pdf:isPdf,renderAnnotationLayer:PropTypes.bool,renderForms:PropTypes.bool,renderMode:isRenderMode,renderTextLayer:PropTypes.bool,rotate:isRotate,scale:PropTypes.number,width:PropTypes.number});displayWorkerWarning();pdfExports.GlobalWorkerOptions.workerSrc="pdf.worker.js";const GetFileThumbNail=R=>{switch(pdfExports.GlobalWorkerOptions.workerSrc=new URL("/assets/pdf.worker.min-bc10fb5c.js",self.location).toString(),R==null?void 0:R.file_type.split("/")[0]){case"image":return jsxRuntimeExports.jsx("img",{className:"file-preview",src:`/files/${R.file_name}`,alt:"file"});case"application":return jsxRuntimeExports.jsx(Document$1,{file:`/files/${R==null?void 0:R.file_name}`,className:"preview-pdf",children:jsxRuntimeExports.jsx(Page,{renderAnnotationLayer:!1,renderTextLayer:!1,render:!0,height:200,pageNumber:1})});case"video":return jsxRuntimeExports.jsxs("video",{controls:!0,playsInline:!0,className:"file-preview",children:[jsxRuntimeExports.jsx("source",{src:`/files/${R==null?void 0:R.file_name}`,type:R==null?void 0:R.file_type}),jsxRuntimeExports.jsxs("p",{children:["Your browser does not support HTML video. Here is a",jsxRuntimeExports.jsx("a",{href:`/files/${R==null?void 0:R.file_name}`,children:"link to the video"})," instead."]})]});case"audio":return jsxRuntimeExports.jsxs("audio",{controls:!0,className:"file-preview",children:[jsxRuntimeExports.jsx("source",{src:`/files/${R==null?void 0:R.file_name}`,type:R==null?void 0:R.file_type}),jsxRuntimeExports.jsxs("p",{children:["Your browser does not support this audio format. Download",jsxRuntimeExports.jsx("a",{href:`/files/${R==null?void 0:R.file_name}`,children:"the file"})," instead."]})]});default:return jsxRuntimeExports.jsx("div",{})}},previewStyle="",FilePreviewPane=({isPreviewPaneActive:R,setIsPreviewPaneActive:i,setSelectedPreviewFile:U,file:l})=>{var A;return jsxRuntimeExports.jsxs("div",{className:`file-preview-pane ${R?"show-pane":"hide-pane"}`,children:[jsxRuntimeExports.jsxs("div",{style:{display:"flex"},className:"preview-pane__close",children:[jsxRuntimeExports.jsx("h3",{style:{marginRight:"auto"},children:"File preview"}),jsxRuntimeExports.jsx(UilTimes,{className:"close-modal-btn",size:"1.5em",style:{marginLeft:"auto"},onClick:()=>{i(!1),U(!1)}})]}),jsxRuntimeExports.jsx("div",{className:"preview-pane__thumbnail",children:l&&GetFileThumbNail(l)}),jsxRuntimeExports.jsxs("div",{style:{display:"flex"},className:"preview-pane__filename",children:[l&&getFileIcon(l),jsxRuntimeExports.jsx("p",{style:{margin:"auto 1.5em",fontWeight:600},children:l==null?void 0:l.file_name})]}),jsxRuntimeExports.jsxs("div",{className:"preview-pane__description",children:[jsxRuntimeExports.jsx("h3",{children:"Description"}),jsxRuntimeExports.jsx("p",{children:l==null?void 0:l.file_description})]}),jsxRuntimeExports.jsxs("div",{style:{marginTop:"auto"},className:"preview-pane__properties",children:[jsxRuntimeExports.jsx("h3",{children:"Properties"}),jsxRuntimeExports.jsxs("div",{style:{display:"flex"},children:[jsxRuntimeExports.jsx("span",{style:{marginRight:"auto",color:"gray"},children:"Type"}),jsxRuntimeExports.jsx("span",{style:{marginRight:"auto",fontWeight:700},children:(A=l==null?void 0:l.file_type)==null?void 0:A.split("/")[1].toUpperCase()})]}),jsxRuntimeExports.jsxs("div",{style:{display:"flex"},children:[jsxRuntimeExports.jsx("span",{style:{marginRight:"auto",color:"gray"},children:"Uploaded on"}),jsxRuntimeExports.jsx("span",{style:{marginRight:"auto",fontWeight:700},children:new Date(l==null?void 0:l.created_at).toDateString()})]})]})]})};FilePreviewPane.propTypes={isPreviewPaneActive:PropTypes.bool,setIsPreviewPaneActive:PropTypes.func,setSelectedPreviewFile:PropTypes.func,file:PropTypes.any};export{ClientListModalWindow as C,FeedItem as F,UilUpload$1 as U,FilePreviewPane as a};
